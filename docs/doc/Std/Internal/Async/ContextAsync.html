<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../../.././style.css"></link><link rel="icon" href="../../.././favicon.svg"></link><link rel="mask-icon" href="../../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../../.././/declarations/declaration-data.bmp" as="image"></link><title>Std.Internal.Async.ContextAsync</title><script defer="true" src="../../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../../.././";</script><script>const MODULE_NAME="Std.Internal.Async.ContextAsync";</script><script type="module" src="../../.././jump-src.js"></script><script type="module" src="../../.././search.js"></script><script type="module" src="../../.././expand-nav.js"></script><script type="module" src="../../.././how-about.js"></script><script type="module" src="../../.././instances.js"></script><script type="module" src="../../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../../.././Std/Internal/UV.html">Std.Internal.UV</a></li><li><a href="../../.././Std/Sync/CancellationContext.html">Std.Sync.CancellationContext</a></li><li><a href="../../.././Std/Internal/Async/Timer.html">Std.Internal.Async.Timer</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Std.Internal.Async.ContextAsync" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.runIn"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">runIn</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.run"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">run</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.getContext"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">getContext</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.isCancelled"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">isCancelled</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.getCancellationReason"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">getCancellationReason</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.cancel"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">cancel</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.doneSelector"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">doneSelector</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.awaitCancellation"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">awaitCancellation</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.concurrently"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">concurrently</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.race"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">race</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.concurrentlyAll"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">concurrentlyAll</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.background"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">background</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.disown"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">disown</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.raceAll"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">raceAll</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.async"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">async</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.instMonadAsyncAsyncTask"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadAsyncAsyncTask</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.instFunctor"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instFunctor</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.instMonad"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonad</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.instMonadLiftIO"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadLiftIO</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.instMonadLiftBaseIO"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadLiftBaseIO</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.instMonadExceptError"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadExceptError</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.instMonadFinally"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadFinally</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.instInhabited"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instInhabited</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.ContextAsync.instMonadAwaitAsyncTask"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadAwaitAsyncTask</span></a></div><div class="nav_link"><a class="break_within" href="#Std.Internal.IO.Async.Selector.cancelled"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">Selector</span>.<span class="name">cancelled</span></a></div></nav><main>
<div class="mod_doc"><p>This module contains the implementation of <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></code>, a monad for asynchronous computations with
cooperative cancellation support that must be explicitly checked for and cancelled explicitly.</p></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L25-L30">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../../.././foundational_types.html">Type</a></div></div><p>An asynchronous computation with cooperative cancellation support via a <code>CancellationContext</code>. <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> α</code>
is equivalent to <code><a href="../../.././Init/Prelude.html#ReaderT">ReaderT</a> CancellationContext Async α</code>, providing a <code>CancellationContext</code> value to async
computations.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">Std.Internal.IO.Async.ContextAsync</a> <span class="fn">α</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext">Std.CancellationContext</a> <a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.Async">Std.Internal.IO.Async.Async</a> <span class="fn">α</span></span></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.runIn"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L34-L40">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.runIn"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">runIn</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">ctx</span> : <a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext">CancellationContext</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.Async">Async</a> <span class="fn">α</span></span></div></div><p>Runs a <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></code> computation with a given context. See also <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.run">ContextAsync.run</a></code> for running with a new
context that automatically cancels after execution.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.runIn">Std.Internal.IO.Async.ContextAsync.runIn</a> <span class="fn">ctx</span> <span class="fn">x</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">x</span> <span class="fn">ctx</span></span></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.runIn" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.run"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L42-L49">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.run"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">run</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.Async">Async</a> <span class="fn">α</span></span></div></div><p>Runs a <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></code> computation with a new context that cancels after the execution of the computation.
See also <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.runIn">ContextAsync.runIn</a></code> for running with an existing context.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn">x</span>.<a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.run">run</a></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">ctx</span> ← <span class="fn"><a href="../../.././Init/Prelude.html#liftM">liftM</a> <a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext.new">Std.CancellationContext.new</a></span>
  <span class="fn"><span class="fn"><span class="fn">x</span> <span class="fn">ctx</span></span> &lt;* <span class="fn"><a href="../../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<span class="fn"><span class="fn">ctx</span>.<a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext.cancel">cancel</a></span> <a href="../../.././Std/Sync/CancellationToken.html#Std.CancellationReason.cancel">Std.CancellationReason.cancel</a>)</span></span></span></span></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.run" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.getContext"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L51-L56">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.getContext"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">getContext</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext">CancellationContext</a></span></div></div><p>Returns the current context for inspection or to pass to other functions.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.getContext">Std.Internal.IO.Async.ContextAsync.getContext</a> <span class="fn">ctx</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">ctx</span></span></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.getContext" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.isCancelled"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L58-L65">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.isCancelled"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">isCancelled</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <a href="../../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Checks if the current context is cancelled. Returns <code>true</code> if the context (or any ancestor) has been cancelled.
Long-running operations should periodically check this and exit gracefully when cancelled.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.isCancelled">Std.Internal.IO.Async.ContextAsync.isCancelled</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">ctx</span> ← <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.getContext">Std.Internal.IO.Async.ContextAsync.getContext</a>
  <span class="fn"><a href="../../.././Init/Prelude.html#liftM">liftM</a> <span class="fn"><span class="fn">ctx</span>.<a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext.isCancelled">isCancelled</a></span></span></span></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.isCancelled" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.getCancellationReason"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L67-L74">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.getCancellationReason"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">getCancellationReason</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">(<a href="../../.././Init/Prelude.html#Option">Option</a> <a href="../../.././Std/Sync/CancellationToken.html#Std.CancellationReason">CancellationReason</a>)</span></span></div></div><p>Gets the cancellation reason if the context is cancelled. Returns <code>some reason</code> if cancelled, <code>none</code> otherwise,
allowing you to distinguish between different cancellation types.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.getCancellationReason">Std.Internal.IO.Async.ContextAsync.getCancellationReason</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">ctx</span> ← <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.getContext">Std.Internal.IO.Async.ContextAsync.getContext</a>
  <span class="fn"><a href="../../.././Init/Prelude.html#liftM">liftM</a> <span class="fn"><span class="fn">ctx</span>.<a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext.getCancellationReason">getCancellationReason</a></span></span></span></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.getCancellationReason" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.cancel"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L76-L83">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.cancel"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">cancel</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">reason</span> : <a href="../../.././Std/Sync/CancellationToken.html#Std.CancellationReason">CancellationReason</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <a href="../../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Cancels the current context with the given reason, cascading to all child contexts.
Cancellation is cooperative, operations must explicitly check <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.isCancelled">isCancelled</a></code> or use <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.awaitCancellation">awaitCancellation</a></code> to respond.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.cancel">Std.Internal.IO.Async.ContextAsync.cancel</a> <span class="fn">reason</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">ctx</span> ← <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.getContext">Std.Internal.IO.Async.ContextAsync.getContext</a>
  <span class="fn"><a href="../../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<span class="fn"><span class="fn">ctx</span>.<a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext.cancel">cancel</a></span> <span class="fn">reason</span>)</span></span></span></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.cancel" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.doneSelector"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L85-L91">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.doneSelector"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">doneSelector</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">(<a href="../../.././Std/Internal/Async/Select.html#Std.Internal.IO.Async.Selector">Selector</a> <a href="../../.././Init/Prelude.html#Unit">Unit</a>)</span></span></div></div><p>Returns a selector that completes when the current context is cancelled.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.doneSelector">Std.Internal.IO.Async.ContextAsync.doneSelector</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">ctx</span> ← <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.getContext">Std.Internal.IO.Async.ContextAsync.getContext</a>
  <span class="fn"><a href="../../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">ctx</span>.<a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext.doneSelector">doneSelector</a></span></span></span></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.doneSelector" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.awaitCancellation"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L93-L100">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.awaitCancellation"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">awaitCancellation</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <a href="../../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Waits for the current context to be cancelled.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.awaitCancellation">Std.Internal.IO.Async.ContextAsync.awaitCancellation</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">ctx</span> ← <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.getContext">Std.Internal.IO.Async.ContextAsync.getContext</a>
  let <span class="fn">task</span> ← <span class="fn"><a href="../../.././Init/Prelude.html#liftM">liftM</a> <span class="fn"><span class="fn">ctx</span>.<a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext.done">done</a></span></span>
  <span class="fn"><a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.MonadAwait.await">Std.Internal.IO.Async.await</a> <span class="fn">task</span></span></span></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.awaitCancellation" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.concurrently"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L102-L122">source</a></div><div class="attributes">@[inline, specialize #[]]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.concurrently"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">concurrently</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α </span><span class="fn">β</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">y</span> : <span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">β</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">prio</span> : <a href="../../.././Init/Core.html#Task.Priority">Task.Priority</a> := <a href="../../.././Init/Core.html#Task.Priority.default">Task.Priority.default</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> (<span class="fn">α</span> <a href="../../.././Init/Prelude.html#Prod">×</a> <span class="fn">β</span>)</span></div></div><p>Runs two computations concurrently and returns both results. Each computation runs in its own child context;
if either fails or is cancelled, both are cancelled immediately and the exception is propagated.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.concurrently" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.race"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L124-L143">source</a></div><div class="attributes">@[inline, specialize #[]]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.race"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">race</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">x </span><span class="fn">y</span> : <span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">prio</span> : <a href="../../.././Init/Core.html#Task.Priority">Task.Priority</a> := <a href="../../.././Init/Core.html#Task.Priority.default">Task.Priority.default</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span></span></div></div><p>Runs two computations concurrently and returns the result of the first to complete. Each computation runs
in its own child context; when either completes, the other is cancelled immediately.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.race" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.concurrentlyAll"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L145-L167">source</a></div><div class="attributes">@[inline, specialize #[]]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.concurrentlyAll"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">concurrentlyAll</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">prio</span> : <a href="../../.././Init/Core.html#Task.Priority">Task.Priority</a> := <a href="../../.././Init/Core.html#Task.Priority.default">Task.Priority.default</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">(<a href="../../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span>)</span></span></div></div><p>Runs all computations concurrently and collects results in the same order. Each runs in its own child context;
if any computation fails, all others are cancelled and the exception is propagated.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.concurrentlyAll" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.background"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L169-L181">source</a></div><div class="attributes">@[inline, specialize #[]]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.background"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">background</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">action</span> : <span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">prio</span> : <a href="../../.././Init/Core.html#Task.Priority">Task.Priority</a> := <a href="../../.././Init/Core.html#Task.Priority.default">Task.Priority.default</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <a href="../../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Launches a <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></code> computation in the background, discarding its result.</p><p>The computation runs independently in the background in its own child context. The parent computation does not wait
for background tasks to complete. This means that if the parent finishes its execution it will cause
the cancellation of the background functions. See also <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.disown">disown</a></code> for launching tasks that continue independently
even after parent cancellation.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.background" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.disown"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L183-L193">source</a></div><div class="attributes">@[inline, specialize #[]]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.disown"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">disown</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">action</span> : <span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">prio</span> : <a href="../../.././Init/Core.html#Task.Priority">Task.Priority</a> := <a href="../../.././Init/Core.html#Task.Priority.default">Task.Priority.default</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <a href="../../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Launches a <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></code> computation in the background, discarding its result. It's similar to <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.background">background</a></code>,
but the child context is not automatically cancelled when the action completes. This allows the disowned
computation to continue running independently, even if the parent context is cancelled. The child context
will remain alive as long as the computation needs it. See also <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.background">background</a></code> for launching tasks that are
cancelled when the parent finishes.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn">action</span>.<a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.disown">disown</a></span> <span class="fn">prio</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">childCtx</span> ← <span class="fn"><a href="../../.././Init/Prelude.html#liftM">liftM</a> <a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext.new">Std.CancellationContext.new</a></span>
  <span class="fn"><a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.background">Std.Internal.IO.Async.background</a> <span class="fn">(<a href="../../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<span class="fn">action</span> <span class="fn">childCtx</span>)</span>)</span> <span class="fn">prio</span></span></span></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.disown" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.raceAll"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L195-L217">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.raceAll"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">raceAll</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">c</span> : <a href="../../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Init/Control/Basic.html#ForM">ForM</a> <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">c</span> <span class="fn">(<a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span>)</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn">c</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">prio</span> : <a href="../../.././Init/Core.html#Task.Priority">Task.Priority</a> := <a href="../../.././Init/Core.html#Task.Priority.default">Task.Priority.default</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span></span></div></div><p>Runs all computations concurrently and returns the first result. Each computation runs in its own child context;
when the first completes successfully, all others are cancelled immediately.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.raceAll" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.async"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L219-L227">source</a></div><div class="attributes">@[inline, specialize #[]]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.async"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">async</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">prio</span> : <a href="../../.././Init/Core.html#Task.Priority">Task.Priority</a> := <a href="../../.././Init/Core.html#Task.Priority.default">Task.Priority.default</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">(<a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.AsyncTask">AsyncTask</a> <span class="fn">α</span>)</span></span></div></div><p>Launches a <code><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></code> computation as an asynchronous task with a forked child context.
The child context is automatically cancelled when the task completes or fails.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn">x</span>.<a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.async">async</a></span> <span class="fn">prio</span> <span class="fn">ctx</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">childCtx</span> ← <span class="fn"><a href="../../.././Init/Prelude.html#liftM">liftM</a> <span class="fn"><span class="fn">ctx</span>.<a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext.fork">fork</a></span></span>
  <span class="fn"><a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.MonadAsync.async">Std.Internal.IO.Async.async</a> <span class="fn">(<a href="../../.././Init/Control/Except.html#tryFinally">tryFinally</a> <span class="fn">(<span class="fn">x</span> <span class="fn">childCtx</span>)</span> <span class="fn">(<a href="../../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<span class="fn"><span class="fn">childCtx</span>.<a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext.cancel">cancel</a></span> <a href="../../.././Std/Sync/CancellationToken.html#Std.CancellationReason.cancel">Std.CancellationReason.cancel</a>)</span>)</span>)</span> <span class="fn">prio</span></span></span></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.ContextAsync.async" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.instMonadAsyncAsyncTask"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L229-L230">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instMonadAsyncAsyncTask"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadAsyncAsyncTask</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.MonadAsync">MonadAsync</a> <a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.AsyncTask">AsyncTask</a> <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instMonadAsyncAsyncTask">Std.Internal.IO.Async.ContextAsync.instMonadAsyncAsyncTask</a> <a href="../../.././Init/Prelude.html#Eq">=</a>   <a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.MonadAsync.mk">{</a> <span class="fn">async</span> := <span class="fn">fun {<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>} (<span class="fn">x</span> : <span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">Std.Internal.IO.Async.ContextAsync</a> <span class="fn">α</span></span>) (<span class="fn">prio</span> : <a href="../../.././Init/Core.html#Task.Priority">Task.Priority</a>) =&gt; <span class="fn"><span class="fn"><span class="fn">x</span>.<a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.async">async</a></span> <span class="fn">prio</span></span></span> <a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.MonadAsync.mk">}</a></li></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.instFunctor"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L232-L233">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instFunctor"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instFunctor</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#Functor">Functor</a> <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instFunctor">Std.Internal.IO.Async.ContextAsync.instFunctor</a> <a href="../../.././Init/Prelude.html#Eq">=</a>   <a href="../../.././Init/Prelude.html#Functor.mk">{</a>     <span class="fn">map</span> := <span class="fn">fun {<span class="fn">α </span><span class="fn">β</span> : <a href="../../.././foundational_types.html">Type</a>} (<span class="fn">f</span> : <span class="fn"><span class="fn">α</span> → <span class="fn">β</span></span>) (<span class="fn">x</span> : <span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">Std.Internal.IO.Async.ContextAsync</a> <span class="fn">α</span></span>) (<span class="fn">ctx</span> : <a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext">Std.CancellationContext</a>) =&gt;
      <span class="fn">f</span> <a href="../../.././Init/Prelude.html#Functor.map">&lt;$&gt;</a> <span class="fn"><span class="fn">x</span> <span class="fn">ctx</span></span></span> <a href="../../.././Init/Prelude.html#Functor.mk">}</a></li></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.instMonad"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L235-L237">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instMonad"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonad</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#Monad">Monad</a> <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.instMonadLiftIO"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L239-L240">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instMonadLiftIO"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadLiftIO</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#MonadLift">MonadLift</a> <a href="../../.././Init/System/IO.html#IO">IO</a> <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instMonadLiftIO">Std.Internal.IO.Async.ContextAsync.instMonadLiftIO</a> <a href="../../.././Init/Prelude.html#Eq">=</a>   <a href="../../.././Init/Prelude.html#MonadLift.mk">{</a>     <span class="fn">monadLift</span> := <span class="fn">fun {<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>} (<span class="fn">x</span> : <span class="fn"><a href="../../.././Init/System/IO.html#IO">IO</a> <span class="fn">α</span></span>) (<span class="fn">x_1</span> : <a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext">Std.CancellationContext</a>) =&gt;
      <span class="fn"><a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.Async.ofIOTask">Std.Internal.IO.Async.Async.ofIOTask</a> (<a href="../../.././Init/Core.html#Task.pure">Task.pure</a> <a href="../../.././Init/Prelude.html#Functor.map">&lt;$&gt;</a> <span class="fn">x</span>)</span></span> <a href="../../.././Init/Prelude.html#MonadLift.mk">}</a></li></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.instMonadLiftBaseIO"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L242-L243">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instMonadLiftBaseIO"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadLiftBaseIO</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#MonadLift">MonadLift</a> <a href="../../.././Init/System/IO.html#BaseIO">BaseIO</a> <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instMonadLiftBaseIO">Std.Internal.IO.Async.ContextAsync.instMonadLiftBaseIO</a> <a href="../../.././Init/Prelude.html#Eq">=</a>   <a href="../../.././Init/Prelude.html#MonadLift.mk">{</a> <span class="fn">monadLift</span> := <span class="fn">fun {<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>} (<span class="fn">x</span> : <span class="fn"><a href="../../.././Init/System/IO.html#BaseIO">BaseIO</a> <span class="fn">α</span></span>) (<span class="fn">x_1</span> : <a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext">Std.CancellationContext</a>) =&gt; <span class="fn"><a href="../../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<a href="../../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">x</span>)</span></span></span> <a href="../../.././Init/Prelude.html#MonadLift.mk">}</a></li></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.instMonadExceptError"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L245-L247">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instMonadExceptError"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadExceptError</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#MonadExcept">MonadExcept</a> <a href="../../.././Init/System/IOError.html#IO.Error">IO.Error</a> <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.instMonadFinally"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L249-L251">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instMonadFinally"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadFinally</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Control/Except.html#MonadFinally">MonadFinally</a> <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.instInhabited"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L253-L254">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instInhabited"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instInhabited</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">(<a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">α</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instInhabited">Std.Internal.IO.Async.ContextAsync.instInhabited</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <a href="../../.././Init/Prelude.html#Inhabited.mk">{</a> <span class="fn">default</span> := <span class="fn">fun (<span class="fn">x</span> : <a href="../../.././Std/Sync/CancellationContext.html#Std.CancellationContext">Std.CancellationContext</a>) =&gt; <a href="../../.././Init/Prelude.html#Inhabited.default">default</a></span> <a href="../../.././Init/Prelude.html#Inhabited.mk">}</a></li></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.ContextAsync.instMonadAwaitAsyncTask"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L256-L257">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.instMonadAwaitAsyncTask"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">ContextAsync</span>.<span class="name">instMonadAwaitAsyncTask</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.MonadAwait">MonadAwait</a> <a href="../../.././Std/Internal/Async/Basic.html#Std.Internal.IO.Async.AsyncTask">AsyncTask</a> <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Std.Internal.IO.Async.Selector.cancelled"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Std/Internal/Async/ContextAsync.lean#L261-L266">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.Selector.cancelled"><span class="name">Std</span>.<span class="name">Internal</span>.<span class="name">IO</span>.<span class="name">Async</span>.<span class="name">Selector</span>.<span class="name">cancelled</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync">ContextAsync</a> <span class="fn">(<a href="../../.././Std/Internal/Async/Select.html#Std.Internal.IO.Async.Selector">Selector</a> <a href="../../.././Init/Prelude.html#Unit">Unit</a>)</span></span></div></div><p>Returns a selector that completes when the current context is cancelled.
This is useful for selecting on cancellation alongside other asynchronous operations.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.Selector.cancelled">Std.Internal.IO.Async.Selector.cancelled</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <a href="../../.././Std/Internal/Async/ContextAsync.html#Std.Internal.IO.Async.ContextAsync.doneSelector">Std.Internal.IO.Async.ContextAsync.doneSelector</a></li></ul></details><details id="instances-for-list-Std.Internal.IO.Async.Selector.cancelled" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>