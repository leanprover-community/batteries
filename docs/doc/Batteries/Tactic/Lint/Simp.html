<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../../.././style.css"></link><link rel="icon" href="../../.././favicon.svg"></link><link rel="mask-icon" href="../../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../../.././/declarations/declaration-data.bmp" as="image"></link><title>Batteries.Tactic.Lint.Simp</title><script defer="true" src="../../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../../.././";</script><script>const MODULE_NAME="Batteries.Tactic.Lint.Simp";</script><script type="module" src="../../.././jump-src.js"></script><script type="module" src="../../.././search.js"></script><script type="module" src="../../.././expand-nav.js"></script><script type="module" src="../../.././how-about.js"></script><script type="module" src="../../.././instances.js"></script><script type="module" src="../../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">Simp</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../../.././Init.html">Init</a></li><li><a href="../../.././Batteries/Tactic/OpenPrivate.html">Batteries.Tactic.OpenPrivate</a></li><li><a href="../../.././Batteries/Util/LibraryNote.html">Batteries.Util.LibraryNote</a></li><li><a href="../../.././Batteries/Tactic/Lint/Basic.html">Batteries.Tactic.Lint.Basic</a></li><li><a href="../../.././Lean/Meta/Tactic/Simp/Main.html">Lean.Meta.Tactic.Simp.Main</a></li><li><a href="../../.././Lean/Meta/Tactic/Simp/SimpTheorems.html">Lean.Meta.Tactic.Simp.SimpTheorems</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Batteries.Tactic.Lint.Simp" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Batteries.Tactic.Lint.SimpTheoremInfo"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">SimpTheoremInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Batteries.Tactic.Lint.isCondition"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">isCondition</span></a></div><div class="nav_link"><a class="break_within" href="#Batteries.Tactic.Lint.withSimpTheoremInfos"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">withSimpTheoremInfos</span></a></div><div class="nav_link"><a class="break_within" href="#Batteries.Tactic.Lint.isSimpEq"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">isSimpEq</span></a></div><div class="nav_link"><a class="break_within" href="#Batteries.Tactic.Lint.checkAllSimpTheoremInfos"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">checkAllSimpTheoremInfos</span></a></div><div class="nav_link"><a class="break_within" href="#Batteries.Tactic.Lint.isSimpTheorem"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">isSimpTheorem</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Meta.DiscrTree.elements"><span class="name">Lean</span>.<span class="name">Meta</span>.<span class="name">DiscrTree</span>.<span class="name">elements</span></a></div><div class="nav_link"><a class="break_within" href="#Batteries.Tactic.Lint.decorateError"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">decorateError</span></a></div><div class="nav_link"><a class="break_within" href="#Batteries.Tactic.Lint.formatLemmas"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">formatLemmas</span></a></div><div class="nav_link"><a class="break_within" href="#Batteries.Tactic.Lint.simpNF"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">simpNF</span></a></div><div class="nav_link"><a class="break_within" href="#LibraryNote.«simp-normal_form»"><span class="name">LibraryNote</span>.<span class="name">«simp-normal_form»</span></a></div><div class="nav_link"><a class="break_within" href="#Batteries.Tactic.Lint.simpVarHead"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">simpVarHead</span></a></div><div class="nav_link"><a class="break_within" href="#Batteries.Tactic.Lint.simpComm"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">simpComm</span></a></div></nav><main>
<div class="mod_doc"><h1 id="Linter-for-simplification-lemmas" class="markdown-heading">Linter for simplification lemmas <a class="hover-link" href="#Linter-for-simplification-lemmas">#</a></h1><p>This files defines several linters that prevent common mistakes when declaring simp lemmas:</p><ul><li><code><a href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.simpNF">simpNF</a></code> checks that the left-hand side of a simp lemma is not simplified by a different lemma.</li><li><code><a href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.simpVarHead">simpVarHead</a></code> checks that the head symbol of the left-hand side is not a variable.</li><li><code><a href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.simpComm">simpComm</a></code> checks that commutativity lemmas are not marked as simplification lemmas.</li></ul></div><div class="decl" id="Batteries.Tactic.Lint.SimpTheoremInfo"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L29-L36">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.SimpTheoremInfo"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">SimpTheoremInfo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././foundational_types.html">Type</a></div></div><p>The data associated to a simp theorem.</p><ul class="structure_fields" id="Batteries.Tactic.Lint.SimpTheoremInfo.mk"><li id="Batteries.Tactic.Lint.SimpTheoremInfo.hyps" class="structure_field"><div class="structure_field_info">hyps : <span class="fn"><a href="../../.././Init/Prelude.html#Array">Array</a> <a href="../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span></div><div class="structure_field_doc"><p>The hypotheses of the theorem</p></div></li><li id="Batteries.Tactic.Lint.SimpTheoremInfo.lhs" class="structure_field"><div class="structure_field_info">lhs : <a href="../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></div><div class="structure_field_doc"><p>The thing to replace</p></div></li><li id="Batteries.Tactic.Lint.SimpTheoremInfo.rhs" class="structure_field"><div class="structure_field_info">rhs : <a href="../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></div><div class="structure_field_doc"><p>The result of replacement</p></div></li></ul><details id="instances-for-list-Batteries.Tactic.Lint.SimpTheoremInfo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Batteries.Tactic.Lint.isCondition"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L38-L43">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.isCondition"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">isCondition</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <a href="../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <a href="../../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Is this hypothesis a condition that might turn into a <code>simp</code> side-goal?
i.e. is it a proposition that isn't marked as instance implicit?</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Batteries.Tactic.Lint.isCondition" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Batteries.Tactic.Lint.withSimpTheoremInfos"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L45-L52">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.withSimpTheoremInfos"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">withSimpTheoremInfos</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">ty</span> : <a href="../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <span class="fn"><a href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.SimpTheoremInfo">SimpTheoremInfo</a> → <span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">(<a href="../../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span>)</span></span></div></div><p>Runs the continuation on all the simp theorems encoded in the given type.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Batteries.Tactic.Lint.withSimpTheoremInfos" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Batteries.Tactic.Lint.isSimpEq"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L54-L64">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.isSimpEq"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">isSimpEq</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">a </span><span class="fn">b</span> : <a href="../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">whnfFirst</span> : <a href="../../.././Init/Prelude.html#Bool">Bool</a> := <a href="../../.././Init/Prelude.html#Bool.true">true</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <a href="../../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Checks whether two expressions are equal for the simplifier. That is,
they are reducibly-definitional equal, and they have the same head symbol.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Batteries.Tactic.Lint.isSimpEq" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Batteries.Tactic.Lint.checkAllSimpTheoremInfos"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L66-L73">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.checkAllSimpTheoremInfos"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">checkAllSimpTheoremInfos</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ty</span> : <a href="../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <span class="fn"><a href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.SimpTheoremInfo">SimpTheoremInfo</a> → <span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">(<a href="../../.././Init/Prelude.html#Option">Option</a> <a href="../../.././Lean/Message.html#Lean.MessageData">Lean.MessageData</a>)</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">(<a href="../../.././Init/Prelude.html#Option">Option</a> <a href="../../.././Lean/Message.html#Lean.MessageData">Lean.MessageData</a>)</span></span></div></div><p>Constructs a message from all the simp theorems encoded in the given type.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Batteries.Tactic.Lint.checkAllSimpTheoremInfos" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Batteries.Tactic.Lint.isSimpTheorem"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L75-L77">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.isSimpTheorem"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">isSimpTheorem</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">declName</span> : <a href="../../.././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <a href="../../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Returns true if this is a <code>@[simp]</code> declaration.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.isSimpTheorem">Batteries.Tactic.Lint.isSimpTheorem</a> <span class="fn">declName</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn"><a href="../../.././Init/Prelude.html#liftM">liftM</a> <a href="../../.././Lean/Meta/Tactic/Simp/Attr.html#Lean.Meta.getSimpTheorems">Lean.Meta.getSimpTheorems</a></span>
  <span class="fn"><a href="../../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">(<a href="../../.././Lean/Data/PersistentHashSet.html#Lean.PersistentHashSet.contains">Lean.PersistentHashSet.contains</a> <span class="fn"><span class="fn">__do_lift</span>.<a href="../../.././Lean/Meta/Tactic/Simp/SimpTheorems.html#Lean.Meta.SimpTheorems.lemmaNames">lemmaNames</a></span> <span class="fn">(<a href="../../.././Lean/Meta/Tactic/Simp/SimpTheorems.html#Lean.Meta.Origin.decl">Lean.Meta.Origin.decl</a> <span class="fn">declName</span>)</span>)</span></span></span></li></ul></details><details id="instances-for-list-Batteries.Tactic.Lint.isSimpTheorem" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Meta.DiscrTree.elements"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L80-L87">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Lean.Meta.DiscrTree.elements"><span class="name">Lean</span>.<span class="name">Meta</span>.<span class="name">DiscrTree</span>.<span class="name">elements</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">d</span> : <span class="fn"><a href="../../.././Lean/Meta/DiscrTree/Types.html#Lean.Meta.DiscrTree">DiscrTree</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span></div></div><p>Returns the list of elements in the discrimination tree.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn">d</span>.<a href="../../.././Batteries/Tactic/Lint/Simp.html#Lean.Meta.DiscrTree.elements">elements</a></span> <a href="../../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn"><span class="fn"><span class="fn">d</span>.<a href="../../.././Lean/Meta/DiscrTree/Types.html#Lean.Meta.DiscrTree.root">root</a></span>.<a href="../../.././Lean/Data/PersistentHashMap.html#Lean.PersistentHashMap.foldl">foldl</a></span> <span class="fn">(fun (<span class="fn">arr</span> : <span class="fn"><a href="../../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span>) (<span class="fn">x</span> : <a href="../../.././Lean/Meta/DiscrTree/Types.html#Lean.Meta.DiscrTree.Key">Lean.Meta.DiscrTree.Key</a>) =&gt; <span class="fn"><a href="../../.././Batteries/Tactic/Lint/Simp.html#_private.Batteries.Tactic.Lint.Simp.0.Lean.Meta.DiscrTree.elements.trieElements">Lean.Meta.DiscrTree.elements.trieElements✝</a> <span class="fn">arr</span></span>)</span> <a href="../../.././Init/Prelude.html#List.toArray">#[</a><a href="../../.././Init/Prelude.html#List.toArray">]</a></span></li></ul></details><details id="instances-for-list-Lean.Meta.DiscrTree.elements" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Batteries.Tactic.Lint.decorateError"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L89-L91">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.decorateError"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">decorateError</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">msg</span> : <a href="../../.././Lean/Message.html#Lean.MessageData">Lean.MessageData</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span></div></div><p>Add message <code>msg</code> to any errors thrown inside <code>k</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Batteries.Tactic.Lint.decorateError" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Batteries.Tactic.Lint.formatLemmas"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L93-L103">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.formatLemmas"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">formatLemmas</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">usedSimps</span> : <a href="../../.././Lean/Meta/Tactic/Simp/Types.html#Lean.Meta.Simp.UsedSimps">Lean.Meta.Simp.UsedSimps</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">simpName</span> : <a href="../../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">higherOrder</span> : <span class="fn"><a href="../../.././Init/Prelude.html#Option">Option</a> <a href="../../.././Init/Prelude.html#Bool">Bool</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <a href="../../.././Lean/Message.html#Lean.MessageData">Lean.MessageData</a></span></div></div><p>Render the list of simp lemmas.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Batteries.Tactic.Lint.formatLemmas" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Batteries.Tactic.Lint.simpNF"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L105-L194">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.simpNF"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">simpNF</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././Batteries/Tactic/Lint/Basic.html#Batteries.Tactic.Lint.Linter">Linter</a></div></div><p>A linter for simp lemmas whose lhs is not in simp-normal form, and which hence never fire.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Batteries.Tactic.Lint.simpNF" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="LibraryNote.«simp-normal_form»"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L196-L242">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#LibraryNote.«simp-normal_form»"><span class="name">LibraryNote</span>.<span class="name">«simp-normal_form»</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././Batteries/Util/LibraryNote.html#Batteries.Util.LibraryNote">Batteries.Util.LibraryNote</a></div></div><p>This note gives you some tips to debug any errors that the simp-normal form linter raises.</p><p>The reason that a lemma was considered faulty is because its left-hand side is not in simp-normal
form.
These lemmas are hence never used by the simplifier.</p><p>This linter gives you a list of other simp lemmas: look at them!</p><p>Here are some tips depending on the error raised by the linter:</p><ol><li><p>'the left-hand side reduces to XYZ':
you should probably use XYZ as the left-hand side.</p></li><li><p>'simp can prove this':
This typically means that lemma is a duplicate, or is shadowed by another lemma:</p><p>2a. Always put more general lemmas after specific ones:</p><pre><code>@[simp] lemma zero_add_zero : 0 + 0 = 0 := <a href="../../.././Init/Prelude.html#rfl">rfl</a>
@[simp] lemma add_zero : x + 0 = x := <a href="../../.././Init/Prelude.html#rfl">rfl</a>
</code></pre><p>And not the other way around!  The simplifier always picks the last matching lemma.</p><p>2b. You can also use <code>@[priority]</code> instead of moving simp-lemmas around in the file.</p><p>Tip: the default priority is 1000.
Use <code>@[priority 1100]</code> instead of moving a lemma down,
and <code>@[priority 900]</code> instead of moving a lemma up.</p><p>2c. Conditional simp lemmas are tried last. If they are shadowed
just remove the <code>simp</code> attribute.</p><p>2d. If two lemmas are duplicates, the linter will complain about the first one.
Try to fix the second one instead!
(You can find it among the other simp lemmas the linter prints out!)</p></li><li><p>'try_for tactic failed, timeout':
This typically means that there is a loop of simp lemmas.
Try to apply squeeze_simp to the right-hand side (removing this lemma from the simp set) to see
what lemmas might be causing the loop.</p><p>Another trick is to <code>set_option trace.simplify.rewrite true</code> and
then apply <code>try_for 10000 { simp }</code> to the right-hand side.  You will
see a periodic sequence of lemma applications in the trace message.</p></li></ol><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Batteries/Tactic/Lint/Simp.html#LibraryNote.«simp-normal_form»">LibraryNote.«simp-normal_form»</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <a href="../../.././Init/Prelude.html#Inhabited.default">default</a></li></ul></details><details id="instances-for-list-LibraryNote.«simp-normal_form»" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Batteries.Tactic.Lint.simpVarHead"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L244-L259">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.simpVarHead"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">simpVarHead</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././Batteries/Tactic/Lint/Basic.html#Batteries.Tactic.Lint.Linter">Linter</a></div></div><p>A linter for simp lemmas whose lhs has a variable as head symbol,
and which hence never fire.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Batteries.Tactic.Lint.simpVarHead" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Batteries.Tactic.Lint.simpComm"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/batteries/blob/77d10578945b31d794214a66937b75a6d4311674/Batteries/Tactic/Lint/Simp.lean#L267-L287">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Batteries/Tactic/Lint/Simp.html#Batteries.Tactic.Lint.simpComm"><span class="name">Batteries</span>.<span class="name">Tactic</span>.<span class="name">Lint</span>.<span class="name">simpComm</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././Batteries/Tactic/Lint/Basic.html#Batteries.Tactic.Lint.Linter">Linter</a></div></div><p>A linter for commutativity lemmas that are marked simp.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Batteries.Tactic.Lint.simpComm" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>