<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Server.Requests</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="Lean.Server.Requests";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">Requests</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Lean/Server/FileSource.html">Lean.Server.FileSource</a></li><li><a href="../.././Lean/Server/RequestCancellation.html">Lean.Server.RequestCancellation</a></li><li><a href="../.././Std/Sync/Mutex.html">Std.Sync.Mutex</a></li><li><a href="../.././Lean/Server/FileWorker/Utils.html">Lean.Server.FileWorker.Utils</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Server.Requests" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.FileMap.rangeContainsHoverPos"><span class="name">Lean</span>.<span class="name">FileMap</span>.<span class="name">rangeContainsHoverPos</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.FileMap.rangeOverlapsRequestedRange"><span class="name">Lean</span>.<span class="name">FileMap</span>.<span class="name">rangeOverlapsRequestedRange</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.FileMap.rangeIncludesRequestedRange"><span class="name">Lean</span>.<span class="name">FileMap</span>.<span class="name">rangeIncludesRequestedRange</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Language.SnapshotTree.foldSnaps.Control"><span class="name">Lean</span>.<span class="name">Language</span>.<span class="name">SnapshotTree</span>.<span class="name">foldSnaps</span>.<span class="name">Control</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Language.SnapshotTree.foldSnaps"><span class="name">Lean</span>.<span class="name">Language</span>.<span class="name">SnapshotTree</span>.<span class="name">foldSnaps</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Language.SnapshotTree.findInfoTreeAtPos"><span class="name">Lean</span>.<span class="name">Language</span>.<span class="name">SnapshotTree</span>.<span class="name">findInfoTreeAtPos</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Language.SnapshotTree.foldInfosInRange"><span class="name">Lean</span>.<span class="name">Language</span>.<span class="name">SnapshotTree</span>.<span class="name">foldInfosInRange</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Language.SnapshotTree.collectMessagesInRange"><span class="name">Lean</span>.<span class="name">Language</span>.<span class="name">SnapshotTree</span>.<span class="name">collectMessagesInRange</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestError"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instInhabitedRequestError"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instInhabitedRequestError</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instInhabitedRequestError.default"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instInhabitedRequestError</span>.<span class="name">default</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestError.fileChanged"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">fileChanged</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestError.methodNotFound"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">methodNotFound</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestError.invalidParams"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">invalidParams</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestError.internalError"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">internalError</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestError.requestCancelled"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">requestCancelled</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestError.rpcNeedsReconnect"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">rpcNeedsReconnect</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestError.ofException"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">ofException</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestError.ofIoError"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">ofIoError</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestError.toLspResponseError"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">toLspResponseError</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.parseRequestParams"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">parseRequestParams</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.ServerRequestResponse"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">ServerRequestResponse</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instInhabitedServerRequestResponse"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instInhabitedServerRequestResponse</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instInhabitedServerRequestResponse.default"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instInhabitedServerRequestResponse</span>.<span class="name">default</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.ServerRequestEmitter"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">ServerRequestEmitter</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestContext"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestContext</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestTask"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestTask</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestT"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestT</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.run"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">run</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestTask.pure"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestTask</span>.<span class="name">pure</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instMonadLiftIORequestM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instMonadLiftIORequestM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instMonadLiftEIOExceptionRequestM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instMonadLiftEIOExceptionRequestM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instMonadLiftCancellableMRequestM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instMonadLiftCancellableMRequestM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.runInIO"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">runInIO</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.readDoc"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">readDoc</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.asTask"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">asTask</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.pureTask"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">pureTask</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.mapTaskCheap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">mapTaskCheap</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.mapTaskCostly"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">mapTaskCostly</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.bindTaskCheap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">bindTaskCheap</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.bindTaskCostly"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">bindTaskCostly</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.mapRequestTaskCheap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">mapRequestTaskCheap</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.mapRequestTaskCostly"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">mapRequestTaskCostly</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.bindRequestTaskCheap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">bindRequestTaskCheap</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.bindRequestTaskCostly"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">bindRequestTaskCostly</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.parseRequestParams"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">parseRequestParams</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.checkCancelled"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">checkCancelled</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.sendServerRequest"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">sendServerRequest</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.waitFindSnapAux"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">waitFindSnapAux</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.withWaitFindSnap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">withWaitFindSnap</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.bindWaitFindSnap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">bindWaitFindSnap</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.withWaitFindSnapAtPos"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">withWaitFindSnapAtPos</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.findCmdParsedSnap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">findCmdParsedSnap</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.findCmdDataAtPos"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">findCmdDataAtPos</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.findInfoTreeAtPos"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">findInfoTreeAtPos</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.runCommandElabM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">runCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.runCoreM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">runCoreM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestM.runTermElabM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">runTermElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.LspResponse"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">LspResponse</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.SerializedLspResponse"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">SerializedLspResponse</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.SerializedLspResponse.toSerializedMessage"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">SerializedLspResponse</span>.<span class="name">toSerializedMessage</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestHandler</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.requestHandlers"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">requestHandlers</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.registerLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">registerLspRequestHandler</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.lookupLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">lookupLspRequestHandler</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.chainLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">chainLspRequestHandler</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RequestHandlerCompleteness"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestHandlerCompleteness</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.StatefulRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">StatefulRequestHandler</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.statefulRequestHandlers"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">statefulRequestHandlers</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.registerCompleteStatefulLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">registerCompleteStatefulLspRequestHandler</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.registerPartialStatefulLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">registerPartialStatefulLspRequestHandler</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.isStatefulLspRequestMethod"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">isStatefulLspRequestMethod</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.lookupStatefulLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">lookupStatefulLspRequestHandler</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.partialLspRequestHandlerMethods"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">partialLspRequestHandlerMethods</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.chainStatefulLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">chainStatefulLspRequestHandler</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.handleOnDidChange"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">handleOnDidChange</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.handleLspRequest"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">handleLspRequest</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.routeLspRequest"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">routeLspRequest</span></a></div></nav><main>
<div class="decl" id="Lean.FileMap.rangeContainsHoverPos"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L22-L31">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.FileMap.rangeContainsHoverPos"><span class="name">Lean</span>.<span class="name">FileMap</span>.<span class="name">rangeContainsHoverPos</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">text</span> : <a href="../.././Lean/Data/Position.html#Lean.FileMap">FileMap</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">r</span> : <a href="../.././Lean/Syntax.html#String.Range">String.Range</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hoverPos</span> : <a href="../.././Init/Prelude.html#String.Pos.Raw">String.Pos.Raw</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">includeStop</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a> := <a href="../.././Init/Prelude.html#Bool.false">false</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><p>Checks whether <code>r</code> contains <code>hoverPos</code>, taking into account EOF according to <code>text</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn">text</span>.<a href="../.././Lean/Server/Requests.html#Lean.FileMap.rangeContainsHoverPos">rangeContainsHoverPos</a></span> <span class="fn">r</span> <span class="fn">hoverPos</span> <span class="fn">includeStop</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">r</span>.<a href="../.././Lean/Syntax.html#String.Range.contains">contains</a></span> <span class="fn">hoverPos</span> (<span class="fn">includeStop</span> <a href="../.././Init/Prelude.html#Bool.or">||</a> <span class="fn"><span class="fn">r</span>.<a href="../.././Lean/Syntax.html#String.Range.stop">stop</a></span> <a href="../.././Init/Prelude.html#BEq.beq">==</a> <span class="fn"><span class="fn"><span class="fn">text</span>.<a href="../.././Lean/Data/Position.html#Lean.FileMap.source">source</a></span>.<a href="../.././Init/Prelude.html#String.endPos">endPos</a></span>)</span></li></ul></details><details id="instances-for-list-Lean.FileMap.rangeContainsHoverPos" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.FileMap.rangeOverlapsRequestedRange"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L33-L43">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.FileMap.rangeOverlapsRequestedRange"><span class="name">Lean</span>.<span class="name">FileMap</span>.<span class="name">rangeOverlapsRequestedRange</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">text</span> : <a href="../.././Lean/Data/Position.html#Lean.FileMap">FileMap</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">documentRange </span><span class="fn">requestedRange</span> : <a href="../.././Lean/Syntax.html#String.Range">String.Range</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">includeDocumentRangeStop </span><span class="fn">includeRequestedRangeStop</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a> := <a href="../.././Init/Prelude.html#Bool.false">false</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.FileMap.rangeOverlapsRequestedRange" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.FileMap.rangeIncludesRequestedRange"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L45-L55">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.FileMap.rangeIncludesRequestedRange"><span class="name">Lean</span>.<span class="name">FileMap</span>.<span class="name">rangeIncludesRequestedRange</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">text</span> : <a href="../.././Lean/Data/Position.html#Lean.FileMap">FileMap</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">documentRange </span><span class="fn">requestedRange</span> : <a href="../.././Lean/Syntax.html#String.Range">String.Range</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">includeDocumentRangeStop </span><span class="fn">includeRequestedRangeStop</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a> := <a href="../.././Init/Prelude.html#Bool.false">false</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.FileMap.rangeIncludesRequestedRange" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Language.SnapshotTree.foldSnaps.Control"><div class="inductive"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L61-L63">source</a></div><div class="decl_header"><span class="decl_kind">inductive</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Language.SnapshotTree.foldSnaps.Control"><span class="name">Lean</span>.<span class="name">Language</span>.<span class="name">SnapshotTree</span>.<span class="name">foldSnaps</span>.<span class="name">Control</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="constructors"><li class="constructor" id="Lean.Language.SnapshotTree.foldSnaps.Control.done">done : <a href="../.././Lean/Server/Requests.html#Lean.Language.SnapshotTree.foldSnaps.Control">Control</a></li><li class="constructor" id="Lean.Language.SnapshotTree.foldSnaps.Control.proceed">proceed<span class="decl_args">
<span class="fn">(<span class="fn">foldChildren</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
 : <a href="../.././Lean/Server/Requests.html#Lean.Language.SnapshotTree.foldSnaps.Control">Control</a></li></ul><details id="instances-for-list-Lean.Language.SnapshotTree.foldSnaps.Control" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Language.SnapshotTree.foldSnaps"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L65-L86">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Language.SnapshotTree.foldSnaps"><span class="name">Lean</span>.<span class="name">Language</span>.<span class="name">SnapshotTree</span>.<span class="name">foldSnaps</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">tree</span> : <a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTree">SnapshotTree</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">init</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn"><a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTask">SnapshotTask</a> <a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTree">SnapshotTree</a></span> → <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">Server.ServerTask</a> (<span class="fn">α</span> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Lean/Server/Requests.html#Lean.Language.SnapshotTree.foldSnaps.Control">foldSnaps.Control</a>)</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">Server.ServerTask</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn">tree</span>.<a href="../.././Lean/Server/Requests.html#Lean.Language.SnapshotTree.foldSnaps">foldSnaps</a></span> <span class="fn">init</span> <span class="fn">f</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask.mapCheap">Lean.Server.ServerTask.mapCheap</a> <span class="fn">(fun (<span class="fn">x</span> : <span class="fn">α</span> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Prelude.html#Bool">Bool</a>) =&gt; <span class="fn"><span class="fn">x</span>.<a href="../.././Init/Prelude.html#Prod.fst">fst</a></span>)</span>
    <span class="fn">(<a href="../.././Lean/Server/Requests.html#_private.Lean.Server.Requests.0.Lean.Language.SnapshotTree.foldSnaps.traverseTree">Lean.Language.SnapshotTree.foldSnaps.traverseTree✝</a> <span class="fn">f</span> <span class="fn">init</span> <span class="fn">tree</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Language.SnapshotTree.foldSnaps" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Language.SnapshotTree.findInfoTreeAtPos"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L88-L118">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Language.SnapshotTree.findInfoTreeAtPos"><span class="name">Lean</span>.<span class="name">Language</span>.<span class="name">SnapshotTree</span>.<span class="name">findInfoTreeAtPos</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">text</span> : <a href="../.././Lean/Data/Position.html#Lean.FileMap">FileMap</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">tree</span> : <a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTree">SnapshotTree</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hoverPos</span> : <a href="../.././Init/Prelude.html#String.Pos.Raw">String.Pos.Raw</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">includeStop</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">Server.ServerTask</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/InfoTree/Types.html#Lean.Elab.InfoTree">Elab.InfoTree</a>)</span></span></div></div><p>Finds the first (in pre-order) snapshot task in <code>tree</code> that contains <code>hoverPos</code>
(including whitespace) and which contains an info tree, and then returns that info tree,
waiting for any snapshot tasks on the way.
Subtrees that do not contain the position are skipped without forcing their tasks.
If the caller of this function needs the correct snapshot when the cursor is on whitespace,
then this function is likely the wrong one to call, as it simply yields the first snapshot
that contains <code>hoverPos</code> in its whitespace, which is not necessarily the correct one
(e.g. it may be indentation-sensitive).</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Language.SnapshotTree.findInfoTreeAtPos" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Language.SnapshotTree.foldInfosInRange"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L120-L138">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Language.SnapshotTree.foldInfosInRange"><span class="name">Lean</span>.<span class="name">Language</span>.<span class="name">SnapshotTree</span>.<span class="name">foldInfosInRange</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">tree</span> : <a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTree">SnapshotTree</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">requestedRange</span> : <a href="../.././Lean/Syntax.html#String.Range">String.Range</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">init</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><a href="../.././Lean/Elab/InfoTree/Types.html#Lean.Elab.ContextInfo">Elab.ContextInfo</a> → <span class="fn"><a href="../.././Lean/Elab/InfoTree/Types.html#Lean.Elab.Info">Elab.Info</a> → <span class="fn"><span class="fn">α</span> → <span class="fn">α</span></span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">Server.ServerTask</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Language.SnapshotTree.foldInfosInRange" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Language.SnapshotTree.collectMessagesInRange"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L140-L150">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Language.SnapshotTree.collectMessagesInRange"><span class="name">Lean</span>.<span class="name">Language</span>.<span class="name">SnapshotTree</span>.<span class="name">collectMessagesInRange</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">tree</span> : <a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTree">SnapshotTree</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">requestedRange</span> : <a href="../.././Lean/Syntax.html#String.Range">String.Range</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">Server.ServerTask</a> <a href="../.././Lean/Message.html#Lean.MessageLog">MessageLog</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Language.SnapshotTree.collectMessagesInRange" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestError"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L156-L159">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestError"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Server.RequestError.mk"><li id="Lean.Server.RequestError.code" class="structure_field"><div class="structure_field_info">code : <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.ErrorCode">JsonRpc.ErrorCode</a></div></li><li id="Lean.Server.RequestError.message" class="structure_field"><div class="structure_field_info">message : <a href="../.././Init/Prelude.html#String">String</a></div></li></ul><details id="instances-for-list-Lean.Server.RequestError" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.instInhabitedRequestError"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L159-L159">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.instInhabitedRequestError"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instInhabitedRequestError</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Server/Requests.html#Lean.Server.instInhabitedRequestError">Lean.Server.instInhabitedRequestError</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Inhabited.mk">{</a> <span class="fn">default</span> := <a href="../.././Lean/Server/Requests.html#Lean.Server.instInhabitedRequestError.default">Lean.Server.instInhabitedRequestError.default</a> <a href="../.././Init/Prelude.html#Inhabited.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Server.instInhabitedRequestError.default"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L159-L159">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.instInhabitedRequestError.default"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instInhabitedRequestError</span>.<span class="name">default</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Server/Requests.html#Lean.Server.instInhabitedRequestError.default">Lean.Server.instInhabitedRequestError.default</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">{</a> <span class="fn">code</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">message</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Server.instInhabitedRequestError.default" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestError.fileChanged"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L164-L166">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.fileChanged"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">fileChanged</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.fileChanged">Lean.Server.RequestError.fileChanged</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">{</a> <span class="fn">code</span> := <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.ErrorCode.contentModified">Lean.JsonRpc.ErrorCode.contentModified</a>, <span class="fn">message</span> := <span class="fn">&quot;File changed.&quot;</span> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Server.RequestError.fileChanged" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestError.methodNotFound"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L168-L170">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.methodNotFound"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">methodNotFound</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">method</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.methodNotFound">Lean.Server.RequestError.methodNotFound</a> <span class="fn">method</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">{</a> <span class="fn">code</span> := <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.ErrorCode.methodNotFound">Lean.JsonRpc.ErrorCode.methodNotFound</a>,
    <span class="fn">message</span> := <span class="fn"><a href="../.././Init/Data/ToString/Basic.html#ToString.toString">toString</a> <span class="fn">&quot;No request handler found for '&quot;</span></span> <a href="../.././Init/Prelude.html#HAppend.hAppend">++</a> <span class="fn"><a href="../.././Init/Data/ToString/Basic.html#ToString.toString">toString</a> <span class="fn">method</span></span> <a href="../.././Init/Prelude.html#HAppend.hAppend">++</a> <span class="fn"><a href="../.././Init/Data/ToString/Basic.html#ToString.toString">toString</a> <span class="fn">&quot;'&quot;</span></span> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Server.RequestError.methodNotFound" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestError.invalidParams"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L172-L173">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.invalidParams"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">invalidParams</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">message</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.invalidParams">Lean.Server.RequestError.invalidParams</a> <span class="fn">message</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">{</a> <span class="fn">code</span> := <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.ErrorCode.invalidParams">Lean.JsonRpc.ErrorCode.invalidParams</a>, <span class="fn">message</span> := <span class="fn">message</span> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Server.RequestError.invalidParams" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestError.internalError"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L175-L176">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.internalError"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">internalError</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">message</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.internalError">Lean.Server.RequestError.internalError</a> <span class="fn">message</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">{</a> <span class="fn">code</span> := <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.ErrorCode.internalError">Lean.JsonRpc.ErrorCode.internalError</a>, <span class="fn">message</span> := <span class="fn">message</span> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Server.RequestError.internalError" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestError.requestCancelled"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L178-L179">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.requestCancelled"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">requestCancelled</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.requestCancelled">Lean.Server.RequestError.requestCancelled</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">{</a> <span class="fn">code</span> := <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.ErrorCode.requestCancelled">Lean.JsonRpc.ErrorCode.requestCancelled</a>, <span class="fn">message</span> := <span class="fn">&quot;&quot;</span> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Server.RequestError.requestCancelled" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestError.rpcNeedsReconnect"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L181-L182">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.rpcNeedsReconnect"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">rpcNeedsReconnect</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.rpcNeedsReconnect">Lean.Server.RequestError.rpcNeedsReconnect</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">{</a> <span class="fn">code</span> := <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.ErrorCode.rpcNeedsReconnect">Lean.JsonRpc.ErrorCode.rpcNeedsReconnect</a>, <span class="fn">message</span> := <span class="fn">&quot;Outdated RPC session&quot;</span> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Server.RequestError.rpcNeedsReconnect" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestError.ofException"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L184-L185">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.ofException"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">ofException</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">e</span> : <a href="../.././Lean/Exception.html#Lean.Exception">Exception</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.ofException">Lean.Server.RequestError.ofException</a> <span class="fn">e</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn"><span class="fn"><span class="fn">e</span>.<a href="../.././Lean/Exception.html#Lean.Exception.toMessageData">toMessageData</a></span>.<a href="../.././Lean/Message.html#Lean.MessageData.toString">toString</a></span></span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.internalError">Lean.Server.RequestError.internalError</a> <span class="fn">__do_lift</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestError.ofException" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestError.ofIoError"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L187-L188">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.ofIoError"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">ofIoError</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">e</span> : <a href="../.././Init/System/IOError.html#IO.Error">IO.Error</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.ofIoError">Lean.Server.RequestError.ofIoError</a> <span class="fn">e</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.internalError">Lean.Server.RequestError.internalError</a> <span class="fn">(<a href="../.././Init/Data/ToString/Basic.html#ToString.toString">toString</a> <span class="fn">e</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestError.ofIoError" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestError.toLspResponseError"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L190-L193">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.toLspResponseError"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestError</span>.<span class="name">toLspResponseError</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">id</span> : <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.RequestID">JsonRpc.RequestID</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">e</span> : <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.ResponseError">JsonRpc.ResponseError</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.toLspResponseError">Lean.Server.RequestError.toLspResponseError</a> <span class="fn">id</span> <span class="fn">e</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.ResponseError.mk">{</a> <span class="fn">id</span> := <span class="fn">id</span>, <span class="fn">code</span> := <span class="fn"><span class="fn">e</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.code">code</a></span>, <span class="fn">message</span> := <span class="fn"><span class="fn">e</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.message">message</a></span> <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.ResponseError.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Server.RequestError.toLspResponseError" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.parseRequestParams"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L197-L202">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.parseRequestParams"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">parseRequestParams</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">paramType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.FromJson">FromJson</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">params</span> : <a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Except">Except</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a> <span class="fn">paramType</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.parseRequestParams" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.ServerRequestResponse"><div class="inductive"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L204-L207">source</a></div><div class="decl_header"><span class="decl_kind">inductive</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.ServerRequestResponse"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">ServerRequestResponse</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="constructors"><li class="constructor" id="Lean.Server.ServerRequestResponse.success">success<span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">response</span> : <span class="fn">α</span>)</span></span>
 : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.ServerRequestResponse">ServerRequestResponse</a> <span class="fn">α</span></span></li><li class="constructor" id="Lean.Server.ServerRequestResponse.failure">failure<span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">code</span> : <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.ErrorCode">JsonRpc.ErrorCode</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">message</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
 : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.ServerRequestResponse">ServerRequestResponse</a> <span class="fn">α</span></span></li></ul><details id="instances-for-list-Lean.Server.ServerRequestResponse" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.instInhabitedServerRequestResponse"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L207-L207">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.instInhabitedServerRequestResponse"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instInhabitedServerRequestResponse</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">a✝</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.ServerRequestResponse">ServerRequestResponse</a> <span class="fn">a✝</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Server/Requests.html#Lean.Server.instInhabitedServerRequestResponse">Lean.Server.instInhabitedServerRequestResponse</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Inhabited.mk">{</a> <span class="fn">default</span> := <a href="../.././Lean/Server/Requests.html#Lean.Server.instInhabitedServerRequestResponse.default">Lean.Server.instInhabitedServerRequestResponse.default</a> <a href="../.././Init/Prelude.html#Inhabited.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Server.instInhabitedServerRequestResponse.default"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L207-L207">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.instInhabitedServerRequestResponse.default"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instInhabitedServerRequestResponse</span>.<span class="name">default</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">a✝</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.ServerRequestResponse">ServerRequestResponse</a> <span class="fn">a✝</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Server/Requests.html#Lean.Server.instInhabitedServerRequestResponse.default">Lean.Server.instInhabitedServerRequestResponse.default</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.ServerRequestResponse.failure">Lean.Server.ServerRequestResponse.failure</a> <a href="../.././Init/Prelude.html#Inhabited.default">default</a> <a href="../.././Init/Prelude.html#Inhabited.default">default</a></span></li></ul></details><details id="instances-for-list-Lean.Server.instInhabitedServerRequestResponse.default" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.ServerRequestEmitter"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L209-L210">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.ServerRequestEmitter"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">ServerRequestEmitter</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Server/Requests.html#Lean.Server.ServerRequestEmitter">Lean.Server.ServerRequestEmitter</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">(<a href="../.././Init/Prelude.html#String">String</a> → <span class="fn"><a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Lean.Json</a> → <span class="fn"><a href="../.././Init/System/IO.html#BaseIO">BaseIO</a> <span class="fn">(<a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">Lean.Server.ServerTask</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.ServerRequestResponse">Lean.Server.ServerRequestResponse</a> <a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Lean.Json</a>)</span>)</span></span></span>)</span></li></ul></details><details id="instances-for-list-Lean.Server.ServerRequestEmitter" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestContext"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L212-L218">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestContext</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Server.RequestContext.mk"><li id="Lean.Server.RequestContext.rpcSessions" class="structure_field"><div class="structure_field_info">rpcSessions : <span class="fn"><a href="../.././Std/Data/TreeMap/Basic.html#Std.TreeMap">Std.TreeMap</a> <a href="../.././Init/Prelude.html#UInt64">UInt64</a> <span class="fn">(<a href="../.././Init/System/IO.html#IO.Ref">IO.Ref</a> <a href="../.././Lean/Server/FileWorker/Utils.html#Lean.Server.FileWorker.RpcSession">FileWorker.RpcSession</a>)</span> <a href="../.././Init/Data/Ord/Basic.html#Ord.compare">compare</a></span></div></li><li id="Lean.Server.RequestContext.doc" class="structure_field"><div class="structure_field_info">doc : <a href="../.././Lean/Server/FileWorker/Utils.html#Lean.Server.FileWorker.EditableDocument">FileWorker.EditableDocument</a></div></li><li id="Lean.Server.RequestContext.hLog" class="structure_field"><div class="structure_field_info">hLog : <a href="../.././Init/System/IO.html#IO.FS.Stream">IO.FS.Stream</a></div></li><li id="Lean.Server.RequestContext.initParams" class="structure_field"><div class="structure_field_info">initParams : <a href="../.././Lean/Data/Lsp/InitShutdown.html#Lean.Lsp.InitializeParams">Lsp.InitializeParams</a></div></li><li id="Lean.Server.RequestContext.cancelTk" class="structure_field"><div class="structure_field_info">cancelTk : <a href="../.././Lean/Server/RequestCancellation.html#Lean.Server.RequestCancellationToken">RequestCancellationToken</a></div></li><li id="Lean.Server.RequestContext.serverRequestEmitter" class="structure_field"><div class="structure_field_info">serverRequestEmitter : <a href="../.././Lean/Server/Requests.html#Lean.Server.ServerRequestEmitter">ServerRequestEmitter</a></div></li></ul><details id="instances-for-list-Lean.Server.RequestContext" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestTask"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L220-L220">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestTask</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a> u_1</div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">Lean.Server.RequestTask</a> <span class="fn">α</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">Lean.Server.ServerTask</a> <span class="fn">(<a href="../.././Init/Prelude.html#Except">Except</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">Lean.Server.RequestError</a> <span class="fn">α</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestTask" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestT"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L221-L221">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestT"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestT</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">m</span> : <span class="fn"><a href="../.././foundational_types.html">Type</a> → <a href="../.././foundational_types.html">Type</a> u_1</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a> u_1</div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestT">Lean.Server.RequestT</a> <span class="fn">m</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext">Lean.Server.RequestContext</a> <span class="fn">(<a href="../.././Init/Control/Except.html#ExceptT">ExceptT</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">Lean.Server.RequestError</a> <span class="fn">m</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestT" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L222-L223">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Workers execute request handlers in this monad.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">Lean.Server.RequestM</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext">Lean.Server.RequestContext</a> <span class="fn">(<a href="../.././Init/System/IO.html#EIO">EIO</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">Lean.Server.RequestError</a>)</span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.run"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L225-L226">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.run"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">run</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">act</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">rc</span> : <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext">RequestContext</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#EIO">EIO</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn">act</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.run">run</a></span> <span class="fn">rc</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">act</span> <span class="fn">rc</span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.run" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestTask.pure"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L228-L228">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask.pure"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestTask</span>.<span class="name">pure</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">a</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask.pure">Lean.Server.RequestTask.pure</a> <span class="fn">a</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask.pure">Lean.Server.ServerTask.pure</a> <span class="fn">(<a href="../.././Init/Prelude.html#Except.ok">Except.ok</a> <span class="fn">a</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestTask.pure" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.instMonadLiftIORequestM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L230-L234">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.instMonadLiftIORequestM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instMonadLiftIORequestM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#MonadLift">MonadLift</a> <a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Server.instMonadLiftEIOExceptionRequestM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L236-L240">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.instMonadLiftEIOExceptionRequestM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instMonadLiftEIOExceptionRequestM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#MonadLift">MonadLift</a> <span class="fn">(<a href="../.././Init/System/IO.html#EIO">EIO</a> <a href="../.././Lean/Exception.html#Lean.Exception">Exception</a>)</span> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Server.instMonadLiftCancellableMRequestM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L242-L248">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.instMonadLiftCancellableMRequestM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instMonadLiftCancellableMRequestM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#MonadLift">MonadLift</a> <a href="../.././Lean/Server/RequestCancellation.html#Lean.Server.CancellableM">CancellableM</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.runInIO"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L254-L255">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.runInIO"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">runInIO</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">ctx</span> : <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext">RequestContext</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn">x</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.runInIO">runInIO</a></span> <span class="fn">ctx</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#EStateM.adaptExcept">EStateM.adaptExcept</a> <span class="fn">(fun (<span class="fn">x</span> : <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">Lean.Server.RequestError</a>) =&gt; <span class="fn"><a href="../.././Init/System/IOError.html#IO.userError">IO.userError</a> <span class="fn"><span class="fn">x</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.message">message</a></span></span>)</span> <span class="fn">(<span class="fn"><span class="fn">x</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.run">run</a></span> <span class="fn">ctx</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.runInIO" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.readDoc"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L257-L259">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.readDoc"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">readDoc</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">m</span> : <span class="fn"><a href="../.././foundational_types.html">Type</a> → <a href="../.././foundational_types.html">Type</a> u_1</span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#MonadReaderOf">MonadReaderOf</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext">RequestContext</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <a href="../.././Lean/Server/FileWorker/Utils.html#Lean.Server.FileWorker.EditableDocument">FileWorker.EditableDocument</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.readDoc">Lean.Server.RequestM.readDoc</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">rc</span> ← <span class="fn"><a href="../.././Init/Prelude.html#readThe">readThe</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext">Lean.Server.RequestContext</a></span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">rc</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext.doc">doc</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.readDoc" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.asTask"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L261-L263">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.asTask"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">asTask</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">t</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">α</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn">t</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.asTask">asTask</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">rc</span> ← <span class="fn"><a href="../.././Init/Prelude.html#readThe">readThe</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext">Lean.Server.RequestContext</a></span>
  <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask.EIO.asTask">Lean.Server.ServerTask.EIO.asTask</a> <span class="fn">(<span class="fn"><span class="fn">t</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.run">run</a></span> <span class="fn">rc</span>)</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.asTask" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.pureTask"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L265-L267">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.pureTask"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">pureTask</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">t</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">α</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn">t</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.pureTask">pureTask</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">r</span> ← <span class="fn"><span class="fn">t</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.run">run</a></span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">(<a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask.pure">Lean.Server.ServerTask.pure</a> <span class="fn">(<a href="../.././Init/Prelude.html#Except.ok">Except.ok</a> <span class="fn">r</span>)</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.pureTask" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.mapTaskCheap"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L269-L271">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.mapTaskCheap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">mapTaskCheap</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">β</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">t</span> : <span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">ServerTask</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">β</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.mapTaskCheap">Lean.Server.RequestM.mapTaskCheap</a> <span class="fn">t</span> <span class="fn">f</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">rc</span> ← <span class="fn"><a href="../.././Init/Prelude.html#readThe">readThe</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext">Lean.Server.RequestContext</a></span>
  <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask.EIO.mapTaskCheap">Lean.Server.ServerTask.EIO.mapTaskCheap</a> <span class="fn">(fun (<span class="fn">x</span> : <span class="fn">α</span>) =&gt; <span class="fn"><span class="fn">f</span> <span class="fn">x</span> <span class="fn">rc</span></span>)</span> <span class="fn">t</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.mapTaskCheap" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.mapTaskCostly"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L273-L275">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.mapTaskCostly"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">mapTaskCostly</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">β</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">t</span> : <span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">ServerTask</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">β</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.mapTaskCostly">Lean.Server.RequestM.mapTaskCostly</a> <span class="fn">t</span> <span class="fn">f</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">rc</span> ← <span class="fn"><a href="../.././Init/Prelude.html#readThe">readThe</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext">Lean.Server.RequestContext</a></span>
  <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask.EIO.mapTaskCostly">Lean.Server.ServerTask.EIO.mapTaskCostly</a> <span class="fn">(fun (<span class="fn">x</span> : <span class="fn">α</span>) =&gt; <span class="fn"><span class="fn">f</span> <span class="fn">x</span> <span class="fn">rc</span></span>)</span> <span class="fn">t</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.mapTaskCostly" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.bindTaskCheap"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L277-L279">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.bindTaskCheap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">bindTaskCheap</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">β</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">t</span> : <span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">ServerTask</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.bindTaskCheap">Lean.Server.RequestM.bindTaskCheap</a> <span class="fn">t</span> <span class="fn">f</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">rc</span> ← <span class="fn"><a href="../.././Init/Prelude.html#readThe">readThe</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext">Lean.Server.RequestContext</a></span>
  <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask.EIO.bindTaskCheap">Lean.Server.ServerTask.EIO.bindTaskCheap</a> <span class="fn">t</span> <span class="fn">fun (<span class="fn">x</span> : <span class="fn">α</span>) =&gt; <span class="fn"><span class="fn">f</span> <span class="fn">x</span> <span class="fn">rc</span></span></span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.bindTaskCheap" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.bindTaskCostly"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L281-L283">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.bindTaskCostly"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">bindTaskCostly</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">β</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">t</span> : <span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">ServerTask</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.bindTaskCostly">Lean.Server.RequestM.bindTaskCostly</a> <span class="fn">t</span> <span class="fn">f</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">rc</span> ← <span class="fn"><a href="../.././Init/Prelude.html#readThe">readThe</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestContext">Lean.Server.RequestContext</a></span>
  <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask.EIO.bindTaskCostly">Lean.Server.ServerTask.EIO.bindTaskCostly</a> <span class="fn">t</span> <span class="fn">fun (<span class="fn">x</span> : <span class="fn">α</span>) =&gt; <span class="fn"><span class="fn">f</span> <span class="fn">x</span> <span class="fn">rc</span></span></span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.bindTaskCostly" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.mapRequestTaskCheap"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L285-L288">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.mapRequestTaskCheap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">mapRequestTaskCheap</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">β</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">t</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">β</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.mapRequestTaskCheap" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.mapRequestTaskCostly"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L290-L293">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.mapRequestTaskCostly"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">mapRequestTaskCostly</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">β</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">t</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">β</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.mapRequestTaskCostly" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.bindRequestTaskCheap"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L295-L298">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.bindRequestTaskCheap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">bindRequestTaskCheap</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">β</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">t</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.bindRequestTaskCheap" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.bindRequestTaskCostly"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L300-L303">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.bindRequestTaskCostly"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">bindRequestTaskCostly</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">β</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">t</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.bindRequestTaskCostly" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.parseRequestParams"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L305-L307">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.parseRequestParams"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">parseRequestParams</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">paramType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.FromJson">FromJson</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">params</span> : <a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">paramType</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.parseRequestParams">Lean.Server.RequestM.parseRequestParams</a> <span class="fn">paramType</span> <span class="fn">params</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<a href="../.././Init/System/IO.html#EIO.ofExcept">EIO.ofExcept</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.parseRequestParams">Lean.Server.parseRequestParams</a> <span class="fn">paramType</span> <span class="fn">params</span>)</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.parseRequestParams" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.checkCancelled"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L309-L312">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.checkCancelled"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">checkCancelled</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.checkCancelled" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.sendServerRequest"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L314-L326">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.sendServerRequest"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">sendServerRequest</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">paramType</span> : <a href="../.././foundational_types.html">Type</a> u_1)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.ToJson">ToJson</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">responseType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.FromJson">FromJson</a> <span class="fn">responseType</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">responseType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">method</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">param</span> : <span class="fn">paramType</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">ServerTask</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.ServerRequestResponse">ServerRequestResponse</a> <span class="fn">responseType</span>)</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.sendServerRequest" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.waitFindSnapAux"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L328-L335">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.waitFindSnapAux"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">waitFindSnapAux</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">notFoundX</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Server/Snapshots.html#Lean.Server.Snapshots.Snapshot">Snapshots.Snapshot</a> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">α</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#Except">Except</a> <a href="../.././Init/System/IOError.html#IO.Error">IO.Error</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Server/Snapshots.html#Lean.Server.Snapshots.Snapshot">Snapshots.Snapshot</a>)</span></span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">α</span></span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn">notFoundX</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.waitFindSnapAux">waitFindSnapAux</a></span> <span class="fn">x</span> <span class="fn">(<a href="../.././Init/Prelude.html#Except.error">Except.error</a> <span class="fn">e</span>)</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#MonadExcept.throw">throw</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError.ofIoError">Lean.Server.RequestError.ofIoError</a> <span class="fn">e</span>)</span></span></li><li class="equation"><span class="fn"><span class="fn"><span class="fn">notFoundX</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.waitFindSnapAux">waitFindSnapAux</a></span> <span class="fn">x</span> <span class="fn">(<a href="../.././Init/Prelude.html#Except.ok">Except.ok</a> <a href="../.././Init/Prelude.html#Option.none">none</a>)</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">notFoundX</span></li><li class="equation"><span class="fn"><span class="fn"><span class="fn">notFoundX</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.waitFindSnapAux">waitFindSnapAux</a></span> <span class="fn">x</span> <span class="fn">(<a href="../.././Init/Prelude.html#Except.ok">Except.ok</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">snap</span>)</span>)</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">x</span> <span class="fn">snap</span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.waitFindSnapAux" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.withWaitFindSnap"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L337-L345">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.withWaitFindSnap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">withWaitFindSnap</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">β</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">doc</span> : <a href="../.././Lean/Server/FileWorker/Utils.html#Lean.Server.FileWorker.EditableDocument">FileWorker.EditableDocument</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href="../.././Lean/Server/Snapshots.html#Lean.Server.Snapshots.Snapshot">Snapshots.Snapshot</a> → <a href="../.././Init/Prelude.html#Bool">Bool</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">notFoundX</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">β</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Server/Snapshots.html#Lean.Server.Snapshots.Snapshot">Snapshots.Snapshot</a> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">β</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></div></div><p>Create a task which waits for the first snapshot matching <code>p</code>, handles various errors,
and if a matching snapshot was found executes <code>x</code> with it. If not found, the task executes
<code>notFoundX</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.withWaitFindSnap">Lean.Server.RequestM.withWaitFindSnap</a> <span class="fn">doc</span> <span class="fn">p</span> <span class="fn">notFoundX</span> <span class="fn">x</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.mapTaskCostly">Lean.Server.RequestM.mapTaskCostly</a> <span class="fn">(<a href="../.././Lean/Server/AsyncList.html#IO.AsyncList.waitFind?">IO.AsyncList.waitFind?</a> <span class="fn">p</span> <span class="fn"><span class="fn">doc</span>.<a href="../.././Lean/Server/FileWorker/Utils.html#Lean.Server.FileWorker.EditableDocumentCore.cmdSnaps">cmdSnaps</a></span>)</span> <span class="fn">(<span class="fn"><span class="fn">notFoundX</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.waitFindSnapAux">waitFindSnapAux</a></span> <span class="fn">x</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.withWaitFindSnap" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.bindWaitFindSnap"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L347-L353">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.bindWaitFindSnap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">bindWaitFindSnap</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">β</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">doc</span> : <a href="../.././Lean/Server/FileWorker/Utils.html#Lean.Server.FileWorker.EditableDocument">FileWorker.EditableDocument</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href="../.././Lean/Server/Snapshots.html#Lean.Server.Snapshots.Snapshot">Snapshots.Snapshot</a> → <a href="../.././Init/Prelude.html#Bool">Bool</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">notFoundX</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Server/Snapshots.html#Lean.Server.Snapshots.Snapshot">Snapshots.Snapshot</a> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">β</span>)</span></span></div></div><p>See <code><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.withWaitFindSnap">withWaitFindSnap</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.bindWaitFindSnap">Lean.Server.RequestM.bindWaitFindSnap</a> <span class="fn">doc</span> <span class="fn">p</span> <span class="fn">notFoundX</span> <span class="fn">x</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.bindTaskCostly">Lean.Server.RequestM.bindTaskCostly</a> <span class="fn">(<a href="../.././Lean/Server/AsyncList.html#IO.AsyncList.waitFind?">IO.AsyncList.waitFind?</a> <span class="fn">p</span> <span class="fn"><span class="fn">doc</span>.<a href="../.././Lean/Server/FileWorker/Utils.html#Lean.Server.FileWorker.EditableDocumentCore.cmdSnaps">cmdSnaps</a></span>)</span> <span class="fn">(<span class="fn"><span class="fn">notFoundX</span>.<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.waitFindSnapAux">waitFindSnapAux</a></span> <span class="fn">x</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Server.RequestM.bindWaitFindSnap" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.withWaitFindSnapAtPos"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L355-L365">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.withWaitFindSnapAtPos"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">withWaitFindSnapAtPos</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">lspPos</span> : <a href="../.././Lean/Data/Lsp/BasicAux.html#Lean.Lsp.Position">Lsp.Position</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><a href="../.././Lean/Server/Snapshots.html#Lean.Server.Snapshots.Snapshot">Snapshots.Snapshot</a> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">α</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">α</span>)</span></span></div></div><p>Create a task which waits for the snapshot containing <code>lspPos</code> and executes <code>f</code> with it.
If no such snapshot exists, the request fails with an error.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.withWaitFindSnapAtPos" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.findCmdParsedSnap"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L368-L400">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.findCmdParsedSnap"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">findCmdParsedSnap</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doc</span> : <a href="../.././Lean/Server/FileWorker/Utils.html#Lean.Server.FileWorker.EditableDocument">FileWorker.EditableDocument</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hoverPos</span> : <a href="../.././Init/Prelude.html#String.Pos.Raw">String.Pos.Raw</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">ServerTask</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Language/Lean/Types.html#Lean.Language.Lean.CommandParsedSnapshot">Language.Lean.CommandParsedSnapshot</a>)</span></span></div></div><p>Finds the first <code>CommandParsedSnapshot</code> containing <code>hoverPos</code>, asynchronously.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.findCmdParsedSnap" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.findCmdDataAtPos"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L403-L420">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.findCmdDataAtPos"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">findCmdDataAtPos</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doc</span> : <a href="../.././Lean/Server/FileWorker/Utils.html#Lean.Server.FileWorker.EditableDocument">FileWorker.EditableDocument</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hoverPos</span> : <a href="../.././Init/Prelude.html#String.Pos.Raw">String.Pos.Raw</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">includeStop</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">ServerTask</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> (<a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Lean/Elab/InfoTree/Types.html#Lean.Elab.InfoTree">Elab.InfoTree</a>))</span></span></div></div><p>Finds the command syntax and info tree of the first snapshot task containing <code>pos</code>, asynchronously.
The info tree may be from a nested snapshot, such as a single tactic.</p><p>See <code><a href="../.././Lean/Server/Requests.html#Lean.Language.SnapshotTree.findInfoTreeAtPos">SnapshotTree.findInfoTreeAtPos</a></code> for details on how the search is done.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.findCmdDataAtPos" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.findInfoTreeAtPos"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L423-L434">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.findInfoTreeAtPos"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">findInfoTreeAtPos</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doc</span> : <a href="../.././Lean/Server/FileWorker/Utils.html#Lean.Server.FileWorker.EditableDocument">FileWorker.EditableDocument</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hoverPos</span> : <a href="../.././Init/Prelude.html#String.Pos.Raw">String.Pos.Raw</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">includeStop</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">ServerTask</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/InfoTree/Types.html#Lean.Elab.InfoTree">Elab.InfoTree</a>)</span></span></div></div><p>Finds the info tree of the first snapshot task containing <code>pos</code>, asynchronously.
The info tree may be from a nested snapshot, such as a single tactic.</p><p>See <code><a href="../.././Lean/Server/Requests.html#Lean.Language.SnapshotTree.findInfoTreeAtPos">SnapshotTree.findInfoTreeAtPos</a></code> for details on how the search is done.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.findInfoTreeAtPos" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.runCommandElabM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L437-L441">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.runCommandElabM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">runCommandElabM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">snap</span> : <a href="../.././Lean/Server/Snapshots.html#Lean.Server.Snapshots.Snapshot">Snapshots.Snapshot</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestT">RequestT</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Elab.Command.CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.runCommandElabM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.runCoreM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L443-L447">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.runCoreM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">runCoreM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">snap</span> : <a href="../.././Lean/Server/Snapshots.html#Lean.Server.Snapshots.Snapshot">Snapshots.Snapshot</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestT">RequestT</a> <a href="../.././Lean/CoreM.html#Lean.Core.CoreM">CoreM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.runCoreM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestM.runTermElabM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L450-L454">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestM.runTermElabM"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestM</span>.<span class="name">runTermElabM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">snap</span> : <a href="../.././Lean/Server/Snapshots.html#Lean.Server.Snapshots.Snapshot">Snapshots.Snapshot</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestT">RequestT</a> <a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">Elab.TermElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.RequestM.runTermElabM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="mod_doc"><h1 class="markdown-heading" id="The-global-request-handlers-table">The global request handlers table <a class="hover-link" href="#The-global-request-handlers-table">#</a></h1><p>We maintain a global map of LSP request handlers. This allows user code such as plugins
to register its own handlers, for example to support ITP functionality such as goal state
visualization.</p><p>For details of how to register one, see <code><a href="../.././Lean/Server/Requests.html#Lean.Server.registerLspRequestHandler">registerLspRequestHandler</a></code>.</p></div><div class="decl" id="Lean.Server.LspResponse"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L468-L470">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.LspResponse"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">LspResponse</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Server.LspResponse.mk"><li id="Lean.Server.LspResponse.response" class="structure_field"><div class="structure_field_info">response : <span class="fn">α</span></div></li><li id="Lean.Server.LspResponse.isComplete" class="structure_field"><div class="structure_field_info">isComplete : <a href="../.././Init/Prelude.html#Bool">Bool</a></div></li></ul><details id="instances-for-list-Lean.Server.LspResponse" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.SerializedLspResponse"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L472-L475">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.SerializedLspResponse"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">SerializedLspResponse</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Server.SerializedLspResponse.mk"><li id="Lean.Server.SerializedLspResponse.response?" class="structure_field"><div class="structure_field_info">response? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a></span></div></li><li id="Lean.Server.SerializedLspResponse.serialized" class="structure_field"><div class="structure_field_info">serialized : <a href="../.././Init/Prelude.html#String">String</a></div></li><li id="Lean.Server.SerializedLspResponse.isComplete" class="structure_field"><div class="structure_field_info">isComplete : <a href="../.././Init/Prelude.html#Bool">Bool</a></div></li></ul><details id="instances-for-list-Lean.Server.SerializedLspResponse" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.SerializedLspResponse.toSerializedMessage"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L479-L485">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.SerializedLspResponse.toSerializedMessage"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">SerializedLspResponse</span>.<span class="name">toSerializedMessage</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">id</span> : <a href="../.././Lean/Data/JsonRpc.html#Lean.JsonRpc.RequestID">JsonRpc.RequestID</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">r</span> : <a href="../.././Lean/Server/Requests.html#Lean.Server.SerializedLspResponse">SerializedLspResponse</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#String">String</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.SerializedLspResponse.toSerializedMessage" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestHandler"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L487-L489">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestHandler</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Server.RequestHandler.mk"><li id="Lean.Server.RequestHandler.fileSource" class="structure_field"><div class="structure_field_info">fileSource : <span class="fn"><a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a> → <span class="fn"><a href="../.././Init/Prelude.html#Except">Except</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a> <a href="../.././Lean/Server/FileSource.html#Lean.Lsp.FileIdent">Lsp.FileIdent</a></span></span></div></li><li id="Lean.Server.RequestHandler.handle" class="structure_field"><div class="structure_field_info">handle : <span class="fn"><a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.SerializedLspResponse">SerializedLspResponse</a>)</span></span></span></div></li></ul><details id="instances-for-list-Lean.Server.RequestHandler" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.requestHandlers"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L491-L492">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.requestHandlers"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">requestHandlers</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO.Ref">IO.Ref</a> <span class="fn">(<a href="../.././Lean/Data/PersistentHashMap.html#Lean.PersistentHashMap">PersistentHashMap</a> <a href="../.././Init/Prelude.html#String">String</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestHandler">RequestHandler</a>)</span></span></div></div></div></div><div class="decl" id="Lean.Server.registerLspRequestHandler"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L494-L538">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.registerLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">registerLspRequestHandler</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">method</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">paramType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.FromJson">FromJson</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Server/FileSource.html#Lean.Lsp.FileSource">Lsp.FileSource</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">respType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.ToJson">ToJson</a> <span class="fn">respType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">handler</span> : <span class="fn"><span class="fn">paramType</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">respType</span>)</span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">serialize?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <span class="fn">(<span class="fn">respType</span> → <a href="../.././Init/Prelude.html#String">String</a>)</span></span> := <a href="../.././Init/Prelude.html#Option.none">none</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>NB: This method may only be called in <code>initialize</code> blocks (user or builtin).</p><p>A registration consists of:</p><ul>
<li>a type of JSON-parsable request data <code>paramType</code></li>
<li>a <code>FileSource</code> instance for it so the system knows where to route requests</li>
<li>a type of JSON-serializable response data <code>respType</code></li>
<li>an actual <code>handler</code> which runs in the <code><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a></code> monad and is expected
to produce an asynchronous <code><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a></code> which does any waiting/computation</li>
<li>an optional <code>serialize</code> function which can be used to serialize <code>respType</code> directly to a string
for performance reasons, skipping <code>Json</code></li>
</ul><p>A handler task may be cancelled at any time, so it should check the cancellation token when possible
to handle this cooperatively. Any exceptions thrown in a request handler will be reported to the client
as LSP error responses.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.registerLspRequestHandler" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.lookupLspRequestHandler"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L540-L541">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.lookupLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">lookupLspRequestHandler</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">method</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestHandler">RequestHandler</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.lookupLspRequestHandler">Lean.Server.lookupLspRequestHandler</a> <span class="fn">method</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn"><a href="../.././Init/System/ST.html#ST.Ref.get">ST.Ref.get</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.requestHandlers">Lean.Server.requestHandlers</a></span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">(<span class="fn"><span class="fn">__do_lift</span>.<a href="../.././Lean/Data/PersistentHashMap.html#Lean.PersistentHashMap.find?">find?</a></span> <span class="fn">method</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.lookupLspRequestHandler" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.chainLspRequestHandler"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L543-L582">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.chainLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">chainLspRequestHandler</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">method</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">paramType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.FromJson">FromJson</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">respType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.FromJson">FromJson</a> <span class="fn">respType</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.ToJson">ToJson</a> <span class="fn">respType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">handler</span> : <span class="fn"><span class="fn">paramType</span> → <span class="fn"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">respType</span></span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <span class="fn">respType</span>)</span></span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>NB: This method may only be called in <code>initialize</code> blocks (user or builtin).</p><p>Register another handler to invoke after the last one registered for a method.
At least one handler for the method must have already been registered to perform
chaining.</p><p>For more details on the registration of a handler, see <code><a href="../.././Lean/Server/Requests.html#Lean.Server.registerLspRequestHandler">registerLspRequestHandler</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.chainLspRequestHandler" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RequestHandlerCompleteness"><div class="inductive"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L584-L597">source</a></div><div class="decl_header"><span class="decl_kind">inductive</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.RequestHandlerCompleteness"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RequestHandlerCompleteness</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="constructors"><li class="constructor" id="Lean.Server.RequestHandlerCompleteness.complete">complete : <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestHandlerCompleteness">RequestHandlerCompleteness</a></li><li class="constructor" id="Lean.Server.RequestHandlerCompleteness.partial">partial<span class="decl_args">
<span class="fn">(<span class="fn">refreshMethod</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">refreshIntervalMs</span> : <a href="../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
 : <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestHandlerCompleteness">RequestHandlerCompleteness</a><div class="inductive_ctor_doc"><p>A request handler is partial if the LSP spec states that the request method implemented by
the handler should be responded to with the full state of the document, but our implementation
of the handler only returns a partial result for the document
(e.g. only for the processed regions of the document, to reduce latency after a <code>didChange</code>).
A request handler can only be partial if LSP also specifies a corresponding <code>refresh</code>
server-to-client request, e.g. <code>workspace/inlayHint/refresh</code> for <code>textDocument/inlayHint</code>.
This is necessary because we use the <code>refresh</code> request to prompt the client to re-request the
data for a partial request if we returned a partial response for that request in the past,
so that the client eventually converges to a complete set of information for the full document.</p></div></li></ul><details id="instances-for-list-Lean.Server.RequestHandlerCompleteness" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.StatefulRequestHandler"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L599-L620">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.StatefulRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">StatefulRequestHandler</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Server.StatefulRequestHandler.mk"><li id="Lean.Server.StatefulRequestHandler.fileSource" class="structure_field"><div class="structure_field_info">fileSource : <span class="fn"><a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a> → <span class="fn"><a href="../.././Init/Prelude.html#Except">Except</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a> <a href="../.././Lean/Server/FileSource.html#Lean.Lsp.FileIdent">Lsp.FileIdent</a></span></span></div></li><li id="Lean.Server.StatefulRequestHandler.pureHandle" class="structure_field"><div class="structure_field_info">pureHandle : <span class="fn"><a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a> → <span class="fn"><a href="../.././Init/Dynamic.html#Dynamic">Dynamic</a> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> (<a href="../.././Lean/Server/Requests.html#Lean.Server.SerializedLspResponse">SerializedLspResponse</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Dynamic.html#Dynamic">Dynamic</a>)</span></span></span></div><div class="structure_field_doc"><p><code><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestHandler.handle">handle</a></code> with explicit state management for chaining request handlers.
This function is pure w.r.t. <code><a href="../.././Lean/Server/Requests.html#Lean.Server.StatefulRequestHandler.lastTaskMutex">lastTaskMutex</a></code> and <code><a href="../.././Lean/Server/Requests.html#Lean.Server.StatefulRequestHandler.stateRef">stateRef</a></code>, but not <code><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a></code>.</p></div></li><li id="Lean.Server.StatefulRequestHandler.handle" class="structure_field"><div class="structure_field_info">handle : <span class="fn"><a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.SerializedLspResponse">SerializedLspResponse</a>)</span></span></span></div></li><li id="Lean.Server.StatefulRequestHandler.pureOnDidChange" class="structure_field"><div class="structure_field_info">pureOnDidChange : <span class="fn"><a href="../.././Lean/Data/Lsp/TextSync.html#Lean.Lsp.DidChangeTextDocumentParams">Lsp.DidChangeTextDocumentParams</a> → <span class="fn"><a href="../.././Init/Control/State.html#StateT">StateT</a> <a href="../.././Init/Dynamic.html#Dynamic">Dynamic</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></span></div><div class="structure_field_doc"><p><code><a href="../.././Lean/Server/Requests.html#Lean.Server.StatefulRequestHandler.onDidChange">onDidChange</a></code> with explicit state management for chaining request handlers.
This function is pure w.r.t. <code><a href="../.././Lean/Server/Requests.html#Lean.Server.StatefulRequestHandler.lastTaskMutex">lastTaskMutex</a></code> and <code><a href="../.././Lean/Server/Requests.html#Lean.Server.StatefulRequestHandler.stateRef">stateRef</a></code>, but not <code><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a></code>.</p></div></li><li id="Lean.Server.StatefulRequestHandler.onDidChange" class="structure_field"><div class="structure_field_info">onDidChange : <span class="fn"><a href="../.././Lean/Data/Lsp/TextSync.html#Lean.Lsp.DidChangeTextDocumentParams">Lsp.DidChangeTextDocumentParams</a> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></span></div></li><li id="Lean.Server.StatefulRequestHandler.lastTaskMutex" class="structure_field"><div class="structure_field_info">lastTaskMutex : <span class="fn"><a href="../.././Std/Sync/Mutex.html#Std.Mutex">Std.Mutex</a> <span class="fn">(<a href="../.././Lean/Server/ServerTask.html#Lean.Server.ServerTask">ServerTask</a> <a href="../.././Init/Prelude.html#Unit">Unit</a>)</span></span></div></li><li id="Lean.Server.StatefulRequestHandler.initState" class="structure_field"><div class="structure_field_info">initState : <a href="../.././Init/Dynamic.html#Dynamic">Dynamic</a></div></li><li id="Lean.Server.StatefulRequestHandler.stateRef" class="structure_field"><div class="structure_field_info">stateRef : <span class="fn"><a href="../.././Init/System/IO.html#IO.Ref">IO.Ref</a> <a href="../.././Init/Dynamic.html#Dynamic">Dynamic</a></span></div><div class="structure_field_doc"><p><code><a href="../.././Lean/Server/Requests.html#Lean.Server.StatefulRequestHandler.stateRef">stateRef</a></code> is synchronized in <code>registerStatefulLspRequestHandler</code> by using <code><a href="../.././Lean/Server/Requests.html#Lean.Server.StatefulRequestHandler.lastTaskMutex">lastTaskMutex</a></code> to
ensure that stateful request tasks for the same handler are executed sequentially (in order of arrival).</p></div></li><li id="Lean.Server.StatefulRequestHandler.completeness" class="structure_field"><div class="structure_field_info">completeness : <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestHandlerCompleteness">RequestHandlerCompleteness</a></div></li></ul><details id="instances-for-list-Lean.Server.StatefulRequestHandler" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.statefulRequestHandlers"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L622-L623">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.statefulRequestHandlers"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">statefulRequestHandlers</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO.Ref">IO.Ref</a> <span class="fn">(<a href="../.././Lean/Data/PersistentHashMap.html#Lean.PersistentHashMap">PersistentHashMap</a> <a href="../.././Init/Prelude.html#String">String</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.StatefulRequestHandler">StatefulRequestHandler</a>)</span></span></div></div></div></div><div class="decl" id="Lean.Server.registerCompleteStatefulLspRequestHandler"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L707-L718">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.registerCompleteStatefulLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">registerCompleteStatefulLspRequestHandler</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">method</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">paramType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.FromJson">FromJson</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Server/FileSource.html#Lean.Lsp.FileSource">Lsp.FileSource</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">respType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.ToJson">ToJson</a> <span class="fn">respType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">stateType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Dynamic.html#TypeName">TypeName</a> <span class="fn">stateType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">initState</span> : <span class="fn">stateType</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">handler</span> : <span class="fn"><span class="fn">paramType</span> → <span class="fn"><span class="fn">stateType</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> (<span class="fn">respType</span> <a href="../.././Init/Prelude.html#Prod">×</a> <span class="fn">stateType</span>)</span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">onDidChange</span> : <span class="fn"><a href="../.././Lean/Data/Lsp/TextSync.html#Lean.Lsp.DidChangeTextDocumentParams">Lsp.DidChangeTextDocumentParams</a> → <span class="fn"><a href="../.././Init/Control/State.html#StateT">StateT</a> <span class="fn">stateType</span> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.registerCompleteStatefulLspRequestHandler" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.registerPartialStatefulLspRequestHandler"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L720-L727">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.registerPartialStatefulLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">registerPartialStatefulLspRequestHandler</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">method </span><span class="fn">refreshMethod</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">refreshIntervalMs</span> : <a href="../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">paramType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.FromJson">FromJson</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Server/FileSource.html#Lean.Lsp.FileSource">Lsp.FileSource</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">respType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.ToJson">ToJson</a> <span class="fn">respType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">stateType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Dynamic.html#TypeName">TypeName</a> <span class="fn">stateType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">initState</span> : <span class="fn">stateType</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">handler</span> : <span class="fn"><span class="fn">paramType</span> → <span class="fn"><span class="fn">stateType</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> (<span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.LspResponse">LspResponse</a> <span class="fn">respType</span></span> <a href="../.././Init/Prelude.html#Prod">×</a> <span class="fn">stateType</span>)</span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">onDidChange</span> : <span class="fn"><a href="../.././Lean/Data/Lsp/TextSync.html#Lean.Lsp.DidChangeTextDocumentParams">Lsp.DidChangeTextDocumentParams</a> → <span class="fn"><a href="../.././Init/Control/State.html#StateT">StateT</a> <span class="fn">stateType</span> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.registerPartialStatefulLspRequestHandler" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.isStatefulLspRequestMethod"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L729-L730">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.isStatefulLspRequestMethod"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">isStatefulLspRequestMethod</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">method</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#BaseIO">BaseIO</a> <a href="../.././Init/Prelude.html#Bool">Bool</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.isStatefulLspRequestMethod">Lean.Server.isStatefulLspRequestMethod</a> <span class="fn">method</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn"><a href="../.././Init/System/ST.html#ST.Ref.get">ST.Ref.get</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.statefulRequestHandlers">Lean.Server.statefulRequestHandlers</a></span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">(<span class="fn"><span class="fn">__do_lift</span>.<a href="../.././Lean/Data/PersistentHashMap.html#Lean.PersistentHashMap.contains">contains</a></span> <span class="fn">method</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.isStatefulLspRequestMethod" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.lookupStatefulLspRequestHandler"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L732-L733">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.lookupStatefulLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">lookupStatefulLspRequestHandler</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">method</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#BaseIO">BaseIO</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.StatefulRequestHandler">StatefulRequestHandler</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.lookupStatefulLspRequestHandler">Lean.Server.lookupStatefulLspRequestHandler</a> <span class="fn">method</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn"><a href="../.././Init/System/ST.html#ST.Ref.get">ST.Ref.get</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.statefulRequestHandlers">Lean.Server.statefulRequestHandlers</a></span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">(<span class="fn"><span class="fn">__do_lift</span>.<a href="../.././Lean/Data/PersistentHashMap.html#Lean.PersistentHashMap.find?">find?</a></span> <span class="fn">method</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.lookupStatefulLspRequestHandler" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.partialLspRequestHandlerMethods"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L735-L739">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.partialLspRequestHandlerMethods"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">partialLspRequestHandlerMethods</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> (<a href="../.././Init/Prelude.html#String">String</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Prelude.html#String">String</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Prelude.html#Nat">Nat</a>))</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.partialLspRequestHandlerMethods" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.chainStatefulLspRequestHandler"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L741-L773">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.chainStatefulLspRequestHandler"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">chainStatefulLspRequestHandler</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">method</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">paramType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.FromJson">FromJson</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.ToJson">ToJson</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Server/FileSource.html#Lean.Lsp.FileSource">Lsp.FileSource</a> <span class="fn">paramType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">respType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.FromJson">FromJson</a> <span class="fn">respType</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/Data/Json/FromToJson/Basic.html#Lean.ToJson">ToJson</a> <span class="fn">respType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">stateType</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Dynamic.html#TypeName">TypeName</a> <span class="fn">stateType</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">handler</span> : <span class="fn"><span class="fn">paramType</span> → <span class="fn"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.LspResponse">LspResponse</a> <span class="fn">respType</span></span> → <span class="fn"><span class="fn">stateType</span> → <span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> (<span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.LspResponse">LspResponse</a> <span class="fn">respType</span></span> <a href="../.././Init/Prelude.html#Prod">×</a> <span class="fn">stateType</span>)</span></span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">onDidChange</span> : <span class="fn"><a href="../.././Lean/Data/Lsp/TextSync.html#Lean.Lsp.DidChangeTextDocumentParams">Lsp.DidChangeTextDocumentParams</a> → <span class="fn"><a href="../.././Init/Control/State.html#StateT">StateT</a> <span class="fn">stateType</span> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.chainStatefulLspRequestHandler" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.handleOnDidChange"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L775-L777">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.handleOnDidChange"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">handleOnDidChange</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <a href="../.././Lean/Data/Lsp/TextSync.html#Lean.Lsp.DidChangeTextDocumentParams">Lsp.DidChangeTextDocumentParams</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.handleOnDidChange" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.handleLspRequest"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L779-L791">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.handleLspRequest"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">handleLspRequest</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">method</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">params</span> : <a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Server/Requests.html#Lean.Server.RequestM">RequestM</a> <span class="fn">(<a href="../.././Lean/Server/Requests.html#Lean.Server.RequestTask">RequestTask</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.SerializedLspResponse">SerializedLspResponse</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.handleLspRequest" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.routeLspRequest"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Server/Requests.lean#L793-L801">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Server/Requests.html#Lean.Server.routeLspRequest"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">routeLspRequest</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">method</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">params</span> : <a href="../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <span class="fn">(<a href="../.././Init/Prelude.html#Except">Except</a> <a href="../.././Lean/Server/Requests.html#Lean.Server.RequestError">RequestError</a> <a href="../.././Lean/Server/FileSource.html#Lean.Lsp.FileIdent">Lsp.FileIdent</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.routeLspRequest" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>