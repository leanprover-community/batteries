<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../../.././style.css"></link><link rel="icon" href="../../.././favicon.svg"></link><link rel="mask-icon" href="../../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Compiler.LCNF.LambdaLifting</title><script defer="true" src="../../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../../.././";</script><script>const MODULE_NAME="Lean.Compiler.LCNF.LambdaLifting";</script><script type="module" src="../../.././jump-src.js"></script><script type="module" src="../../.././search.js"></script><script type="module" src="../../.././expand-nav.js"></script><script type="module" src="../../.././how-about.js"></script><script type="module" src="../../.././instances.js"></script><script type="module" src="../../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../../.././Lean/Compiler/LCNF/AuxDeclCache.html">Lean.Compiler.LCNF.AuxDeclCache</a></li><li><a href="../../.././Lean/Compiler/LCNF/Closure.html">Lean.Compiler.LCNF.Closure</a></li><li><a href="../../.././Lean/Compiler/LCNF/Level.html">Lean.Compiler.LCNF.Level</a></li><li><a href="../../.././Lean/Compiler/LCNF/MonadScope.html">Lean.Compiler.LCNF.MonadScope</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Compiler.LCNF.LambdaLifting" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.Context"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">Context</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.State"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">State</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.LiftM"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">LiftM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.hasInstParam"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">hasInstParam</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.shouldLift"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">shouldLift</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.mkAuxDeclName"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">mkAuxDeclName</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.replaceFunDecl"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">replaceFunDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.mkAuxDecl"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">mkAuxDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.etaContractibleDecl?"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">etaContractibleDecl?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.visitFunDecl"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">visitFunDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.visitCode"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">visitCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.LambdaLifting.main"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">main</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.Decl.lambdaLifting"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">Decl</span>.<span class="name">lambdaLifting</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.lambdaLifting"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">lambdaLifting</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Compiler.LCNF.eagerLambdaLifting"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">eagerLambdaLifting</span></a></div></nav><main>
<div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.Context"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L19-L46">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.Context"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">Context</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././foundational_types.html">Type</a></div></div><p>Context for the <code><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.LiftM">LiftM</a></code> monad.</p><ul class="structure_fields" id="Lean.Compiler.LCNF.LambdaLifting.Context.mk"><li id="Lean.Compiler.LCNF.LambdaLifting.Context.liftInstParamOnly" class="structure_field"><div class="structure_field_info">liftInstParamOnly : <a href="../../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>If <code><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.Context.liftInstParamOnly">liftInstParamOnly</a></code> is <code>true</code>, then only local functions that take
local instances as parameters are lambda lifted.</p></div></li><li id="Lean.Compiler.LCNF.LambdaLifting.Context.suffix" class="structure_field"><div class="structure_field_info">suffix : <a href="../../.././Init/Prelude.html#Lean.Name">Name</a></div><div class="structure_field_doc"><p>Suffix for the new auxiliary declarations being created.</p></div></li><li id="Lean.Compiler.LCNF.LambdaLifting.Context.mainDecl" class="structure_field"><div class="structure_field_info">mainDecl : <span class="fn"><a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Decl">Decl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a></span></div><div class="structure_field_doc"><p>Declaration where lambda lifting is being applied.
We use it to provide the &quot;base name&quot; for auxiliary declarations and the flag <code>safe</code>.</p></div></li><li id="Lean.Compiler.LCNF.LambdaLifting.Context.inheritInlineAttrs" class="structure_field"><div class="structure_field_info">inheritInlineAttrs : <a href="../../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>If true, the lambda-lifted functions inherit the inline attribute from <code><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.Context.mainDecl">mainDecl</a></code>.
We use this feature to implement <code>@[inline] instance ...</code> and <code>@[always_inline] instance ...</code></p></div></li><li id="Lean.Compiler.LCNF.LambdaLifting.Context.minSize" class="structure_field"><div class="structure_field_info">minSize : <a href="../../.././Init/Prelude.html#Nat">Nat</a></div><div class="structure_field_doc"><p>Only local functions with <code>size &gt; <a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.Context.minSize">minSize</a></code> are lambda lifted.
We use this feature to implement <code>@[inline] instance ...</code> and <code>@[always_inline] instance ...</code></p></div></li><li id="Lean.Compiler.LCNF.LambdaLifting.Context.allowEtaContraction" class="structure_field"><div class="structure_field_info">allowEtaContraction : <a href="../../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>Allow for eta contraction instead of lifting to a lambda if possible.</p></div></li></ul><details id="instances-for-list-Lean.Compiler.LCNF.LambdaLifting.Context" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.State"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L49-L58">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.State"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">State</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././foundational_types.html">Type</a></div></div><p>State for the <code><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.LiftM">LiftM</a></code> monad.</p><ul class="structure_fields" id="Lean.Compiler.LCNF.LambdaLifting.State.mk"><li id="Lean.Compiler.LCNF.LambdaLifting.State.decls" class="structure_field"><div class="structure_field_info">decls : <span class="fn"><a href="../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Decl">Decl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a>)</span></span></div><div class="structure_field_doc"><p>New auxiliary declarations</p></div></li><li id="Lean.Compiler.LCNF.LambdaLifting.State.nextIdx" class="structure_field"><div class="structure_field_info">nextIdx : <a href="../../.././Init/Prelude.html#Nat">Nat</a></div><div class="structure_field_doc"><p>Next index for generating auxiliary declaration name.</p></div></li></ul><details id="instances-for-list-Lean.Compiler.LCNF.LambdaLifting.State" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.LiftM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L60-L61">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.LiftM"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">LiftM</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">Î±</span> : <a href="../../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../../.././foundational_types.html">Type</a></div></div><p>Monad for applying lambda lifting.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Compiler.LCNF.LambdaLifting.LiftM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.hasInstParam"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L63-L68">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.hasInstParam"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">hasInstParam</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">decl</span> : <span class="fn"><a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.FunDecl">FunDecl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Compiler/LCNF/CompilerM.html#Lean.Compiler.LCNF.CompilerM">CompilerM</a> <a href="../../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Return <code>true</code> if the given declaration takes a local instance as a parameter.
We lambda lift this kind of local function declaration before specialization.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Compiler.LCNF.LambdaLifting.hasInstParam" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.shouldLift"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L70-L80">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.shouldLift"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">shouldLift</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">decl</span> : <span class="fn"><a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.FunDecl">FunDecl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.LiftM">LiftM</a> <a href="../../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Return <code>true</code> if the given declaration should be lambda lifted.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Compiler.LCNF.LambdaLifting.shouldLift" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.mkAuxDeclName"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L82-L86">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.mkAuxDeclName"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">mkAuxDeclName</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.LiftM">LiftM</a> <a href="../../.././Init/Prelude.html#Lean.Name">Name</a></span></div></div></div></div><div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.replaceFunDecl"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L88-L93">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.replaceFunDecl"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">replaceFunDecl</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">decl</span> : <span class="fn"><a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.FunDecl">FunDecl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">value</span> : <span class="fn"><a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.LetValue">LetValue</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.LiftM">LiftM</a> <span class="fn">(<a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.LetDecl">LetDecl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Compiler.LCNF.LambdaLifting.replaceFunDecl" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.mkAuxDecl"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L96-L123">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.mkAuxDecl"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">mkAuxDecl</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">closure</span> : <span class="fn"><a href="../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Param">Param</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">decl</span> : <span class="fn"><a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.FunDecl">FunDecl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.LiftM">LiftM</a> <span class="fn">(<a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.LetDecl">LetDecl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a>)</span></span></div></div><p>Create a new auxiliary declaration. The array <code>closure</code> contains all free variables
occurring in <code>decl</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Compiler.LCNF.LambdaLifting.mkAuxDecl" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.etaContractibleDecl?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L125-L137">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.etaContractibleDecl?"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">etaContractibleDecl?</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">decl</span> : <span class="fn"><a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.FunDecl">FunDecl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.LiftM">LiftM</a> <span class="fn">(<a href="../../.././Init/Prelude.html#Option">Option</a> <span class="fn">(<a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.LetDecl">LetDecl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a>)</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Compiler.LCNF.LambdaLifting.etaContractibleDecl?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.visitFunDecl"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L140-L142">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.visitFunDecl"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">visitFunDecl</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">funDecl</span> : <span class="fn"><a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.FunDecl">FunDecl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.LiftM">LiftM</a> <span class="fn">(<a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.FunDecl">FunDecl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a>)</span></span></div></div></div></div><div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.visitCode"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L144-L174">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.visitCode"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">visitCode</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">code</span> : <span class="fn"><a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Code">Code</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.LiftM">LiftM</a> <span class="fn">(<a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Code">Code</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a>)</span></span></div></div></div></div><div class="decl" id="Lean.Compiler.LCNF.LambdaLifting.main"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L177-L179">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.main"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">LambdaLifting</span>.<span class="name">main</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">decl</span> : <span class="fn"><a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Decl">Decl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.LambdaLifting.LiftM">LiftM</a> <span class="fn">(<a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Decl">Decl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Compiler.LCNF.LambdaLifting.main" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Compiler.LCNF.Decl.lambdaLifting"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L183-L194">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.Decl.lambdaLifting"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">Decl</span>.<span class="name">lambdaLifting</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">decl</span> : <span class="fn"><a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Decl">Decl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">liftInstParamOnly </span><span class="fn">allowEtaContraction</span> : <a href="../../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">suffix</span> : <a href="../../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">inheritInlineAttrs</span> : <a href="../../.././Init/Prelude.html#Bool">Bool</a> := <a href="../../.././Init/Prelude.html#Bool.false">false</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">minSize</span> : <a href="../../.././Init/Prelude.html#Nat">Nat</a> := <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Compiler/LCNF/CompilerM.html#Lean.Compiler.LCNF.CompilerM">CompilerM</a> <span class="fn">(<a href="../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Decl">Decl</a> <a href="../../.././Lean/Compiler/LCNF/Basic.html#Lean.Compiler.LCNF.Purity.pure">Purity.pure</a>)</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Compiler.LCNF.Decl.lambdaLifting" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Compiler.LCNF.lambdaLifting"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L196-L205">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.lambdaLifting"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">lambdaLifting</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././Lean/Compiler/LCNF/PassManager.html#Lean.Compiler.LCNF.Pass">Pass</a></div></div><p>Eliminate all local function declarations.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Compiler.LCNF.lambdaLifting" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Compiler.LCNF.eagerLambdaLifting"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Compiler/LCNF/LambdaLifting.lean#L207-L222">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Compiler/LCNF/LambdaLifting.html#Lean.Compiler.LCNF.eagerLambdaLifting"><span class="name">Lean</span>.<span class="name">Compiler</span>.<span class="name">LCNF</span>.<span class="name">eagerLambdaLifting</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././Lean/Compiler/LCNF/PassManager.html#Lean.Compiler.LCNF.Pass">Pass</a></div></div><p>During eager lambda lifting, we inspect declarations that are not inlineable or instances (doing it
everywhere can accidentally introduce mutual recursion which the compiler cannot handle well at the
moment). We then lift local function declarations that take local instances as parameters from
their body to ensure they are specialized.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Compiler.LCNF.eagerLambdaLifting" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>