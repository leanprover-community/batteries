<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Elab.Binders</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="Lean.Elab.Binders";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Binders</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Lean/Elab/Match.html">Lean.Elab.Match</a></li><li><a href="../.././Lean/Linter/Basic.html">Lean.Linter.Basic</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Elab.Binders" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.BinderView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">BinderView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.quoteAutoTactic"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">quoteAutoTactic</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.declareTacticSyntax"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">declareTacticSyntax</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.failedToInferBinderTypeErrorName"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">failedToInferBinderTypeErrorName</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.addLocalVarInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">addLocalVarInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.checkBinderAnnotations"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">checkBinderAnnotations</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabBindersEx"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabBindersEx</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabBinders"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabBinders</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabBinder"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabBinder</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandSimpleBinderWithType"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandSimpleBinderWithType</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandForall"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandForall</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabForall"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabForall</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.precheckArrow"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">precheckArrow</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabArrow"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabArrow</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabDepArrow"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabDepArrow</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandFunBinders"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandFunBinders</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.FunBinders.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">FunBinders</span>.<span class="name">State</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.FunBinders.elabFunBindersAux"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">FunBinders</span>.<span class="name">elabFunBindersAux</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabFunBinders"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabFunBinders</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandWhereDecls"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandWhereDecls</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandWhereDeclsOpt"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandWhereDeclsOpt</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandMatchAltsIntoMatch"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandMatchAltsIntoMatch</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandMatchAltsIntoMatchTactic"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandMatchAltsIntoMatchTactic</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandMatchAltsWhereDecls"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandMatchAltsWhereDecls</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandFun"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandFun</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandExplicitFun"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandExplicitFun</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.precheckFun"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">precheckFun</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabFun"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabFun</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.LetConfig"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">LetConfig</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.LetConfig.setFrom"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">LetConfig</span>.<span class="name">setFrom</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.mkLetConfig"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">mkLetConfig</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabLetDeclAux"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetDeclAux</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.LetIdDeclView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">LetIdDeclView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.mkLetIdDeclView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">mkLetIdDeclView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandLetEqnsDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandLetEqnsDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabLetDeclCore"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetDeclCore</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabLetDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabHaveDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabHaveDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabLetFunDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetFunDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabLetDelayedDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetDelayedDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabLetTmpDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetTmpDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabLetIDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetIDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabHaveIDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabHaveIDecl</span></a></div></nav><main>
<div class="decl" id="Lean.Elab.Term.BinderView"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L44-L62">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.BinderView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">BinderView</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Auxiliary datatype for elaborating binders.</p><ul class="structure_fields" id="Lean.Elab.Term.BinderView.mk"><li id="Lean.Elab.Term.BinderView.ref" class="structure_field"><div class="structure_field_info">ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div><div class="structure_field_doc"><p>Position information provider for the Info Tree.
We currently do not track binder &quot;macro expansion&quot; steps in the info tree.
For example, suppose we expand a <code>_</code> into a fresh identifier. The fresh identifier
has synthetic position since it was not written by the user, and we would not get
hover information for the <code>_</code> because we also don't have this macro expansion step
stored in the info tree. Thus, we store the original <code>Syntax</code> in <code><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.BinderView.ref">ref</a></code>, and use
it when storing the binder information in the info tree.</p><p>Potential better solution: add a binder syntax category, an extensible <code><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBinder">elabBinder</a></code>
(like we have <code>elabTerm</code>), and perform all macro expansion steps at <code><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBinder">elabBinder</a></code> and
record them in the info tree.</p></div></li><li id="Lean.Elab.Term.BinderView.id" class="structure_field"><div class="structure_field_info">id : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.BinderView.type" class="structure_field"><div class="structure_field_info">type : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.BinderView.bi" class="structure_field"><div class="structure_field_info">bi : <a href="../.././Lean/Expr.html#Lean.BinderInfo">BinderInfo</a></div></li></ul><details id="instances-for-list-Lean.Elab.Term.BinderView" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.quoteAutoTactic"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L64-L85">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.quoteAutoTactic"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">quoteAutoTactic</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a> → <span class="fn"><a href="../.././Lean/CoreM.html#Lean.Core.CoreM">CoreM</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></span></div></div></div></div><div class="decl" id="Lean.Elab.Term.declareTacticSyntax"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L87-L103">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.declareTacticSyntax"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">declareTacticSyntax</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">tactic</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">name?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a></span> := <a href="../.././Init/Prelude.html#Option.none">none</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a></span></div></div><p>Adds a declaration whose value is a Syntax expression representing <code>tactic</code>.
If <code>name?</code> is provided, it is used for the declaration name, and otherwise a fresh name is generated.
Returns the declaration name.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.declareTacticSyntax" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.failedToInferBinderTypeErrorName"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L169-L175">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.failedToInferBinderTypeErrorName"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">failedToInferBinderTypeErrorName</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Name">Name</a></div></div><p>The error name for &quot;failed to infer binder type&quot; errors.</p><p>We cannot use <code>logNamedError</code> here because the error is logged later, after attempting to synthesize
metavariables, in <code>logUnassignedUsingErrorInfos</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.failedToInferBinderTypeErrorName">Lean.Elab.Term.failedToInferBinderTypeErrorName</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">`lean.inferBinderTypeFailed</span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.failedToInferBinderTypeErrorName" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.addLocalVarInfo"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L185-L186">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.addLocalVarInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">addLocalVarInfo</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">stx</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">fvar</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.addLocalVarInfo">Lean.Elab.Term.addLocalVarInfo</a> <span class="fn">stx</span> <span class="fn">fvar</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.addTermInfo'">Lean.Elab.Term.addTermInfo'</a> <span class="fn">stx</span> <span class="fn">fvar</span> <a href="../.././Init/Prelude.html#Option.none">none</a> <a href="../.././Init/Prelude.html#Option.none">none</a> <a href="../.././Init/Prelude.html#Lean.Name.anonymous">Lean.Name.anonymous</a> <a href="../.././Init/Prelude.html#Bool.true">true</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.addLocalVarInfo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.checkBinderAnnotations"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L193-L196">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.checkBinderAnnotations"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">checkBinderAnnotations</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Data/Options.html#Lean.Option">Lean.Option</a> <a href="../.././Init/Prelude.html#Bool">Bool</a></span></div></div></div></div><div class="decl" id="Lean.Elab.Term.elabBindersEx"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L237-L247">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBindersEx"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabBindersEx</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">binders</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> (<a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span> → <span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">α</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">α</span></span></div></div><p>Like <code><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBinders">elabBinders</a></code>, but also pass syntax node per binder.
<code>elabBinders(Ex)</code> automatically adds binder info nodes for the produced fvars, but storing the syntax nodes
might be necessary when later adding the same binders back to the local context so that info nodes can
manually be added for the new fvars; see <code>MutualDef</code> for an example.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBindersEx">Lean.Elab.Term.elabBindersEx</a> <span class="fn">binders</span> <span class="fn">k</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.universeConstraintsCheckpoint">Lean.Elab.Term.universeConstraintsCheckpoint</a>
    (<a href="../.././Init/Prelude.html#ite">if</a> <span class="fn"><span class="fn">binders</span>.<a href="../.././Init/Data/Array/Basic.html#Array.isEmpty">isEmpty</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#ite">then</a> <span class="fn"><span class="fn">k</span> <a href="../.././Init/Prelude.html#List.toArray">#[</a><a href="../.././Init/Prelude.html#List.toArray">]</a></span> <a href="../.././Init/Prelude.html#ite">else</a> <span class="fn"><a href="../.././Lean/Elab/Binders.html#_private.Lean.Elab.Binders.0.Lean.Elab.Term.elabBindersAux">Lean.Elab.Term.elabBindersAux✝</a> <span class="fn">binders</span> <span class="fn">k</span></span>)</span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabBindersEx" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabBinders"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L249-L259">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBinders"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabBinders</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">binders</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span> → <span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">α</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">α</span></span></div></div><p>Elaborate the given binders (i.e., <code>Syntax</code> objects for <code>bracketedBinder</code>),
update the local context, set of local instances, reset instance cache (if needed), and then
execute <code>k</code> with the updated context.
The local context will only be included inside <code>k</code>.</p><p>For example, suppose you have binders <code>[(a : α), (b : β a)]</code>, then the elaborator will
create two new free variables <code>a</code> and <code>b</code>, push these to the context and pass to <code>k #[a,b]</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBinders">Lean.Elab.Term.elabBinders</a> <span class="fn">binders</span> <span class="fn">k</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBindersEx">Lean.Elab.Term.elabBindersEx</a> <span class="fn">binders</span> <span class="fn">fun (<span class="fn">fvars</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> (<a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span>) =&gt;
    <span class="fn"><span class="fn">k</span> <span class="fn">(<a href="../.././Init/Data/Array/Basic.html#Array.map">Array.map</a> <span class="fn">(fun (<span class="fn">x</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>) =&gt; <span class="fn"><span class="fn">x</span>.<a href="../.././Init/Prelude.html#Prod.snd">snd</a></span>)</span> <span class="fn">fvars</span>)</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabBinders" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabBinder"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L261-L263">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBinder"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabBinder</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">binder</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Expr.html#Lean.Expr">Expr</a> → <span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">α</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">α</span></span></div></div><p>Same as <code><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBinder">elabBinder</a></code> with a single binder.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBinder">Lean.Elab.Term.elabBinder</a> <span class="fn">binder</span> <span class="fn">x</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBinders">Lean.Elab.Term.elabBinders</a> <a href="../.././Init/Prelude.html#List.toArray">#[</a><span class="fn">binder</span><a href="../.././Init/Prelude.html#List.toArray">]</a> <span class="fn">fun (<span class="fn">fvars</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span>) =&gt; <span class="fn"><span class="fn">x</span> <span class="fn">fvars</span><a href="../.././Init/GetElem.html#GetElem?.getElem!">[</a><span class="fn">0</span><a href="../.././Init/GetElem.html#GetElem?.getElem!">]</a><a href="../.././Init/GetElem.html#GetElem?.getElem!">!</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabBinder" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandSimpleBinderWithType"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L265-L270">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandSimpleBinderWithType"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandSimpleBinderWithType</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">type</span> : <a href="../.././Init/Meta/Defs.html#Lean.Syntax.Term">Term</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">binder</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><p>If <code>binder</code> is a <code>_</code> or an identifier, return a <code>bracketedBinder</code> using <code><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.BinderView.type">type</a></code> otherwise throw an exception.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandSimpleBinderWithType" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandForall"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L272-L276">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandForall"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandForall</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Macro">Macro</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandForall" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabForall"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L278-L284">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabForall"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabForall</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabForall" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.precheckArrow"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L287-L291">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.precheckArrow"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">precheckArrow</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Quotation/Precheck.html#Lean.Elab.Term.Quotation.Precheck">Quotation.Precheck</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.precheckArrow" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabArrow"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L293-L304">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabArrow"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabArrow</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabArrow" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabDepArrow"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L306-L315">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabDepArrow"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabDepArrow</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><p>The dependent arrow. <code>(x : α) → β</code> is equivalent to <code>∀ x : α, β</code>, but we usually
reserve the latter for propositions. Also written as <code>Π x : α, β</code> (the &quot;Pi-type&quot;)
in the literature.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabDepArrow" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandFunBinders"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L343-L400">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandFunBinders"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandFunBinders</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">binders</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">body</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> (<span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></div></div><p>Auxiliary function for expanding <code>fun</code> notation binders. Recall that <code>fun</code> parser is defined as</p><pre><code>def funBinder : Parser := implicitBinder &lt;|&gt; instBinder &lt;|&gt; termParser maxPrec
leading_parser unicodeSymbol &quot;λ&quot; &quot;fun&quot; &gt;&gt; many1 funBinder &gt;&gt; &quot;=&gt;&quot; &gt;&gt; termParser
</code></pre><p>to allow notation such as <code>fun (a, b) =&gt; a + b</code>, where <code>(a, b)</code> should be treated as a pattern.
The result is a pair <code>(explicitBinders, newBody)</code>, where <code>explicitBinders</code> is syntax of the form</p><pre><code>`(` ident `:` term `)`
</code></pre><p>which can be elaborated using <code><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabBinders">elabBinders</a></code>, and <code>newBody</code> is the updated <code>body</code> syntax.
We update the <code>body</code> syntax when expanding the pattern notation.
Example: <code>fun (a, b) =&gt; a + b</code> expands into <code>fun _a_1 =&gt; match _a_1 with | (a, b) =&gt; a + b</code>.
See local function <code>processAsPattern</code> at <code>expandFunBindersAux</code>.</p><p>The resulting <code><a href="../.././Init/Prelude.html#Bool">Bool</a></code> is true if a pattern was found. We use it &quot;mark&quot; a macro expansion.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandFunBinders">Lean.Elab.Term.expandFunBinders</a> <span class="fn">binders</span> <span class="fn">body</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Binders.html#_private.Lean.Elab.Binders.0.Lean.Elab.Term.expandFunBinders.loop">Lean.Elab.Term.expandFunBinders.loop✝</a> <span class="fn">binders</span> <span class="fn">body</span> <span class="fn">0</span> <a href="../.././Init/Prelude.html#List.toArray">#[</a><a href="../.././Init/Prelude.html#List.toArray">]</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandFunBinders" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.FunBinders.State"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L404-L408">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.FunBinders.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">FunBinders</span>.<span class="name">State</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Term.FunBinders.State.mk"><li id="Lean.Elab.Term.FunBinders.State.fvars" class="structure_field"><div class="structure_field_info">fvars : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></li><li id="Lean.Elab.Term.FunBinders.State.lctx" class="structure_field"><div class="structure_field_info">lctx : <a href="../.././Lean/LocalContext.html#Lean.LocalContext">LocalContext</a></div></li><li id="Lean.Elab.Term.FunBinders.State.localInsts" class="structure_field"><div class="structure_field_info">localInsts : <a href="../.././Lean/MetavarContext.html#Lean.LocalInstances">LocalInstances</a></div></li><li id="Lean.Elab.Term.FunBinders.State.expectedType?" class="structure_field"><div class="structure_field_info">expectedType? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></li></ul><details id="instances-for-list-Lean.Elab.Term.FunBinders.State" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.FunBinders.elabFunBindersAux"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L452-L458">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.FunBinders.elabFunBindersAux"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">FunBinders</span>.<span class="name">elabFunBindersAux</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">binders</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">i</span> : <a href="../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.FunBinders.State">State</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.FunBinders.State">State</a></span></div></div></div></div><div class="decl" id="Lean.Elab.Term.elabFunBinders"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L462-L470">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabFunBinders"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabFunBinders</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">binders</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">expectedType?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span> → <span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span> → <span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">α</span></span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabFunBinders" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandWhereDecls"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L472-L476">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandWhereDecls"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandWhereDecls</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">whereDecls </span><span class="fn">body</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandWhereDecls" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandWhereDeclsOpt"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L478-L482">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandWhereDeclsOpt"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandWhereDeclsOpt</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">whereDeclsOpt </span><span class="fn">body</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandWhereDeclsOpt">Lean.Elab.Term.expandWhereDeclsOpt</a> <span class="fn">whereDeclsOpt</span> <span class="fn">body</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Init/Prelude.html#ite">if</a> <span class="fn"><span class="fn">whereDeclsOpt</span>.<a href="../.././Init/Meta/Defs.html#Lean.Syntax.isNone">isNone</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#ite">then</a> <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">body</span></span> <a href="../.././Init/Prelude.html#ite">else</a> <span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandWhereDecls">Lean.Elab.Term.expandWhereDecls</a> <span class="fn">whereDeclsOpt</span><a href="../.././Init/GetElem.html#GetElem.getElem">[</a><span class="fn">0</span><a href="../.././Init/GetElem.html#GetElem.getElem">]</a> <span class="fn">body</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandWhereDeclsOpt" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandMatchAltsIntoMatch"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L505-L558">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandMatchAltsIntoMatch"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandMatchAltsIntoMatch</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref </span><span class="fn">matchAlts</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">useExplicit</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a> := <a href="../.././Init/Prelude.html#Bool.true">true</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><p>Expand <code>matchAlts</code> syntax into a full <code>match</code>-expression.
Example:</p><pre><code>| 0, true =&gt; alt_1
| i, _    =&gt; alt_2
</code></pre><p>expands into (for tactic == false)</p><pre><code>fun x_1 x_2 =&gt;
match @x_1, @x_2 with
| 0, true =&gt; alt_1
| i, _    =&gt; alt_2
</code></pre><p>and (for tactic == true)</p><pre><code>intro x_1; intro x_2;
match @x_1, @x_2 with
| 0, true =&gt; alt_1
| i, _    =&gt; alt_2
</code></pre><p>If <code>useExplicit = true</code>, we add a <code>@</code> before <code>fun</code> to disable implicit lambdas. We disable them when processing <code>let</code> and <code>let rec</code> declarations
to make sure the behavior is consistent with top-level declarations where we can write</p><pre><code>def f : {α : Type} → α → α
  | _, a =&gt; a
</code></pre><p>We use <code>useExplicit = false</code> when we are elaborating the <code>fun | ... =&gt; ... | ...</code> notation. See issue #1132.
If <code>@fun</code> is used with this notation, the we set <code>useExplicit = true</code>.
We also use <code>useExplicit = false</code> when processing <code>instance ... where</code> notation declarations. The motivation is to have compact declarations such as</p><pre><code>instance [Alternative m] : <a href="../.././Init/Prelude.html#MonadLiftT">MonadLiftT</a> <a href="../.././Init/Prelude.html#Option">Option</a> m where
monadLift -- We don't want to provide the implicit arguments of `monadLift` here. <a href="../.././Init/Prelude.html#One">One</a> should use `monadLift := @fun ...` if they want to provide them.
  | some a =&gt; pure a
  | none =&gt; failure
</code></pre><p>Remark: we add <code>@</code> at discriminants to make sure we don't consume implicit arguments, and to make the behavior consistent with <code>fun</code>.
Example:</p><pre><code>inductive T : Type 1 :=
| mkT : (forall {a : Type}, a -&gt; a) -&gt; T

def makeT (f : forall {a : Type}, a -&gt; a) : T :=
  mkT f

def makeT' : (forall {a : Type}, a -&gt; a) -&gt; T
| f =&gt; mkT f
</code></pre><p>The two definitions should be elaborated without errors and be equivalent.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandMatchAltsIntoMatch" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandMatchAltsIntoMatchTactic"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L560-L561">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandMatchAltsIntoMatchTactic"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandMatchAltsIntoMatchTactic</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref </span><span class="fn">matchAlts</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandMatchAltsIntoMatchTactic" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandMatchAltsWhereDecls"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L600-L646">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandMatchAltsWhereDecls"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandMatchAltsWhereDecls</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">matchAltsWhereDecls</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">expectedType</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><p>Similar to <code><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandMatchAltsIntoMatch">expandMatchAltsIntoMatch</a></code>, but supports an optional <code>where</code> clause.</p><p>Expand <code>matchAltsWhereDecls</code> into <code>let rec</code> + <code>match</code>-expression.
Example</p><pre><code>| 0, true =&gt; ... f 0 ...
| i, _    =&gt; ... f i + g i ...
where
  f x := g x + 1

  g : <a href="../.././Init/Prelude.html#Nat">Nat</a> → <a href="../.././Init/Prelude.html#Nat">Nat</a>
    | 0   =&gt; 1
    | x+1 =&gt; f x
</code></pre><p>expands into</p><pre><code>fun x_1 x_2 =&gt;
  let rec
    f x := g x + 1,
    g : <a href="../.././Init/Prelude.html#Nat">Nat</a> → <a href="../.././Init/Prelude.html#Nat">Nat</a>
      | 0   =&gt; 1
      | x+1 =&gt; f x
  match x_1, x_2 with
  | 0, true =&gt; ... f 0 ...
  | i, _    =&gt; ... f i + g i ...
</code></pre><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandMatchAltsWhereDecls" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandFun"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L648-L659">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandFun"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandFun</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Macro">Macro</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandFun" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandExplicitFun"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L661-L664">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandExplicitFun"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandExplicitFun</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Macro">Macro</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandExplicitFun" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.precheckFun"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L667-L676">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.precheckFun"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">precheckFun</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Quotation/Precheck.html#Lean.Elab.Term.Quotation.Precheck">Quotation.Precheck</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.precheckFun" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabFun"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L678-L691">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabFun"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabFun</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabFun" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.LetConfig"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L693-L708">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">LetConfig</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Configuration for <code>let</code> elaboration.</p><ul class="structure_fields" id="Lean.Elab.Term.LetConfig.mk"><li id="Lean.Elab.Term.LetConfig.nondep" class="structure_field"><div class="structure_field_info">nondep : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>Elaborate as a nondependent <code>let</code> (a <code>have</code>).</p></div></li><li id="Lean.Elab.Term.LetConfig.usedOnly" class="structure_field"><div class="structure_field_info">usedOnly : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>Eliminate the <code>let</code> if it is unused by the body.</p></div></li><li id="Lean.Elab.Term.LetConfig.zeta" class="structure_field"><div class="structure_field_info">zeta : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>Zeta reduces (inlines) the <code>let</code>.</p></div></li><li id="Lean.Elab.Term.LetConfig.postponeValue" class="structure_field"><div class="structure_field_info">postponeValue : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>Postpone elaboration of the value until after the body is elaborated.</p></div></li><li id="Lean.Elab.Term.LetConfig.generalize" class="structure_field"><div class="structure_field_info">generalize : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>Generalize the value from the expected type when elaborating the body.</p></div></li><li id="Lean.Elab.Term.LetConfig.eq?" class="structure_field"><div class="structure_field_info">eq? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Meta/Defs.html#Lean.Syntax.Ident">Ident</a></span></div><div class="structure_field_doc"><p>For <code>let x := v; b</code>, adds <code>eq : x = v</code> to the context.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.LetConfig" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.LetConfig.setFrom"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L710-L722">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.setFrom"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">LetConfig</span>.<span class="name">setFrom</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">config</span> : <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig">LetConfig</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">key</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">val</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig">LetConfig</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.LetConfig.setFrom" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.mkLetConfig"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L724-L738">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.mkLetConfig"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">mkLetConfig</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">letConfig</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">initConfig</span> : <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig">LetConfig</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig">LetConfig</a></span></div></div><p>Interprets a <code>Parser.Term.letConfig</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.mkLetConfig" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabLetDeclAux"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L740-L857">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDeclAux"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetDeclAux</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">id</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">binders</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">typeStx </span><span class="fn">valStx </span><span class="fn">body</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">expectedType?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">config</span> : <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig">LetConfig</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></div><p>The default elaboration order is <code><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetIdDeclView.binders">binders</a></code>, <code>typeStx</code>, <code>valStx</code>, and <code>body</code>.
If <code>config.<a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.postponeValue">postponeValue</a> == true</code>, then we use the order <code><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetIdDeclView.binders">binders</a></code>, <code>typeStx</code>, <code>body</code>, and <code>valStx</code>.
If <code>config.<a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.generalize">generalize</a> == true</code>, then the value is abstracted from the expected type when elaborating the body.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabLetDeclAux" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.LetIdDeclView"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L859-L863">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetIdDeclView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">LetIdDeclView</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Term.LetIdDeclView.mk"><li id="Lean.Elab.Term.LetIdDeclView.id" class="structure_field"><div class="structure_field_info">id : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.LetIdDeclView.binders" class="structure_field"><div class="structure_field_info">binders : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></li><li id="Lean.Elab.Term.LetIdDeclView.type" class="structure_field"><div class="structure_field_info">type : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.LetIdDeclView.value" class="structure_field"><div class="structure_field_info">value : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li></ul><details id="instances-for-list-Lean.Elab.Term.LetIdDeclView" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.mkLetIdDeclView"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L865-L883">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.mkLetIdDeclView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">mkLetIdDeclView</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">letIdDecl</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetIdDeclView">LetIdDeclView</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.mkLetIdDeclView" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandLetEqnsDecl"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L885-L889">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.expandLetEqnsDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandLetEqnsDecl</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">letDecl</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">useExplicit</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a> := <a href="../.././Init/Prelude.html#Bool.true">true</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandLetEqnsDecl" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabLetDeclCore"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L891-L937">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDeclCore"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetDeclCore</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">stx</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">expectedType?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">initConfig</span> : <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig">LetConfig</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabLetDeclCore" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabLetDecl"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L939-L940">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetDecl</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDecl">Lean.Elab.Term.elabLetDecl</a> <span class="fn">stx</span> <span class="fn">expectedType?</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDeclCore">Lean.Elab.Term.elabLetDeclCore</a> <span class="fn">stx</span> <span class="fn">expectedType?</span> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">{</a> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">}</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabLetDecl" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabHaveDecl"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L942-L943">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabHaveDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabHaveDecl</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabHaveDecl">Lean.Elab.Term.elabHaveDecl</a> <span class="fn">stx</span> <span class="fn">expectedType?</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDeclCore">Lean.Elab.Term.elabLetDeclCore</a> <span class="fn">stx</span> <span class="fn">expectedType?</span> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">{</a> <span class="fn">nondep</span> := <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">}</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabHaveDecl" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabLetFunDecl"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L945-L949">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetFunDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetFunDecl</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabLetFunDecl" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabLetDelayedDecl"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L951-L952">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDelayedDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetDelayedDecl</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDelayedDecl">Lean.Elab.Term.elabLetDelayedDecl</a> <span class="fn">stx</span> <span class="fn">expectedType?</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDeclCore">Lean.Elab.Term.elabLetDeclCore</a> <span class="fn">stx</span> <span class="fn">expectedType?</span> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">{</a> <span class="fn">postponeValue</span> := <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">}</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabLetDelayedDecl" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabLetTmpDecl"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L954-L955">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetTmpDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetTmpDecl</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetTmpDecl">Lean.Elab.Term.elabLetTmpDecl</a> <span class="fn">stx</span> <span class="fn">expectedType?</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDeclCore">Lean.Elab.Term.elabLetDeclCore</a> <span class="fn">stx</span> <span class="fn">expectedType?</span> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">{</a> <span class="fn">usedOnly</span> := <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">}</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabLetTmpDecl" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabLetIDecl"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L957-L958">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetIDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLetIDecl</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetIDecl">Lean.Elab.Term.elabLetIDecl</a> <span class="fn">stx</span> <span class="fn">expectedType?</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDeclCore">Lean.Elab.Term.elabLetDeclCore</a> <span class="fn">stx</span> <span class="fn">expectedType?</span> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">{</a> <span class="fn">zeta</span> := <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">}</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabLetIDecl" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabHaveIDecl"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/Binders.lean#L960-L961">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabHaveIDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabHaveIDecl</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabHaveIDecl">Lean.Elab.Term.elabHaveIDecl</a> <span class="fn">stx</span> <span class="fn">expectedType?</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.elabLetDeclCore">Lean.Elab.Term.elabLetDeclCore</a> <span class="fn">stx</span> <span class="fn">expectedType?</span> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">{</a> <span class="fn">nondep</span> := <a href="../.././Init/Prelude.html#Bool.true">true</a>, <span class="fn">zeta</span> := <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Lean/Elab/Binders.html#Lean.Elab.Term.LetConfig.mk">}</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabHaveIDecl" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>