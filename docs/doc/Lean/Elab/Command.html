<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Elab.Command</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="Lean.Elab.Command";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Lean/ExtraModUses.html">Lean.ExtraModUses</a></li><li><a href="../.././Lean/Elab/Binders.html">Lean.Elab.Binders</a></li><li><a href="../.././Lean/Elab/SetOption.html">Lean.Elab.SetOption</a></li><li><a href="../.././Lean/Meta/Diagnostics.html">Lean.Meta.Diagnostics</a></li><li><a href="../.././Lean/Parser/Command.html">Lean.Parser.Command</a></li><li><a href="../.././Lean/Elab/Command/Scope.html">Lean.Elab.Command.Scope</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Elab.Command" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">State</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instNonemptyState"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instNonemptyState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">Context</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.CommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">CommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.CommandElab"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">CommandElab</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.Linter"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">Linter</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.tryCatch"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">tryCatch</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadExceptOfExceptionCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadExceptOfExceptionCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.mkState"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.lintersRef"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">lintersRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.addLinter"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">addLinter</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadInfoTreeCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadInfoTreeCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadEnvCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadEnvCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadOptionsCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadOptionsCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getRef"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instAddMessageContextCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instAddMessageContextCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadRefCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadRefCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadTraceCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadTraceCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instAddErrorMessageContextCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instAddErrorMessageContextCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadDeclNameGeneratorCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadDeclNameGeneratorCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getCurrMacroScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getCurrMacroScope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getMainModule"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getMainModule</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.withFreshMacroScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withFreshMacroScope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadQuotationCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadQuotationCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.liftCoreM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftCoreM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.liftIO"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftIO</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadLiftTIOCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadLiftTIOCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getScope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadResolveNameCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadResolveNameCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadLogCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadLogCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.runLinters"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">runLinters</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.withLoggingExceptions"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withLoggingExceptions</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.wrapAsync"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">wrapAsync</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.wrapAsyncAsSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">wrapAsyncAsSnapshot</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.logSnapshotTask"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">logSnapshotTask</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.runLintersAsync"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">runLintersAsync</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.commandElabAttribute"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">commandElabAttribute</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.withoutCommandIncrementality"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withoutCommandIncrementality</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.withMacroExpansion"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withMacroExpansion</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadMacroAdapterCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadMacroAdapterCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadRecDepthCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadRecDepthCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.MacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">MacroExpandedSnapshot</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instTypeNameMacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instTypeNameMacroExpandedSnapshot</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instToSnapshotTreeMacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instToSnapshotTreeMacroExpandedSnapshot</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.elabCommand"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">elabCommand</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.showPartialSyntaxErrors"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">showPartialSyntaxErrors</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.withInitQuotContext"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withInitQuotContext</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.elabCommandTopLevel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">elabCommandTopLevel</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.adaptExpander"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">adaptExpander</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instInhabitedCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instInhabitedCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.mkMetaContext"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkMetaContext</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getBracketedBinderIds"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getBracketedBinderIds</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.liftTermElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftTermElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.instMonadEvalTermElabMCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadEvalTermElabMCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.runTermElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">runTermElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getScopes"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getScopes</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.modifyScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">modifyScope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.withScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withScope</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.getLevelNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getLevelNames</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.addUnivLevel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">addUnivLevel</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.liftCommandElabM"><span class="name">Lean</span>.<span class="name">liftCommandElabM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.withSetOptionIn"><span class="name">Lean</span>.<span class="name">withSetOptionIn</span></a></div></nav><main>
<div class="decl" id="Lean.Elab.Command.State"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L20-L32">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">State</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Command.State.mk"><li id="Lean.Elab.Command.State.env" class="structure_field"><div class="structure_field_info">env : <a href="../.././Lean/Environment.html#Lean.Environment">Environment</a></div></li><li id="Lean.Elab.Command.State.messages" class="structure_field"><div class="structure_field_info">messages : <a href="../.././Lean/Message.html#Lean.MessageLog">MessageLog</a></div></li><li id="Lean.Elab.Command.State.scopes" class="structure_field"><div class="structure_field_info">scopes : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/Command/Scope.html#Lean.Elab.Command.Scope">Scope</a></span></div></li><li id="Lean.Elab.Command.State.usedQuotCtxts" class="structure_field"><div class="structure_field_info">usedQuotCtxts : <a href="../.././Lean/Data/NameMap/Basic.html#Lean.NameSet">NameSet</a></div></li><li id="Lean.Elab.Command.State.nextMacroScope" class="structure_field"><div class="structure_field_info">nextMacroScope : <a href="../.././Init/Prelude.html#Nat">Nat</a></div></li><li id="Lean.Elab.Command.State.maxRecDepth" class="structure_field"><div class="structure_field_info">maxRecDepth : <a href="../.././Init/Prelude.html#Nat">Nat</a></div></li><li id="Lean.Elab.Command.State.ngen" class="structure_field"><div class="structure_field_info">ngen : <a href="../.././Init/MetaTypes.html#Lean.NameGenerator">NameGenerator</a></div></li><li id="Lean.Elab.Command.State.auxDeclNGen" class="structure_field"><div class="structure_field_info">auxDeclNGen : <a href="../.././Lean/CoreM.html#Lean.DeclNameGenerator">DeclNameGenerator</a></div></li><li id="Lean.Elab.Command.State.infoState" class="structure_field"><div class="structure_field_info">infoState : <a href="../.././Lean/Elab/InfoTree/Types.html#Lean.Elab.InfoState">InfoState</a></div></li><li id="Lean.Elab.Command.State.traceState" class="structure_field"><div class="structure_field_info">traceState : <a href="../.././Lean/Util/Trace.html#Lean.TraceState">TraceState</a></div></li><li id="Lean.Elab.Command.State.snapshotTasks" class="structure_field"><div class="structure_field_info">snapshotTasks : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTask">Language.SnapshotTask</a> <a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTree">Language.SnapshotTree</a>)</span></span></div></li></ul><details id="instances-for-list-Lean.Elab.Command.State" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instNonemptyState"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L32-L32">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instNonemptyState"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instNonemptyState</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State">State</a></span></div></div></div></div><div class="decl" id="Lean.Elab.Command.Context"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L34-L60">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">Context</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Command.Context.mk"><li id="Lean.Elab.Command.Context.fileName" class="structure_field"><div class="structure_field_info">fileName : <a href="../.././Init/Prelude.html#String">String</a></div></li><li id="Lean.Elab.Command.Context.fileMap" class="structure_field"><div class="structure_field_info">fileMap : <a href="../.././Lean/Data/Position.html#Lean.FileMap">FileMap</a></div></li><li id="Lean.Elab.Command.Context.currRecDepth" class="structure_field"><div class="structure_field_info">currRecDepth : <a href="../.././Init/Prelude.html#Nat">Nat</a></div></li><li id="Lean.Elab.Command.Context.cmdPos" class="structure_field"><div class="structure_field_info">cmdPos : <a href="../.././Init/Prelude.html#String.Pos.Raw">String.Pos.Raw</a></div></li><li id="Lean.Elab.Command.Context.macroStack" class="structure_field"><div class="structure_field_info">macroStack : <a href="../.././Lean/Elab/Util.html#Lean.Elab.MacroStack">MacroStack</a></div></li><li id="Lean.Elab.Command.Context.quotContext?" class="structure_field"><div class="structure_field_info">quotContext? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a></span></div></li><li id="Lean.Elab.Command.Context.currMacroScope" class="structure_field"><div class="structure_field_info">currMacroScope : <a href="../.././Init/Prelude.html#Lean.MacroScope">MacroScope</a></div></li><li id="Lean.Elab.Command.Context.ref" class="structure_field"><div class="structure_field_info">ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Command.Context.snap?" class="structure_field"><div class="structure_field_info">snap? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <span class="fn">(<a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotBundle">Language.SnapshotBundle</a> <a href="../.././Lean/Language/Basic.html#Lean.Language.DynamicSnapshot">Language.DynamicSnapshot</a>)</span></span></div><div class="structure_field_doc"><p>Snapshot for incremental reuse and reporting of command elaboration. Currently only used for
(mutual) defs and contained tactics, in which case the <code>DynamicSnapshot</code> is a
<code>HeadersParsedSnapshot</code>.</p><p>Definitely resolved in <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.elabCommandTopLevel">Lean.Elab.Command.elabCommandTopLevel</a></code>.</p><p>Invariant: if the bundle's <code>old?</code> is set, the context and state at the beginning of current and
old elaboration are identical.</p></div></li><li id="Lean.Elab.Command.Context.cancelTk?" class="structure_field"><div class="structure_field_info">cancelTk? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/System/IO.html#IO.CancelToken">IO.CancelToken</a></span></div><div class="structure_field_doc"><p>Cancellation token forwarded to <code>Core.<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context.cancelTk?">cancelTk?</a></code>.</p></div></li><li id="Lean.Elab.Command.Context.suppressElabErrors" class="structure_field"><div class="structure_field_info">suppressElabErrors : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>If set (when <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.showPartialSyntaxErrors">showPartialSyntaxErrors</a></code> is not set and parsing failed), suppresses most elaboration
errors; see also <code>logMessage</code> below.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Command.Context" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.CommandElabM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L62-L62">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">CommandElabM</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context">Lean.Elab.Command.Context</a> <span class="fn">(<a href="../.././Init/Control/StateRef.html#StateRefT'">StateRefT'</a> <a href="../.././Init/System/IO.html#IO.RealWorld">IO.RealWorld</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State">Lean.Elab.Command.State</a> <span class="fn">(<a href="../.././Init/System/IO.html#EIO">EIO</a> <a href="../.././Lean/Exception.html#Lean.Exception">Lean.Exception</a>)</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.CommandElabM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.CommandElab"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L63-L63">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">CommandElab</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">Lean.Elab.Command.CommandElab</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">(<a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Lean.Elab.Command.CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span>)</span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.CommandElab" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.Linter"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L64-L66">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Linter"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">Linter</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Command.Linter.mk"><li id="Lean.Elab.Command.Linter.run" class="structure_field"><div class="structure_field_info">run : <span class="fn"><a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></span></div></li><li id="Lean.Elab.Command.Linter.name" class="structure_field"><div class="structure_field_info">name : <a href="../.././Init/Prelude.html#Lean.Name">Name</a></div></li></ul><details id="instances-for-list-Lean.Elab.Command.Linter" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L74-L75">source</a></div><div class="attributes">@[always_inline]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Monad">Monad</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.tryCatch"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L77-L89">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.tryCatch"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">tryCatch</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <span class="fn"><a href="../.././Lean/Exception.html#Lean.Exception">Exception</a> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span></div></div><p>Like <code>Core.tryCatchRuntimeEx</code>; runtime errors are generally used to abort term elaboration, so we do
want to catch and process them at the command level.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.tryCatch">Lean.Elab.Command.tryCatch</a> <span class="fn">x</span> <span class="fn">h</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Prelude.html#MonadExcept.tryCatch">tryCatch</a> <span class="fn">x</span> <span class="fn">fun (<span class="fn">ex</span> : <a href="../.././Lean/Exception.html#Lean.Exception">Lean.Exception</a>) =&gt; <a href="../.././Init/Prelude.html#ite">if</a> <span class="fn"><span class="fn">ex</span>.<a href="../.././Lean/Exception.html#Lean.Exception.isInterrupt">isInterrupt</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#ite">then</a> <span class="fn"><a href="../.././Init/Prelude.html#MonadExcept.throw">throw</a> <span class="fn">ex</span></span> <a href="../.././Init/Prelude.html#ite">else</a> <span class="fn"><span class="fn">h</span> <span class="fn">ex</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.tryCatch" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadExceptOfExceptionCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L91-L93">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadExceptOfExceptionCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadExceptOfExceptionCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#MonadExceptOf">MonadExceptOf</a> <a href="../.././Lean/Exception.html#Lean.Exception">Exception</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadExceptOfExceptionCommandElabM">Lean.Elab.Command.instMonadExceptOfExceptionCommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Init/Prelude.html#MonadExceptOf.mk">{</a> <span class="fn">throw</span> := <span class="fn">fun {<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>} =&gt; <a href="../.././Init/Prelude.html#MonadExcept.throw">throw</a></span>, <span class="fn">tryCatch</span> := <span class="fn">fun {<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>} =&gt; <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.tryCatch">Lean.Elab.Command.tryCatch</a></span> <a href="../.././Init/Prelude.html#MonadExceptOf.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.mkState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L95-L102">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.mkState"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkState</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">env</span> : <a href="../.././Lean/Environment.html#Lean.Environment">Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">messages</span> : <a href="../.././Lean/Message.html#Lean.MessageLog">MessageLog</a> := <a href="../.././Lean/Message.html#Lean.MessageLog.mk">{</a> <a href="../.././Lean/Message.html#Lean.MessageLog.mk">}</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">opts</span> : <a href="../.././Lean/Data/Options.html#Lean.Options">Options</a> := <a href="../.././Lean/Data/KVMap.html#Lean.KVMap.mk">{</a> <a href="../.././Lean/Data/KVMap.html#Lean.KVMap.mk">}</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State">State</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.mkState" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.lintersRef"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L106-L106">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.lintersRef"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">lintersRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO.Ref">IO.Ref</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Linter">Linter</a>)</span></span></div></div></div></div><div class="decl" id="Lean.Elab.Command.addLinter"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L109-L111">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.addLinter"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">addLinter</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">l</span> : <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Linter">Linter</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.addLinter">Lean.addLinter</a> <span class="fn">l</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">ls</span> ← <span class="fn"><a href="../.././Init/System/ST.html#ST.Ref.get">ST.Ref.get</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.lintersRef">Lean.Elab.Command.lintersRef</a></span>
  <span class="fn"><a href="../.././Init/System/ST.html#ST.Ref.set">ST.Ref.set</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.lintersRef">Lean.Elab.Command.lintersRef</a> <span class="fn">(<span class="fn"><span class="fn">ls</span>.<a href="../.././Init/Prelude.html#Array.push">push</a></span> <span class="fn">l</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.addLinter" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadInfoTreeCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L113-L115">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadInfoTreeCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadInfoTreeCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/InfoTree/Types.html#Lean.Elab.MonadInfoTree">MonadInfoTree</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadEnvCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L117-L119">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadEnvCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadEnvCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Environment.html#Lean.MonadEnv">MonadEnv</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadOptionsCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L121-L123">source</a></div><div class="attributes">@[always_inline]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadOptionsCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadOptionsCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Data/Options.html#Lean.MonadOptions">MonadOptions</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadOptionsCommandElabM">Lean.Elab.Command.instMonadOptionsCommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Lean/Data/Options.html#Lean.MonadOptions.mk">{</a>     <span class="fn">getOptions</span> := <span class="fn">do
      let <span class="fn">__do_lift</span> ← <a href="../.././Init/Prelude.html#MonadState.get">get</a>
      <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn"><span class="fn"><span class="fn">__do_lift</span>.<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State.scopes">scopes</a></span>.<a href="../.././Init/Data/List/BasicAux.html#List.head!">head!</a></span>.<a href="../.././Lean/Elab/Command/Scope.html#Lean.Elab.Command.Scope.opts">opts</a></span></span></span> <a href="../.././Lean/Data/Options.html#Lean.MonadOptions.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getRef"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L125-L126">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getRef"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getRef">Lean.Elab.Command.getRef</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <a href="../.././Init/Prelude.html#MonadReader.read">read</a>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">__do_lift</span>.<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context.ref">ref</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getRef" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instAddMessageContextCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L128-L129">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instAddMessageContextCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instAddMessageContextCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Message.html#Lean.AddMessageContext">AddMessageContext</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instAddMessageContextCommandElabM">Lean.Elab.Command.instAddMessageContextCommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Message.html#Lean.AddMessageContext.mk">{</a> <span class="fn">addMessageContext</span> := <a href="../.././Lean/Message.html#Lean.addMessageContextPartial">Lean.addMessageContextPartial</a> <a href="../.././Lean/Message.html#Lean.AddMessageContext.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadRefCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L131-L133">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadRefCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadRefCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MonadRef">MonadRef</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadTraceCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L135-L137">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadTraceCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadTraceCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Util/Trace.html#Lean.MonadTrace">MonadTrace</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instAddErrorMessageContextCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L139-L145">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instAddErrorMessageContextCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instAddErrorMessageContextCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Exception.html#Lean.AddErrorMessageContext">AddErrorMessageContext</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadDeclNameGeneratorCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L147-L149">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadDeclNameGeneratorCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadDeclNameGeneratorCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/CoreM.html#Lean.MonadDeclNameGenerator">MonadDeclNameGenerator</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getCurrMacroScope"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L151-L151">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getCurrMacroScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getCurrMacroScope</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Nat">Nat</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getCurrMacroScope">Lean.Elab.Command.getCurrMacroScope</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <a href="../.././Init/Prelude.html#MonadReader.read">read</a>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">__do_lift</span>.<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context.currMacroScope">currMacroScope</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getCurrMacroScope" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getMainModule"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L152-L152">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getMainModule"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getMainModule</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getMainModule">Lean.Elab.Command.getMainModule</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <a href="../.././Lean/Environment.html#Lean.MonadEnv.getEnv">Lean.getEnv</a>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">__do_lift</span>.<a href="../.././Lean/Environment.html#Lean.Environment.mainModule">mainModule</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getMainModule" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.withFreshMacroScope"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L154-L156">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withFreshMacroScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withFreshMacroScope</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.withFreshMacroScope" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadQuotationCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L158-L161">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadQuotationCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadQuotationCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MonadQuotation">MonadQuotation</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.liftCoreM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L210-L211">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftCoreM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftCoreM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/CoreM.html#Lean.Core.CoreM">CoreM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftCoreM">Lean.Elab.Command.liftCoreM</a> <span class="fn">x</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn"><a href="../.././Lean/Elab/Command.html#_private.Lean.Elab.Command.0.Lean.Elab.Command.runCore">Lean.Elab.Command.runCore✝</a> <span class="fn">(<a href="../.././Init/Control/Except.html#observing">observing</a> <span class="fn">x</span>)</span></span>
  <span class="fn"><a href="../.././Init/Prelude.html#MonadExcept.ofExcept">ofExcept</a> <span class="fn">__do_lift</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.liftCoreM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.liftIO"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L213-L215">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftIO"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftIO</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftIO">Lean.Elab.Command.liftIO</a> <span class="fn">x</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">ctx</span> ← <a href="../.././Init/Prelude.html#MonadReader.read">read</a>
  <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a>
      <span class="fn">(<a href="../.././Init/System/IO.html#IO.toEIO">IO.toEIO</a>
        <span class="fn">(fun (<span class="fn">ex</span> : <a href="../.././Init/System/IOError.html#IO.Error">IO.Error</a>) =&gt; <span class="fn"><a href="../.././Lean/Exception.html#Lean.Exception.error">Lean.Exception.error</a> <span class="fn"><span class="fn">ctx</span>.<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context.ref">ref</a></span> <span class="fn">((<a href="../.././Lean/Message.html#Lean.MessageData.ofFormat">Lean.MessageData.ofFormat</a> <a href="../.././Init/Prelude.html#Function.comp">∘</a> <a href="../.././Init/Data/Format/Basic.html#Std.ToFormat.format">Std.format</a>) <span class="fn"><span class="fn">ex</span>.<a href="../.././Init/System/IOError.html#IO.Error.toString">toString</a></span>)</span></span>)</span> <span class="fn">x</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.liftIO" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadLiftTIOCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L217-L218">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadLiftTIOCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadLiftTIOCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#MonadLiftT">MonadLiftT</a> <a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadLiftTIOCommandElabM">Lean.Elab.Command.instMonadLiftTIOCommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#MonadLiftT.mk">{</a> <span class="fn">monadLift</span> := <span class="fn">fun {<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>} =&gt; <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftIO">Lean.Elab.Command.liftIO</a></span> <a href="../.././Init/Prelude.html#MonadLiftT.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getScope"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L220-L221">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getScope</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Lean/Elab/Command/Scope.html#Lean.Elab.Command.Scope">Scope</a></span></div></div><p>Return the current scope.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getScope">Lean.Elab.Command.getScope</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <a href="../.././Init/Prelude.html#MonadState.get">get</a>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn"><span class="fn">__do_lift</span>.<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State.scopes">scopes</a></span>.<a href="../.././Init/Data/List/BasicAux.html#List.head!">head!</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getScope" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadResolveNameCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L223-L225">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadResolveNameCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadResolveNameCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/ResolveName.html#Lean.MonadResolveName">MonadResolveName</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadLogCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L227-L240">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadLogCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadLogCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Log.html#Lean.MonadLog">MonadLog</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.runLinters"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L242-L262">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.runLinters"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">runLinters</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">stx</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.runLinters" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.withLoggingExceptions"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L264-L270">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withLoggingExceptions"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withLoggingExceptions</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Catches and logs exceptions occurring in <code>x</code>. Unlike <code>try catch</code> in <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code>, this function
catches interrupt exceptions as well and thus is intended for use at the top level of elaboration.
Interrupt and abort exceptions are caught but not logged.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withLoggingExceptions">Lean.Elab.Command.withLoggingExceptions</a> <span class="fn">x</span> <span class="fn">ctx</span> <span class="fn">ref</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Util.html#Lean.Elab.withLogging">Lean.Elab.withLogging</a> <span class="fn">x</span> <span class="fn">ctx</span> <span class="fn">ref</span>)</span>.<a href="../.././Init/System/IO.html#EIO.catchExceptions">catchExceptions</a></span> <span class="fn">fun (<span class="fn">x</span> : <a href="../.././Lean/Exception.html#Lean.Exception">Lean.Exception</a>) =&gt; <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <a href="../.././Init/Prelude.html#Unit.unit">(</a><a href="../.././Init/Prelude.html#Unit.unit">)</a></span></span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.withLoggingExceptions" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.wrapAsync"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L272-L281">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.wrapAsync"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">wrapAsync</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α </span><span class="fn">β</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">act</span> : <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">β</span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">cancelTk?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/System/IO.html#IO.CancelToken">IO.CancelToken</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">(<span class="fn">α</span> → <span class="fn"><a href="../.././Init/System/IO.html#EIO">EIO</a> <a href="../.././Lean/Exception.html#Lean.Exception">Exception</a> <span class="fn">β</span></span>)</span></span></div></div><p>Wraps the given action for use in <code><a href="../.././Init/System/IO.html#EIO.asTask">EIO.asTask</a></code> etc., discarding its final monadic state.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.wrapAsync" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.wrapAsyncAsSnapshot"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L284-L324">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.wrapAsyncAsSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">wrapAsyncAsSnapshot</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">act</span> : <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">cancelTk?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/System/IO.html#IO.CancelToken">IO.CancelToken</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">desc</span> : <a href="../.././Init/Prelude.html#String">String</a> := by exact decl_name%.toString)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">(<span class="fn">α</span> → <span class="fn"><a href="../.././Init/System/IO.html#BaseIO">BaseIO</a> <a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTree">Language.SnapshotTree</a></span>)</span></span></div></div><p>Wraps the given action for use in <code><a href="../.././Init/System/IO.html#BaseIO.asTask">BaseIO.asTask</a></code> etc., discarding its final state except for
<code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.logSnapshotTask">logSnapshotTask</a></code> tasks, which are reported as part of the returned tree. The given cancellation
token, if any, should be stored in a <code>SnapshotTask</code> for the server to trigger it when the result is
no longer needed.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.wrapAsyncAsSnapshot" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.logSnapshotTask"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L326-L328">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.logSnapshotTask"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">logSnapshotTask</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">task</span> : <span class="fn"><a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTask">Language.SnapshotTask</a> <a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTree">Language.SnapshotTree</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Includes a given task (such as from <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.wrapAsyncAsSnapshot">wrapAsyncAsSnapshot</a></code>) in the overall snapshot tree for this
command's elaboration, making its result available to reporting and the language server. The
reporter will not know about this snapshot tree node until the main elaboration thread for this
command has finished so this function is not useful for incremental reporting within a longer
elaboration thread but only for tasks that outlive it such as background kernel checking or proof
elaboration.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.logSnapshotTask" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.runLintersAsync"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L331-L358">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.runLintersAsync"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">runLintersAsync</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">stx</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.runLintersAsync" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.commandElabAttribute"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L360-L372">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.commandElabAttribute"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">commandElabAttribute</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/KeyedDeclsAttribute.html#Lean.KeyedDeclsAttribute">KeyedDeclsAttribute</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">CommandElab</a></span></div></div><p>Registers a command elaborator for the given syntax node kind.</p><p>A command elaborator should have type <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">Lean.Elab.Command.CommandElab</a></code> (which is
<code><a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> → Lean.Elab.Term.<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></code>), i.e. should take syntax of the given syntax
node kind as a parameter and perform an action.</p><p>The <code>elab_rules</code> and <code>elab</code> commands should usually be preferred over using this attribute
directly.</p></div></div><div class="decl" id="Lean.Elab.Command.withoutCommandIncrementality"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L385-L396">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withoutCommandIncrementality"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withoutCommandIncrementality</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">cond</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">act</span> : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span></div></div><p>Disables incremental command reuse <em>and</em> reporting for <code>act</code> if <code><a href="../.././Init/Prelude.html#cond">cond</a></code> is true by setting
<code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.Context.snap?">Context.snap?</a></code> to <code>none</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.withoutCommandIncrementality" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.withMacroExpansion"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L410-L413">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withMacroExpansion"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withMacroExpansion</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">beforeStx </span><span class="fn">afterStx</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span></div></div><p>Elaborate <code>x</code> with <code>stx</code> on the macro stack</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.withMacroExpansion" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadMacroAdapterCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L415-L417">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadMacroAdapterCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadMacroAdapterCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Util.html#Lean.Elab.MonadMacroAdapter">MonadMacroAdapter</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadRecDepthCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L419-L422">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadRecDepthCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadRecDepthCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Exception.html#Lean.MonadRecDepth">MonadRecDepth</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.MacroExpandedSnapshot"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L427-L441">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.MacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">MacroExpandedSnapshot</span></a></span><span class="decl_extends">extends</span> <a href="../.././Lean/Language/Basic.html#Lean.Language.Snapshot">Lean.Language.Snapshot</a><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Snapshot after macro expansion of a command.</p><ul class="structure_fields" id="Lean.Elab.Command.MacroExpandedSnapshot.mk"><li class="structure_field inherited_field"><div class="structure_field_info"><a href="../.././Lean/Language/Basic.html#Lean.Language.Snapshot.desc">desc</a> : <a href="../.././Init/Prelude.html#String">String</a></div></li><li class="structure_field inherited_field"><div class="structure_field_info"><a href="../.././Lean/Language/Basic.html#Lean.Language.Snapshot.diagnostics">diagnostics</a> : <a href="../.././Lean/Language/Basic.html#Lean.Language.Snapshot.Diagnostics">Diagnostics</a></div></li><li class="structure_field inherited_field"><div class="structure_field_info"><a href="../.././Lean/Language/Basic.html#Lean.Language.Snapshot.infoTree?">infoTree?</a> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/InfoTree/Types.html#Lean.Elab.InfoTree">Elab.InfoTree</a></span></div></li><li class="structure_field inherited_field"><div class="structure_field_info"><a href="../.././Lean/Language/Basic.html#Lean.Language.Snapshot.traces">traces</a> : <a href="../.././Lean/Util/Trace.html#Lean.TraceState">TraceState</a></div></li><li class="structure_field inherited_field"><div class="structure_field_info"><a href="../.././Lean/Language/Basic.html#Lean.Language.Snapshot.isFatal">isFatal</a> : <a href="../.././Init/Prelude.html#Bool">Bool</a></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.macroDecl" class="structure_field"><div class="structure_field_info">macroDecl : <a href="../.././Init/Prelude.html#Lean.Name">Name</a></div><div class="structure_field_doc"><p>The declaration name of the macro.</p></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.newStx" class="structure_field"><div class="structure_field_info">newStx : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div><div class="structure_field_doc"><p>The expanded syntax tree.</p></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.newNextMacroScope" class="structure_field"><div class="structure_field_info">newNextMacroScope : <a href="../.././Init/Prelude.html#Nat">Nat</a></div><div class="structure_field_doc"><p><code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State.nextMacroScope">State.nextMacroScope</a></code> after expansion.</p></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.hasTraces" class="structure_field"><div class="structure_field_info">hasTraces : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>Whether any traces were present after expansion.</p></div></li><li id="Lean.Elab.Command.MacroExpandedSnapshot.next" class="structure_field"><div class="structure_field_info">next : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../.././Lean/Language/Basic.html#Lean.Language.SnapshotTask">Language.SnapshotTask</a> <a href="../.././Lean/Language/Basic.html#Lean.Language.DynamicSnapshot">Language.DynamicSnapshot</a>)</span></span></div><div class="structure_field_doc"><p>Follow-up elaboration snapshots, one per command if <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.MacroExpandedSnapshot.newStx">newStx</a></code> is a sequence of commands.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Command.MacroExpandedSnapshot" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instTypeNameMacroExpandedSnapshot"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L441-L441">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instTypeNameMacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instTypeNameMacroExpandedSnapshot</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Dynamic.html#TypeName">TypeName</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.MacroExpandedSnapshot">MacroExpandedSnapshot</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instTypeNameMacroExpandedSnapshot">Lean.Elab.Command.instTypeNameMacroExpandedSnapshot</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.inst._@.Lean.Elab.Command.1415735107._hygCtx._hyg.59">Lean.Elab.Command.inst✝</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instToSnapshotTreeMacroExpandedSnapshot"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L443-L444">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instToSnapshotTreeMacroExpandedSnapshot"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instToSnapshotTreeMacroExpandedSnapshot</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Language/Basic.html#Lean.Language.ToSnapshotTree">Language.ToSnapshotTree</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.MacroExpandedSnapshot">MacroExpandedSnapshot</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.elabCommand"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L446-L533">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.elabCommand"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">elabCommand</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">stx</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div></div></div><div class="decl" id="Lean.Elab.Command.showPartialSyntaxErrors"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L537-L541">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.showPartialSyntaxErrors"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">showPartialSyntaxErrors</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Data/Options.html#Lean.Option">Lean.Option</a> <a href="../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Option for showing elaboration errors from partial syntax errors.</p></div></div><div class="decl" id="Lean.Elab.Command.withInitQuotContext"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L547-L582">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withInitQuotContext"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withInitQuotContext</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">hint?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Prelude.html#UInt64">UInt64</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">act</span> : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>If <code>hint?</code> is <code>some hint</code>, establishes a new context for macro scope naming and runs <code>act</code> in it,
otherwise runs <code>act</code> directly without changes.</p><p>Context names as documented in Note <code>Macro Scope Representation</code> help with avoiding rebuilds and
<code>prefer_native</code> lookup misses from macro scopes in declaration names and other exported information.
This function establishes a new context with a globally unique name by combining the name of the
current module with <code>hint</code> while also checking for previously used <code>hint</code>s in the same module.
Thus <code>hint</code> does not need to be unique but ensuring it is usually unique helps with keeping the
context name stable.</p><p>In the current implementation, we call <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withInitQuotContext">withInitQuotContext</a></code> once in <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.elabCommandTopLevel">elabCommandTopLevel</a></code> using the
source input of the command as the hint. This helps with keeping macro scopes stable on changes to
other parts of the file but not on changes to the command itself. Thus in each <em>declaration</em>
elaborator we call <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withInitQuotContext">withInitQuotContext</a></code> again with the declaration name(s) as a hint so that
changes to any other part of the declaration do not change the context name.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withInitQuotContext">Lean.Elab.Command.withInitQuotContext</a> <span class="fn">hint?</span> <span class="fn">act</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">act</span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.withInitQuotContext" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.elabCommandTopLevel"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L591-L624">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.elabCommandTopLevel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">elabCommandTopLevel</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">stx</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p><code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.elabCommand">elabCommand</a></code> wrapper that should be used for the initial invocation, not for recursive calls after
macro expansion etc.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.elabCommandTopLevel" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.adaptExpander"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L626-L629">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.adaptExpander"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">adaptExpander</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">exp</span> : <span class="fn"><a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">CommandElab</a></div></div><p>Adapt a syntax transformation to a regular, command-producing elaborator.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.adaptExpander">Lean.Elab.Command.adaptExpander</a> <span class="fn">exp</span> <span class="fn">stx</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">stx'</span> ← <span class="fn"><span class="fn">exp</span> <span class="fn">stx</span></span>
  <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withMacroExpansion">Lean.Elab.Command.withMacroExpansion</a> <span class="fn">stx</span> <span class="fn">stx'</span> <span class="fn">(<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.elabCommand">Lean.Elab.Command.elabCommand</a> <span class="fn">stx'</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.adaptExpander" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instInhabitedCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L634-L635">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instInhabitedCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instInhabitedCommandElabM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">(<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instInhabitedCommandElabM">Lean.Elab.Command.instInhabitedCommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Inhabited.mk">{</a> <span class="fn">default</span> := <span class="fn"><a href="../.././Init/Prelude.html#MonadExcept.throw">throw</a> <a href="../.././Init/Prelude.html#Inhabited.default">default</a></span> <a href="../.././Init/Prelude.html#Inhabited.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.mkMetaContext"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L637-L643">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.mkMetaContext"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkMetaContext</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.Context">Meta.Context</a></div></div><p>The environment linter framework needs to be able to run linters with the same context
as <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftTermElabM">liftTermElabM</a></code>, so we expose that context as a public function here.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.mkMetaContext">Lean.Elab.Command.mkMetaContext</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Lean/Meta/Basic.html#Lean.Meta.Context.mk">{</a> <span class="fn">keyedConfig</span> := <span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.Config.mk">{</a> <span class="fn">foApprox</span> := <a href="../.././Init/Prelude.html#Bool.true">true</a>, <span class="fn">ctxApprox</span> := <a href="../.././Init/Prelude.html#Bool.true">true</a>, <span class="fn">quasiPatternApprox</span> := <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Lean/Meta/Basic.html#Lean.Meta.Config.mk">}</a>.<a href="../.././Lean/Meta/Basic.html#Lean.Meta.Config.toConfigWithKey">toConfigWithKey</a></span> <a href="../.././Lean/Meta/Basic.html#Lean.Meta.Context.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Elab.Command.mkMetaContext" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getBracketedBinderIds"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L646-L653">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getBracketedBinderIds"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getBracketedBinderIds</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a> → <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span></span></div></div><p>Return identifier names in the given bracketed binder.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.getBracketedBinderIds" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.liftTermElabM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L665-L703">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftTermElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">liftTermElabM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span></div></div><p>Lift the <code>TermElabM</code> monadic action <code>x</code> into a <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code> monadic action.</p><p>Note that <code>x</code> is executed with an empty message log. Thus, <code>x</code> cannot modify/view messages produced by
previous commands.</p><p>If you need to access the free variables corresponding to the ones declared using the <code>variable</code> command,
consider using <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.runTermElabM">runTermElabM</a></code>.</p><p>Recall that <code>TermElabM</code> actions can automatically lift <code>MetaM</code> and <code>CoreM</code> actions.
Example:</p><pre><code>public import <a href="../.././Lean.html">Lean</a>

open <a href="../.././Lean.html">Lean</a> Elab Command Meta

def printExpr (e : Expr) : MetaM <a href="../.././Init/Prelude.html#Unit">Unit</a> := do
  <a href="../.././Init/System/IO.html#IO.println">IO.println</a> s!&quot;{← ppExpr e} : {← ppExpr (← inferType e)}&quot;

#eval
  <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftTermElabM">liftTermElabM</a> do
    printExpr (mkConst ``Nat)
</code></pre><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.liftTermElabM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.instMonadEvalTermElabMCommandElabM"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L705-L706">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadEvalTermElabMCommandElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">instMonadEvalTermElabMCommandElabM</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#MonadEval">MonadEval</a> <a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.instMonadEvalTermElabMCommandElabM">Lean.Elab.Command.instMonadEvalTermElabMCommandElabM</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Init/Prelude.html#MonadEval.mk">{</a> <span class="fn">monadEval</span> := <span class="fn">fun {<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>} =&gt; <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftTermElabM">Lean.Elab.Command.liftTermElabM</a></span> <a href="../.././Init/Prelude.html#MonadEval.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Command.runTermElabM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L708-L756">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.runTermElabM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">runTermElabM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">elabFn</span> : <span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span> → <span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">α</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span></div></div><p>Execute the monadic action <code>elabFn xs</code> as a <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code> monadic action, where <code>xs</code> are free variables
corresponding to all active scoped variables declared using the <code>variable</code> command.</p><p>This method is similar to <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.liftTermElabM">liftTermElabM</a></code>, but it elaborates all scoped variables declared using the <code>variable</code>
command.</p><p>Example:</p><pre><code>public import <a href="../.././Lean.html">Lean</a>

public section

open <a href="../.././Lean.html">Lean</a> Elab Command Meta

variable {α : Type u} {f : α → α}
variable (n : Nat)

#eval
  <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.runTermElabM">runTermElabM</a> fun xs =&gt; do
    for x in xs do
      <a href="../.././Init/System/IO.html#IO.println">IO.println</a> s!&quot;{← ppExpr x} : {← ppExpr (← inferType x)}&quot;
</code></pre><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.runTermElabM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getScopes"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L761-L767">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getScopes"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getScopes</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/Command/Scope.html#Lean.Elab.Command.Scope">Scope</a>)</span></span></div></div><p>Return the stack of all currently active scopes:
the base scope always comes last; new scopes are prepended in the front.
In particular, the current scope is always the first element.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getScopes">Lean.Elab.Command.getScopes</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <a href="../.././Init/Prelude.html#MonadState.get">get</a>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">__do_lift</span>.<a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.State.scopes">scopes</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getScopes" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.modifyScope"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L769-L774">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.modifyScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">modifyScope</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><a href="../.././Lean/Elab/Command/Scope.html#Lean.Elab.Command.Scope">Scope</a> → <a href="../.././Lean/Elab/Command/Scope.html#Lean.Elab.Command.Scope">Scope</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.modifyScope" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.withScope"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L776-L784">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.withScope"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">withScope</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><a href="../.././Lean/Elab/Command/Scope.html#Lean.Elab.Command.Scope">Scope</a> → <a href="../.././Lean/Elab/Command/Scope.html#Lean.Elab.Command.Scope">Scope</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.withScope" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.getLevelNames"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L786-L787">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getLevelNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">getLevelNames</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getLevelNames">Lean.Elab.Command.getLevelNames</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.getScope">Lean.Elab.Command.getScope</a>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">__do_lift</span>.<a href="../.././Lean/Elab/Command/Scope.html#Lean.Elab.Command.Scope.levelNames">levelNames</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Command.getLevelNames" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.addUnivLevel"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L789-L795">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.Elab.Command.addUnivLevel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">addUnivLevel</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">idStx</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.addUnivLevel" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.liftCommandElabM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L839-L860">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.liftCommandElabM"><span class="name">Lean</span>.<span class="name">liftCommandElabM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">cmd</span> : <span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">Elab.Command.CommandElabM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">throwOnError</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a> := <a href="../.././Init/Prelude.html#Bool.true">true</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/CoreM.html#Lean.Core.CoreM">CoreM</a> <span class="fn">α</span></span></div></div><p>Lifts an action in <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code> into <code>CoreM</code>, updating the environment,
messages, info trees, traces, the name generator, and macro scopes.
The action is run in a context with an empty message log, empty trace state, and empty info trees.</p><p>If <code>throwOnError</code> is true, then if the command produces an error message, it is converted into an exception.
In this case, info trees and messages are not carried over.</p><p>Commands that modify the processing of subsequent commands,
such as <code>open</code> and <code>namespace</code> commands,
only have an effect for the remainder of the <code><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a></code> computation passed here,
and do not affect subsequent commands.</p><p><em>Warning:</em> when using this from <code>MetaM</code> monads, the caches are <em>not</em> reset.
If the command defines new instances for example, you should use <code><a href="../.././Lean/Meta/Basic.html#Lean.Meta.resetSynthInstanceCache">Lean.Meta.resetSynthInstanceCache</a></code>
to reset the instance cache.
While the <code>modifyEnv</code> function for <code>MetaM</code> clears its caches entirely,
<code><a href="../.././Lean/Elab/Command.html#Lean.liftCommandElabM">liftCommandElabM</a></code> has no way to reset these caches.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.liftCommandElabM">Lean.liftCommandElabM</a> <span class="fn">cmd</span> <span class="fn">throwOnError</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn"><a href="../.././Lean/Elab/Command.html#_private.Lean.Elab.Command.0.Lean.liftCommandElabMCore">Lean.liftCommandElabMCore✝</a> <span class="fn">(<a href="../.././Init/Control/Except.html#observing">observing</a> <span class="fn">cmd</span>)</span> <span class="fn">throwOnError</span></span>
  <span class="fn"><a href="../.././Init/Prelude.html#MonadExcept.ofExcept">ofExcept</a> <span class="fn">__do_lift</span></span></span></li></ul></details><details id="instances-for-list-Lean.liftCommandElabM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.withSetOptionIn"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Command.lean#L862-L873">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Command.html#Lean.withSetOptionIn"><span class="name">Lean</span>.<span class="name">withSetOptionIn</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">cmd</span> : <a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">Elab.Command.CommandElab</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElab">Elab.Command.CommandElab</a></div></div><p>Given a command elaborator <code>cmd</code>, returns a new command elaborator that
first evaluates any local <code>set_option ... in ...</code> clauses and then invokes <code>cmd</code> on what remains.</p></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>