<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Elab.App</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="Lean.Elab.App";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">App</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Init/Omega.html">Init.Omega</a></li><li><a href="../.././Lean/IdentifierSuggestion.html">Lean.IdentifierSuggestion</a></li><li><a href="../.././Lean/Elab/Binders.html">Lean.Elab.Binders</a></li><li><a href="../.././Lean/Elab/ErrorUtils.html">Lean.Elab.ErrorUtils</a></li><li><a href="../.././Lean/Elab/RecAppSyntax.html">Lean.Elab.RecAppSyntax</a></li><li><a href="../.././Lean/Meta/Tactic/ElimInfo.html">Lean.Meta.Tactic.ElimInfo</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Elab.App" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabWithoutExpectedTypeAttr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabWithoutExpectedTypeAttr</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.hasElabWithoutExpectedType"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">hasElabWithoutExpectedType</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.instToStringArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instToStringArg</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.instToStringNamedArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instToStringNamedArg</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.throwInvalidNamedArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">throwInvalidNamedArg</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.synthesizeAppInstMVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">synthesizeAppInstMVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.eraseNamedArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">eraseNamedArg</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabAppArgs.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">Context</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabAppArgs.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">State</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabAppArgs.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">M</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabAppArgs.trySynthesizeAppInstMVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">trySynthesizeAppInstMVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabAppArgs.synthesizeAppInstMVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">synthesizeAppInstMVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabAppArgs.eraseNamedArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">eraseNamedArg</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabAppArgs.main"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">main</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElimInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElimInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.instReprElabElimInfo.repr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instReprElabElimInfo</span>.<span class="name">repr</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.instReprElabElimInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instReprElabElimInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.instInhabitedElabElimInfo.default"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instInhabitedElabElimInfo</span>.<span class="name">default</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.instInhabitedElabElimInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instInhabitedElabElimInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.getElabElimExprInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">getElabElimExprInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.getElabElimInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">getElabElimInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabAsElim"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabAsElim</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElim.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">Context</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElim.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">State</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElim.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">M</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElim.mkMotive"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">mkMotive</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElim.revertArgs"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">revertArgs</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElim.finalize"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">finalize</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElim.getNextArg?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">getNextArg?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElim.setMotive"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">setMotive</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElim.saveArgInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">saveArgInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElim.mkImplicitArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">mkImplicitArg</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ElabElim.main"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">main</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabAppArgs"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabAppArgs</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.LValResolution"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">LValResolution</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabExplicitUnivs"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabExplicitUnivs</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabApp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabApp</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabIdent"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabIdent</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabNamedPattern"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabNamedPattern</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabDotIdent"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabDotIdent</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabExplicitUniv"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabExplicitUniv</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabPipeProj"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabPipeProj</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabExplicit"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabExplicit</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabChoice"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabChoice</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabProj"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabProj</span></a></div></nav><main>
<div class="decl" id="Lean.Elab.Term.elabWithoutExpectedTypeAttr"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L21-L27">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabWithoutExpectedTypeAttr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabWithoutExpectedTypeAttr</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Attributes.html#Lean.TagAttribute">TagAttribute</a></div></div><p>Instructs the elaborator to elaborate applications of the given declaration without an expected
type. This may prevent the elaborator from incorrectly inferring implicit arguments.</p></div></div><div class="decl" id="Lean.Elab.Term.hasElabWithoutExpectedType"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L29-L30">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.hasElabWithoutExpectedType"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">hasElabWithoutExpectedType</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">env</span> : <a href="../.././Lean/Environment.html#Lean.Environment">Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">declName</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.hasElabWithoutExpectedType">Lean.Elab.Term.hasElabWithoutExpectedType</a> <span class="fn">env</span> <span class="fn">declName</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabWithoutExpectedTypeAttr">Lean.Elab.Term.elabWithoutExpectedTypeAttr</a>.<a href="../.././Lean/Attributes.html#Lean.TagAttribute.hasTag">hasTag</a></span> <span class="fn">env</span> <span class="fn">declName</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.hasElabWithoutExpectedType" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.instToStringArg"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L32-L35">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.instToStringArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instToStringArg</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Data/ToString/Basic.html#ToString">ToString</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.Arg">Arg</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.instToStringNamedArg"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L37-L38">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.instToStringNamedArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instToStringNamedArg</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Data/ToString/Basic.html#ToString">ToString</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg">NamedArg</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.instToStringNamedArg">Lean.Elab.Term.instToStringNamedArg</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Init/Data/ToString/Basic.html#ToString.mk">{</a> <span class="fn">toString</span> := <span class="fn">fun (<span class="fn">s</span> : <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg">Lean.Elab.Term.NamedArg</a>) =&gt; <span class="fn">&quot;(&quot;</span> <a href="../.././Init/Prelude.html#HAppend.hAppend">++</a> <span class="fn"><a href="../.././Init/Data/ToString/Basic.html#ToString.toString">toString</a> <span class="fn"><span class="fn">s</span>.<a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg.name">name</a></span></span> <a href="../.././Init/Prelude.html#HAppend.hAppend">++</a> <span class="fn">&quot; := &quot;</span> <a href="../.././Init/Prelude.html#HAppend.hAppend">++</a> <span class="fn"><a href="../.././Init/Data/ToString/Basic.html#ToString.toString">toString</a> <span class="fn"><span class="fn">s</span>.<a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg.val">val</a></span></span> <a href="../.././Init/Prelude.html#HAppend.hAppend">++</a> <span class="fn">&quot;)&quot;</span></span> <a href="../.././Init/Data/ToString/Basic.html#ToString.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.throwInvalidNamedArg"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L40-L58">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.throwInvalidNamedArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">throwInvalidNamedArg</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">namedArg</span> : <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg">NamedArg</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">fn?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">validNames</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.throwInvalidNamedArg" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.synthesizeAppInstMVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L81-L85">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.synthesizeAppInstMVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">synthesizeAppInstMVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">instMVars</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.MVarId">MVarId</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">app</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.synthesizeAppInstMVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.eraseNamedArg"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L91-L93">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.eraseNamedArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">eraseNamedArg</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">namedArgs</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg">NamedArg</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">binderName</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg">NamedArg</a></span></div></div><p>Erase entry for <code>binderName</code> from <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.namedArgs">namedArgs</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.eraseNamedArg">Lean.Elab.Term.eraseNamedArg</a> <span class="fn">namedArgs</span> <span class="fn">binderName</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Data/List/Basic.html#List.filter">List.filter</a> <span class="fn">(fun (<span class="fn">x</span> : <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg">Lean.Elab.Term.NamedArg</a>) =&gt; <span class="fn"><span class="fn">x</span>.<a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg.name">name</a></span> <a href="../.././Init/Core.html#bne">!=</a> <span class="fn">binderName</span>)</span> <span class="fn">namedArgs</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.eraseNamedArg" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="mod_doc"><h1 id="Default-application-elaborator" class="markdown-heading">Default application elaborator <a class="hover-link" href="#Default-application-elaborator">#</a></h1></div><div class="decl" id="Lean.Elab.Term.ElabAppArgs.Context"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L106-L146">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">Context</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Term.ElabAppArgs.Context.mk"><li id="Lean.Elab.Term.ElabAppArgs.Context.ellipsis" class="structure_field"><div class="structure_field_info">ellipsis : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p><code>true</code> if <code>..</code> was used</p></div></li><li id="Lean.Elab.Term.ElabAppArgs.Context.explicit" class="structure_field"><div class="structure_field_info">explicit : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p><code>true</code> if <code>@</code> modifier was used</p></div></li><li id="Lean.Elab.Term.ElabAppArgs.Context.resultIsOutParamSupport" class="structure_field"><div class="structure_field_info">resultIsOutParamSupport : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>If the result type of an application is the <code><a href="../.././Init/Prelude.html#outParam">outParam</a></code> of some local instance, then special support may be needed
because type class resolution interacts poorly with coercions in this kind of situation.
This flag enables the special support.</p><p>The idea is quite simple, if the result type is the <code><a href="../.././Init/Prelude.html#outParam">outParam</a></code> of some local instance, we simply
execute <code>synthesizeSyntheticMVarsUsingDefault</code>. We added this feature to make sure examples as follows
are correctly elaborated.</p><pre><code class="language-lean">class <a href="../.././Init/GetElem.html#GetElem">GetElem</a> (Cont : Type u) (Idx : Type v) (Elem : <a href="../.././Init/Prelude.html#outParam">outParam</a> (Type w)) where
  getElem (xs : Cont) (i : Idx) : Elem

export <a href="../.././Init/GetElem.html#GetElem">GetElem</a> (getElem)

instance : <a href="../.././Init/GetElem.html#GetElem">GetElem</a> (Array α) <a href="../.././Init/Prelude.html#Nat">Nat</a> α where
  getElem xs i := xs.get ⟨i, sorry⟩

opaque <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.f">f</a> : <a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Prelude.html#Bool">Bool</a> → <a href="../.././Init/Prelude.html#Bool">Bool</a>
opaque g : <a href="../.././Init/Prelude.html#Bool">Bool</a> → <a href="../.././Init/Prelude.html#Bool">Bool</a>

def bad (xs : <a href="../.././Init/Prelude.html#Array">Array</a> Bool) : <a href="../.././Init/Prelude.html#Bool">Bool</a> :=
  let x := getElem xs 0
  <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.f">f</a> x &amp;&amp; g x
</code></pre><p>Without the special support, Lean fails at <code>g x</code> saying <code>x</code> has type <code><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Prelude.html#Bool">Bool</a></code> but is expected to have type <code><a href="../.././Init/Prelude.html#Bool">Bool</a></code>.
From the user's point of view this is a bug, since <code>let x := getElem xs 0</code> clearly constrains <code>x</code> to be <code><a href="../.././Init/Prelude.html#Bool">Bool</a></code>, but
we only obtain this information after we apply the <code><a href="../.././Init/Prelude.html#OfNat">OfNat</a></code> default instance for <code>0</code>.</p><p>Before converging to this solution, we have tried to create a &quot;coercion placeholder&quot; when <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.Context.resultIsOutParamSupport">resultIsOutParamSupport</a> = true</code>,
but it did not work well in practice. For example, it failed in the example above.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.ElabAppArgs.Context" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabAppArgs.State"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L148-L186">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">State</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Auxiliary structure for elaborating the application <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.f">f</a> <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.args">args</a> <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.namedArgs">namedArgs</a></code>.</p><ul class="structure_fields" id="Lean.Elab.Term.ElabAppArgs.State.mk"><li id="Lean.Elab.Term.ElabAppArgs.State.f" class="structure_field"><div class="structure_field_info">f : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></div></li><li id="Lean.Elab.Term.ElabAppArgs.State.fType" class="structure_field"><div class="structure_field_info">fType : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></div></li><li id="Lean.Elab.Term.ElabAppArgs.State.args" class="structure_field"><div class="structure_field_info">args : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.Arg">Arg</a></span></div><div class="structure_field_doc"><p>Remaining regular arguments.</p></div></li><li id="Lean.Elab.Term.ElabAppArgs.State.namedArgs" class="structure_field"><div class="structure_field_info">namedArgs : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg">NamedArg</a></span></div><div class="structure_field_doc"><p>remaining named arguments to be processed.</p></div></li><li id="Lean.Elab.Term.ElabAppArgs.State.expectedType?" class="structure_field"><div class="structure_field_info">expectedType? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></li><li id="Lean.Elab.Term.ElabAppArgs.State.etaArgs" class="structure_field"><div class="structure_field_info">etaArgs : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> (<a href="../.././Init/Prelude.html#Lean.Name">Name</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></div><div class="structure_field_doc"><p>When named arguments are provided and explicit arguments occurring before them are missing,
the elaborator eta-expands the declaration. For example,</p><pre><code>def <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.f">f</a> (x y : Nat) := x + y
#check <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.f">f</a> (y := 5)
-- fun x =&gt; <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.f">f</a> x 5
</code></pre><p><code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.etaArgs">etaArgs</a></code> stores the fresh free variables for implementing the eta-expansion.
Each pair records the name to use for the binding and the fvar for the argument.</p><p>When <code>..</code> is used, eta-expansion is disabled, and missing arguments are treated as <code>_</code>.</p></div></li><li id="Lean.Elab.Term.ElabAppArgs.State.toSetErrorCtx" class="structure_field"><div class="structure_field_info">toSetErrorCtx : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.MVarId">MVarId</a></span></div><div class="structure_field_doc"><p>Metavariables that we need to set the error context using the application being built.</p></div></li><li id="Lean.Elab.Term.ElabAppArgs.State.instMVars" class="structure_field"><div class="structure_field_info">instMVars : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.MVarId">MVarId</a></span></div><div class="structure_field_doc"><p>Metavariables for the instance implicit arguments that have already been processed.</p></div></li><li id="Lean.Elab.Term.ElabAppArgs.State.propagateExpected" class="structure_field"><div class="structure_field_info">propagateExpected : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>The following field is used to implement the <code>propagateExpectedType</code> heuristic.
It is set to <code>true</code> true when <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.Context.expectedType">expectedType</a></code> still has to be propagated.</p></div></li><li id="Lean.Elab.Term.ElabAppArgs.State.resultTypeOutParam?" class="structure_field"><div class="structure_field_info">resultTypeOutParam? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.MVarId">MVarId</a></span></div><div class="structure_field_doc"><p>If the result type may be the <code><a href="../.././Init/Prelude.html#outParam">outParam</a></code> of some local instance.
See comment at <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.Context.resultIsOutParamSupport">Context.resultIsOutParamSupport</a></code></p></div></li><li id="Lean.Elab.Term.ElabAppArgs.State.foundNamedArgs" class="structure_field"><div class="structure_field_info">foundNamedArgs : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a></span></div><div class="structure_field_doc"><p>Valid named arguments found while traversing the function's type.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.ElabAppArgs.State" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabAppArgs.M"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L188-L188">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">M</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.M">Lean.Elab.Term.ElabAppArgs.M</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.Context">Lean.Elab.Term.ElabAppArgs.Context</a>
    <span class="fn">(<a href="../.././Init/Control/StateRef.html#StateRefT'">StateRefT'</a> <a href="../.././Init/System/IO.html#IO.RealWorld">IO.RealWorld</a> <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State">Lean.Elab.Term.ElabAppArgs.State</a> <a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a>)</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabAppArgs.M" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabAppArgs.trySynthesizeAppInstMVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L194-L208">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.trySynthesizeAppInstMVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">trySynthesizeAppInstMVars</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.M">M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Try to synthesize metavariables are <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.instMVars">instMVars</a></code> using type class resolution.
The ones that cannot be synthesized yet stay in the <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.instMVars">instMVars</a></code> list.
Remark: we use this method</p><ul><li>before trying to apply coercions to function,</li><li>before unifying the expected type.</li></ul><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabAppArgs.trySynthesizeAppInstMVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabAppArgs.synthesizeAppInstMVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L210-L216">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.synthesizeAppInstMVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">synthesizeAppInstMVars</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.M">M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Try to synthesize metavariables are <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.instMVars">instMVars</a></code> using type class resolution.
The ones that cannot be synthesized yet are registered.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabAppArgs.synthesizeAppInstMVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabAppArgs.eraseNamedArg"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L266-L268">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.eraseNamedArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">eraseNamedArg</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">binderName</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.M">M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Remove named argument with name <code>binderName</code> from <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.namedArgs">namedArgs</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabAppArgs.eraseNamedArg" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabAppArgs.main"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L752-L777">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.main"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabAppArgs</span>.<span class="name">main</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.M">M</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></div><p>Elaborate function application arguments.</p></div></div><div class="mod_doc"><h1 id="Eliminator-like-function-application-elaborator" class="markdown-heading">Eliminator-like function application elaborator <a class="hover-link" href="#Eliminator-like-function-application-elaborator">#</a></h1></div><div class="decl" id="Lean.Elab.Term.ElabElimInfo"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L786-L830">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElimInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElimInfo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Information about an eliminator used by the elab-as-elim elaborator.
This is not to be confused with <code><a href="../.././Lean/Meta/Tactic/ElimInfo.html#Lean.Meta.ElimInfo">Lean.Meta.ElimInfo</a></code>, which is for <code>induction</code> and <code>cases</code>.
The elab-as-elim routine is less restrictive in what counts as an eliminator, and it doesn't need
to have a strict notion of what is a &quot;target&quot; — all it cares about are</p><ol><li>that the return type of a function is of the form <code>m ...</code> where <code>m</code> is a parameter
(unlike <code>induction</code> and <code>cases</code> eliminators, the arguments to <code>m</code>, known as &quot;discriminants&quot;,
can be any expressions, not just parameters), and</li><li>which arguments should be eagerly elaborated, to make discriminants be as elaborated as
possible for the expected type generalization procedure,
and which should be postponed (since they are the &quot;minor premises&quot;).</li></ol><p>Note that the routine isn't doing induction/cases <em>on</em> particular expressions.
The purpose of elab-as-elim is to successfully solve the higher-order unification problem
between the return type of the function and the expected type.</p><ul class="structure_fields" id="Lean.Elab.Term.ElabElimInfo.mk"><li id="Lean.Elab.Term.ElabElimInfo.elimExpr" class="structure_field"><div class="structure_field_info">elimExpr : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></div><div class="structure_field_doc"><p>The eliminator.</p></div></li><li id="Lean.Elab.Term.ElabElimInfo.elimType" class="structure_field"><div class="structure_field_info">elimType : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></div><div class="structure_field_doc"><p>The type of the eliminator.</p></div></li><li id="Lean.Elab.Term.ElabElimInfo.motivePos" class="structure_field"><div class="structure_field_info">motivePos : <a href="../.././Init/Prelude.html#Nat">Nat</a></div><div class="structure_field_doc"><p>The position of the motive parameter.</p></div></li><li id="Lean.Elab.Term.ElabElimInfo.majorsPos" class="structure_field"><div class="structure_field_info">majorsPos : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Nat">Nat</a></span></div><div class="structure_field_doc"><p>Positions of &quot;major&quot; parameters (those that should be eagerly elaborated
because they can contribute to the motive inference procedure).
All parameters that are neither the motive nor a major parameter are &quot;minor&quot; parameters.
The major parameters include all of the parameters that transitively appear in the motive's arguments,
as well as &quot;first-order&quot; arguments that include such parameters,
since they too can help with elaborating discriminants.</p><p>For example, in the following theorem the argument <code>h : a = b</code>
should be elaborated eagerly because it contains <code>b</code>, which occurs in <code>motive b</code>.</p><pre><code>theorem Eq.subst' {α} {motive : α → Prop} {a b : α} (h : a = b) : motive a → motive b
</code></pre><p>For another example, the term <code>isEmptyElim (α := α)</code> is an underapplied eliminator, and it needs
argument <code>α</code> to be elaborated eagerly to create a type-correct motive.</p><pre><code>def isEmptyElim [IsEmpty α] {p : α → Sort _} (a : α) : p a := ...
example {α : Type _} [IsEmpty α] : <a href="../.././Init/Prelude.html#id">id</a> (α → False) := isEmptyElim (α := α)
</code></pre></div></li></ul><details id="instances-for-list-Lean.Elab.Term.ElabElimInfo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.instReprElabElimInfo.repr"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L830-L830">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.instReprElabElimInfo.repr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instReprElabElimInfo</span>.<span class="name">repr</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElimInfo">ElabElimInfo</a> → <span class="fn"><a href="../.././Init/Prelude.html#Nat">Nat</a> → <a href="../.././Init/Data/Format/Basic.html#Std.Format">Format</a></span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.instReprElabElimInfo.repr" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.instReprElabElimInfo"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L830-L830">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.instReprElabElimInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instReprElabElimInfo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Data/Repr.html#Repr">Repr</a> <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElimInfo">ElabElimInfo</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.instReprElabElimInfo">Lean.Elab.Term.instReprElabElimInfo</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Data/Repr.html#Repr.mk">{</a> <span class="fn">reprPrec</span> := <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.instReprElabElimInfo.repr">Lean.Elab.Term.instReprElabElimInfo.repr</a> <a href="../.././Init/Data/Repr.html#Repr.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.instInhabitedElabElimInfo.default"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L830-L830">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.instInhabitedElabElimInfo.default"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instInhabitedElabElimInfo</span>.<span class="name">default</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElimInfo">ElabElimInfo</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.instInhabitedElabElimInfo.default">Lean.Elab.Term.instInhabitedElabElimInfo.default</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElimInfo.mk">{</a> <span class="fn">elimExpr</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">elimType</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">motivePos</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">majorsPos</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a> <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElimInfo.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.instInhabitedElabElimInfo.default" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.instInhabitedElabElimInfo"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L830-L830">source</a></div><div class="attributes">@[instance_reducible]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.instInhabitedElabElimInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">instInhabitedElabElimInfo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElimInfo">ElabElimInfo</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.instInhabitedElabElimInfo">Lean.Elab.Term.instInhabitedElabElimInfo</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Inhabited.mk">{</a> <span class="fn">default</span> := <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.instInhabitedElabElimInfo.default">Lean.Elab.Term.instInhabitedElabElimInfo.default</a> <a href="../.././Init/Prelude.html#Inhabited.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.getElabElimExprInfo"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L832-L876">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.getElabElimExprInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">getElabElimExprInfo</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">elimExpr</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElimInfo">ElabElimInfo</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.getElabElimExprInfo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.getElabElimInfo"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L878-L879">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.getElabElimInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">getElabElimInfo</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">elimName</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElimInfo">ElabElimInfo</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.getElabElimInfo">Lean.Elab.Term.getElabElimInfo</a> <span class="fn">elimName</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.mkConstWithFreshMVarLevels">Lean.Meta.mkConstWithFreshMVarLevels</a> <span class="fn">elimName</span></span>
  <span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.getElabElimExprInfo">Lean.Elab.Term.getElabElimExprInfo</a> <span class="fn">__do_lift</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.getElabElimInfo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabAsElim"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L882-L964">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabAsElim"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabAsElim</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Attributes.html#Lean.TagAttribute">TagAttribute</a></div></div><p>Instructs the elaborator that applications of this function should be elaborated like an eliminator.</p><p>An eliminator is a function that returns an application of a &quot;motive.&quot; A motive is a parameter <code>p</code>
whose type is of the form <code>(x₁ : _) → … → (xₙ : _) → Sort _</code>, i.e., a function that takes in some
number of arguments (referred to as &quot;major premises&quot;) and returns a type. The arguments <code>x₁</code>
through <code>xₙ</code> of the motive can be arbitrary expressions. When elaborating an eliminator application,
Lean first solves for <code>p</code> by matching <code>p x₁ … xₙ</code> against the expected type, then replacing <code>xₙ</code>
through <code>x₁</code> (in that order) with variables to obtain the body of <code>p</code>. The elaborator will throw an
error if this process fails (i.e., the resulting motive is not type-correct) or if the expected type
cannot be determined.</p><p>Eliminator elaboration can be compared to the <code>induction</code> tactic: The expected type is used as the
return value of the motive, with occurrences of the major premises replaced with the arguments.
When more arguments are specified than necessary, the remaining arguments are reverted into the
expected type.</p><p>The automatically-generated <code>rec</code> and <code>casesOn</code> functions of inductive types are always elaborated
as eliminators. Any other functions must be tagged with this attribute in order to be elaborated in
this fashion.</p><p>Examples:</p><pre><code class="language-lean">@[elab_as_elim]
def evenOddRec {motive : <a href="../.././Init/Prelude.html#Nat">Nat</a> → Sort u}
    (even : ∀ n, motive (n * 2)) (odd : ∀ n, motive (n * 2 + 1))
    (n : Nat) : motive n := sorry

-- simple usage
example (a : Nat) : (a * a) % 2 = a % 2 :=
  evenOddRec _ _ a
  /-
  1. basic motive is `fun n =&gt; (a + 2) % 2 = a % 2`
  2. major premise `a` substituted: `fun n =&gt; (n + 2) % 2 = n % 2`
  3. now elaborate the other parameters as usual:
    &quot;even&quot; (first hole): expected type `∀ n, ((n * 2) * (n * 2)) % 2 = (n * 2) % 2`,
    &quot;odd&quot; (second hole): expected type `∀ n, ((n * 2 + 1) * (n * 2 + 1)) % 2 = (n * 2 + 1) % 2`
  -/

-- complex substitution
example (a : Nat) (f : <a href="../.././Init/Prelude.html#Nat">Nat</a> → Nat) : (f a + 1) % 2 ≠ <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.f">f</a> a :=
  evenOddRec _ _ (f a)
  /-
  Similar to before, except `f a` is substituted: `motive := fun n =&gt; (n + 1) % 2 ≠ n`.
  Now the first hole has expected type `∀ n, (n * 2 + 1) % 2 ≠ n * 2`.
  Now the second hole has expected type `∀ n, (n * 2 + 1 + 1) % 2 ≠ n * 2 + 1`.

  Note that while this might appear to work even if the `elab_as_elim` attribute is omitted from
  `evenOddRec`, the inferred motive if one does so (`fun n =&gt; (f a + 1) % 2 ≠ n`) is, in fact,
  insufficiently general: the first hole, for example, ends up with expected type
  `∀ (n : Nat), (f a + 1) % 2 ≠ n * 2`, leaving the first `f a` unsubstituted.
  -/

-- more parameters
example (a : Nat) (h : a % 2 = 1) : (a + 1) % 2 = 0 :=
  evenOddRec _ _ a h
  /-
  Before substitution, `a % 2 = 1` is reverted: `motive := fun n =&gt; a % 2 = 0 → (a + 1) % 2 = 0`.
  Substitution: `motive := fun n =&gt; n % 2 = 1 → (n + 1) % 2 = 0`
  Now the first hole has expected type `∀ n, n * 2 % 2 = 1 → (n * 2) % 2 = 0`.
  Now the second hole has expected type `∀ n, (n * 2 + 1) % 2 = 1 → (n * 2 + 1) % 2 = 0`.
  -/
</code></pre><p>See also <code>@[induction_eliminator]</code> and <code>@[cases_eliminator]</code> for registering default eliminators.</p></div></div><div class="decl" id="Lean.Elab.Term.ElabElim.Context"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L968-L971">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">Context</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Context of the <code>elab_as_elim</code> elaboration procedure.</p><ul class="structure_fields" id="Lean.Elab.Term.ElabElim.Context.mk"><li id="Lean.Elab.Term.ElabElim.Context.elimInfo" class="structure_field"><div class="structure_field_info">elimInfo : <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElimInfo">ElabElimInfo</a></div></li><li id="Lean.Elab.Term.ElabElim.Context.expectedType" class="structure_field"><div class="structure_field_info">expectedType : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></div></li></ul><details id="instances-for-list-Lean.Elab.Term.ElabElim.Context" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabElim.State"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L973-L988">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">State</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>State of the <code>elab_as_elim</code> elaboration procedure.</p><ul class="structure_fields" id="Lean.Elab.Term.ElabElim.State.mk"><li id="Lean.Elab.Term.ElabElim.State.f" class="structure_field"><div class="structure_field_info">f : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></div><div class="structure_field_doc"><p>The resultant expression being built.</p></div></li><li id="Lean.Elab.Term.ElabElim.State.fType" class="structure_field"><div class="structure_field_info">fType : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></div><div class="structure_field_doc"><p>`f : fType</p></div></li><li id="Lean.Elab.Term.ElabElim.State.namedArgs" class="structure_field"><div class="structure_field_info">namedArgs : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg">NamedArg</a></span></div><div class="structure_field_doc"><p>User-provided named arguments that still have to be processed.</p></div></li><li id="Lean.Elab.Term.ElabElim.State.args" class="structure_field"><div class="structure_field_info">args : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.Arg">Arg</a></span></div><div class="structure_field_doc"><p>User-provided arguments that still have to be processed.</p></div></li><li id="Lean.Elab.Term.ElabElim.State.instMVars" class="structure_field"><div class="structure_field_info">instMVars : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.MVarId">MVarId</a></span></div><div class="structure_field_doc"><p>Instance implicit arguments collected so far.</p></div></li><li id="Lean.Elab.Term.ElabElim.State.idx" class="structure_field"><div class="structure_field_info">idx : <a href="../.././Init/Prelude.html#Nat">Nat</a></div><div class="structure_field_doc"><p>Position of the next argument to be processed. We use it to decide whether the argument is the motive or a discriminant.</p></div></li><li id="Lean.Elab.Term.ElabElim.State.motive?" class="structure_field"><div class="structure_field_info">motive? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div><div class="structure_field_doc"><p>Store the metavariable used to represent the motive that will be computed at <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.finalize">finalize</a></code>.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.ElabElim.State" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabElim.M"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L990-L990">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">M</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.M">Lean.Elab.Term.ElabElim.M</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.Context">Lean.Elab.Term.ElabElim.Context</a> <span class="fn">(<a href="../.././Init/Control/StateRef.html#StateRefT'">StateRefT'</a> <a href="../.././Init/System/IO.html#IO.RealWorld">IO.RealWorld</a> <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.State">Lean.Elab.Term.ElabElim.State</a> <a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a>)</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabElim.M" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabElim.mkMotive"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L992-L999">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.mkMotive"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">mkMotive</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">discrs</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">expectedType</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></div><p>Infer the <code>motive</code> using the expected type by <code>kabstract</code>ing the discriminants.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabElim.mkMotive" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabElim.revertArgs"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L1001-L1016">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.revertArgs"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">revertArgs</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">args</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.Arg">Arg</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f </span><span class="fn">expectedType</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> (<a href="../.././Lean/Expr.html#Lean.Expr">Expr</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></div></div><p>If the eliminator is over-applied, we &quot;revert&quot; the extra arguments.
Returns the function with the reverted arguments applied and the new generalized expected type.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabElim.revertArgs" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabElim.finalize"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L1018-L1066">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.finalize"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">finalize</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.M">M</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></div><p>Construct the resulting application after all discriminants have been elaborated, and we have
consumed as many given arguments as possible.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabElim.finalize" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabElim.getNextArg?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L1068-L1086">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.getNextArg?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">getNextArg?</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">binderName</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">binderInfo</span> : <a href="../.././Lean/Expr.html#Lean.BinderInfo">BinderInfo</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.M">M</a> <span class="fn">(<a href="../.././Lean/Data/LOption.html#Lean.LOption">LOption</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.Arg">Arg</a>)</span></span></div></div><p>Return the next argument to be processed.
The result is <code>.none</code> if it is an implicit argument which was not provided using a named argument.
The result is <code>.undef</code> if <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.args">args</a></code> is empty and <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.namedArgs">namedArgs</a></code> does contain an entry for <code>binderName</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabElim.getNextArg?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabElim.setMotive"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L1088-L1090">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.setMotive"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">setMotive</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">motive</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.M">M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Set the <code>motive</code> field in the state.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabElim.setMotive" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabElim.saveArgInfo"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L1100-L1103">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.saveArgInfo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">saveArgInfo</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">arg</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">binderName</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.M">M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Save information for producing error messages.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.saveArgInfo">Lean.Elab.Term.ElabElim.saveArgInfo</a> <span class="fn">arg</span> <span class="fn">binderName</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Init/Prelude.html#ite">if</a> <span class="fn"><span class="fn">arg</span>.<a href="../.././Lean/Expr.html#Lean.Expr.isMVar">isMVar</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#ite">then</a> <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.registerMVarArgName">Lean.Elab.Term.registerMVarArgName</a> <span class="fn"><span class="fn">arg</span>.<a href="../.././Lean/Expr.html#Lean.Expr.mvarId!">mvarId!</a></span> <span class="fn">binderName</span>)</span></span> <a href="../.././Init/Prelude.html#ite">else</a> <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <a href="../.././Init/Prelude.html#PUnit.unit">PUnit.unit</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabElim.saveArgInfo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabElim.mkImplicitArg"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L1105-L1110">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.mkImplicitArg"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">mkImplicitArg</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">argExpectedType</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">bi</span> : <a href="../.././Lean/Expr.html#Lean.BinderInfo">BinderInfo</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.M">M</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></div><p>Create an implicit argument using the given <code>BinderInfo</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.ElabElim.mkImplicitArg" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ElabElim.main"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L1112-L1143">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.main"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ElabElim</span>.<span class="name">main</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.M">M</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></div><p>Main loop of the <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabAsElim">elabAsElim</a></code> procedure.</p></div></div><div class="mod_doc"><h1 id="Function-application-elaboration" class="markdown-heading">Function application elaboration <a class="hover-link" href="#Function-application-elaboration">#</a></h1></div><div class="decl" id="Lean.Elab.Term.elabAppArgs"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L1163-L1242">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabAppArgs"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabAppArgs</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">namedArgs</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.NamedArg">NamedArg</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">args</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Arg.html#Lean.Elab.Term.Arg">Arg</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">expectedType?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">explicit </span><span class="fn">ellipsis</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">resultIsOutParamSupport</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a> := <a href="../.././Init/Prelude.html#Bool.true">true</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></div><p>Elaborate a <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.f">f</a></code>-application using <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.namedArgs">namedArgs</a></code> and <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.args">args</a></code> as the arguments.</p><ul><li><code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.expectedType?">expectedType?</a></code> the expected type if available. It is used to propagate typing information only. This method does <strong>not</strong> ensure the result has this type.</li><li><code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.Context.explicit">explicit</a> = true</code> when notation <code>@</code> is used, and implicit arguments are assumed to be provided at <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.namedArgs">namedArgs</a></code> and <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.args">args</a></code>.</li><li><code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.Context.ellipsis">ellipsis</a> = true</code> when notation <code>..</code> is used. That is, we add <code>_</code> for missing arguments.</li><li><code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.Context.resultIsOutParamSupport">resultIsOutParamSupport</a></code> is used to control whether special support is used when processing applications of functions that return
output parameter of some local instance. Example:<pre><code><a href="../.././Init/GetElem.html#GetElem.getElem">GetElem.getElem</a> : {Cont : Type u_1} → {Idx : Type u_2} → {elem : Type u_3} → {dom : cont → <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.State.idx">idx</a> → Prop} → [self : <a href="../.././Init/GetElem.html#GetElem">GetElem</a> cont <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.State.idx">idx</a> elem dom] → (xs : cont) → (i : idx) → dom xs i → elem
</code></pre>The result type <code>elem</code> is the output parameter of the local instance <code>self</code>.
When this parameter is set to <code>true</code>, we execute <code>synthesizeSyntheticMVarsUsingDefault</code>. For additional details, see comment at
<code>ElabAppArgs.resultIsOutParam</code>.</li></ul><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabAppArgs" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.LValResolution"><div class="inductive"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L1245-L1258">source</a></div><div class="decl_header"><span class="decl_kind">inductive</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.LValResolution"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">LValResolution</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Auxiliary inductive datatype that represents the resolution of an <code>LVal</code>.</p><ul class="constructors"><li class="constructor" id="Lean.Elab.Term.LValResolution.projFn">projFn<span class="decl_args">
<span class="fn">(<span class="fn">baseStructName </span><span class="fn">structName </span><span class="fn">fieldName</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
 : <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.LValResolution">LValResolution</a><div class="inductive_ctor_doc"><p>When applied to <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.f">f</a></code>, effectively expands to <code>BaseStruct.fieldName (self := Struct.toBase f)</code>.
This is a special named argument where it suppresses any explicit arguments depending on it so that type parameters don't need to be supplied.</p></div></li><li class="constructor" id="Lean.Elab.Term.LValResolution.projIdx">projIdx<span class="decl_args">
<span class="fn">(<span class="fn">structName</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">idx</span> : <a href="../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
 : <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.LValResolution">LValResolution</a><div class="inductive_ctor_doc"><p>Similar to <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.LValResolution.projFn">projFn</a></code>, but for extracting field indexed by <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabElim.State.idx">idx</a></code>. Works for structure-like inductive types in general.</p></div></li><li class="constructor" id="Lean.Elab.Term.LValResolution.const">const<span class="decl_args">
<span class="fn">(<span class="fn">baseStructName </span><span class="fn">structName </span><span class="fn">constName</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
 : <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.LValResolution">LValResolution</a><div class="inductive_ctor_doc"><p>When applied to <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.ElabAppArgs.State.f">f</a></code>, effectively expands to <code>constName ... (Struct.toBase f)</code>, with the argument placed in the correct
positional argument if possible, or otherwise as a named argument. The <code>Struct.toBase</code> is not present if <code>baseStructName == structName</code>,
in which case these do not need to be structures. Supports generalized field notation.</p></div></li><li class="constructor" id="Lean.Elab.Term.LValResolution.localRec">localRec<span class="decl_args">
<span class="fn">(<span class="fn">baseName</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">fvar</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
 : <a href="../.././Lean/Elab/App.html#Lean.Elab.Term.LValResolution">LValResolution</a><div class="inductive_ctor_doc"><p>Like <code><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.LValResolution.const">const</a></code>, but with <code>fvar</code> instead of <code>constName</code>.
The <code>baseName</code> is the base name of the type to search for in the parameter list.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.LValResolution" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabExplicitUnivs"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L1694-L1695">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabExplicitUnivs"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabExplicitUnivs</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">lvls</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Level.html#Lean.Level">Level</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabExplicitUnivs" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="mod_doc"><h1 id="Interaction-between-errToSorry-and-observing" class="markdown-heading">Interaction between <code>errToSorry</code> and <code><a href="../.././Init/Control/Except.html#observing">observing</a></code>. <a class="hover-link" href="#Interaction-between-errToSorry-and-observing">#</a></h1><ul><li><p>The method <code>elabTerm</code> catches exceptions, logs them, and returns a synthetic sorry (IF <code>ctx.errToSorry</code> == true).</p></li><li><p>When we elaborate choice nodes (and overloaded identifiers), we track multiple results using the <code><a href="../.././Init/Control/Except.html#observing">observing</a> x</code> combinator.
The <code><a href="../.././Init/Control/Except.html#observing">observing</a> x</code> executes <code>x</code> and returns a <code>TermElabResult</code>.</p></li></ul><p><code><a href="../.././Init/Control/Except.html#observing">observing</a> x</code> does not check for synthetic sorry's, just an exception. Thus, it may think <code>x</code> worked when it didn't
if a synthetic sorry was introduced. We decided that checking for synthetic sorrys at <code><a href="../.././Init/Control/Except.html#observing">observing</a></code> is not a good solution
because it would not be clear to decide what the &quot;main&quot; error message for the alternative is. When the result contains
a synthetic <code>sorry</code>, it is not clear which error message corresponds to the <code>sorry</code>. Moreover, while executing <code>x</code>, many
error messages may have been logged. Recall that we need an error per alternative at <code>mergeFailures</code>.</p><p>Thus, we decided to set <code>errToSorry</code> to <code>false</code> whenever processing choice nodes and overloaded symbols.</p><p>Important: we rely on the property that after <code>errToSorry</code> is set to
false, no elaboration function executed by <code>x</code> will reset it to
<code>true</code>.</p></div><div class="decl" id="Lean.Elab.Term.elabApp"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L2011-L2014">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabApp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabApp</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabApp" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabIdent"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L2019-L2019">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabIdent"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabIdent</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabIdent">Lean.Elab.Term.elabIdent</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/App.html#_private.Lean.Elab.App.0.Lean.Elab.Term.elabAtom">Lean.Elab.Term.elabAtom✝</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabIdent" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabNamedPattern"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L2020-L2020">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabNamedPattern"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabNamedPattern</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabNamedPattern">Lean.Elab.Term.elabNamedPattern</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/App.html#_private.Lean.Elab.App.0.Lean.Elab.Term.elabAtom">Lean.Elab.Term.elabAtom✝</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabNamedPattern" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabDotIdent"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L2021-L2021">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabDotIdent"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabDotIdent</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabDotIdent">Lean.Elab.Term.elabDotIdent</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/App.html#_private.Lean.Elab.App.0.Lean.Elab.Term.elabAtom">Lean.Elab.Term.elabAtom✝</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabDotIdent" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabExplicitUniv"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L2022-L2022">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabExplicitUniv"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabExplicitUniv</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabExplicitUniv">Lean.Elab.Term.elabExplicitUniv</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/App.html#_private.Lean.Elab.App.0.Lean.Elab.Term.elabAtom">Lean.Elab.Term.elabAtom✝</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabExplicitUniv" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabPipeProj"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L2023-L2031">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabPipeProj"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabPipeProj</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabPipeProj" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabExplicit"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L2033-L2041">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabExplicit"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabExplicit</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabExplicit" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabChoice"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L2043-L2043">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabChoice"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabChoice</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabChoice">Lean.Elab.Term.elabChoice</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/App.html#_private.Lean.Elab.App.0.Lean.Elab.Term.elabAtom">Lean.Elab.Term.elabAtom✝</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabChoice" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.elabProj"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/985f350dcd18fc7814dfa677cac09933f44f3215/src/Lean/Elab/App.lean#L2044-L2044">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabProj"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabProj</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/App.html#Lean.Elab.Term.elabProj">Lean.Elab.Term.elabProj</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/App.html#_private.Lean.Elab.App.0.Lean.Elab.Term.elabAtom">Lean.Elab.Term.elabAtom✝</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabProj" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>