<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Elab.Do</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="Lean.Elab.Do";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Do</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Lean/Elab/BindersUtil.html">Lean.Elab.BindersUtil</a></li><li><a href="../.././Lean/Elab/PatternVar.html">Lean.Elab.PatternVar</a></li><li><a href="../.././Lean/Parser/Do.html">Lean.Parser.Do</a></li><li><a href="../.././Lean/Elab/Quotation/Util.html">Lean.Elab.Quotation.Util</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Elab.Do" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.elabLiftMethod"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLiftMethod</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.ExtractMonadResult"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ExtractMonadResult</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.Var"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">Var</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.Alt"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">Alt</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.instInhabitedAlt"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedAlt</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.instInhabitedAlt.default"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedAlt</span>.<span class="name">default</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.AltExpr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">AltExpr</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.instInhabitedAltExpr.default"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedAltExpr</span>.<span class="name">default</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.instInhabitedAltExpr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedAltExpr</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.AltExpr.vars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">AltExpr</span>.<span class="name">vars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.Code"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">Code</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.instInhabitedCode.default"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedCode</span>.<span class="name">default</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.instInhabitedCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.Code.getRef?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">Code</span>.<span class="name">getRef?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.VarSet"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">VarSet</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.CodeBlock"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">CodeBlock</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.CodeBlock.toMessageData"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">CodeBlock</span>.<span class="name">toMessageData</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.hasExitPointPred"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasExitPointPred</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.hasExitPoint"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasExitPoint</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.hasReturn"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasReturn</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.hasTerminalAction"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasTerminalAction</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.hasBreakContinue"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasBreakContinue</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.hasBreakContinueReturn"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasBreakContinueReturn</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkAuxDeclFor"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkAuxDeclFor</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.convertTerminalActionIntoJmp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">convertTerminalActionIntoJmp</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.JPDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">JPDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.attachJP"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">attachJP</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.attachJPs"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">attachJPs</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkFreshJP"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkFreshJP</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.addFreshJP"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">addFreshJP</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.insertVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">insertVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.eraseVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">eraseVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.eraseOptVar"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">eraseOptVar</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkSimpleJmp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkSimpleJmp</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkJmp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkJmp</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.pullExitPointsAux"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">pullExitPointsAux</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.pullExitPoints"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">pullExitPoints</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.extendUpdatedVarsAux"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">extendUpdatedVarsAux</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.extendUpdatedVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">extendUpdatedVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.homogenize"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">homogenize</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkVarDeclCore"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkVarDeclCore</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkReassignCore"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkReassignCore</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkSeq"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkSeq</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkTerminalAction"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkTerminalAction</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkReturn"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkReturn</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkBreak"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkBreak</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkContinue"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkContinue</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkIte"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkIte</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkPureUnitAction"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkPureUnitAction</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkUnless"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkUnless</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkMatch"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkMatch</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkMatchExpr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkMatchExpr</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.concat"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">concat</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getLetIdVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getLetIdVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getLetIdDeclVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getLetIdDeclVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getPatternVarsEx"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getPatternVarsEx</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getPatternsVarsEx"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getPatternsVarsEx</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getLetPatDeclVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getLetPatDeclVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getLetEqnsDeclVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getLetEqnsDeclVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getLetDeclVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getLetDeclVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getDoLetVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoLetVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getDoHaveVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoHaveVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getDoLetRecVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoLetRecVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getDoIdDeclVar"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoIdDeclVar</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getDoPatDeclVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoPatDeclVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getDoLetArrowVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoLetArrowVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.getDoReassignVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoReassignVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.mkDoSeq"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkDoSeq</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.DoIfView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">DoIfView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.isDoExpr?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">isDoExpr?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.annotate"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">annotate</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.Kind"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">Kind</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.instInhabitedKind"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">instInhabitedKind</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.Kind.isRegular"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">Kind</span>.<span class="name">isRegular</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">Context</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">M</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.mkUVarTuple"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkUVarTuple</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.returnToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">returnToTerm</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.continueToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">continueToTerm</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.breakToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">breakToTerm</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.actionTerminalToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">actionTerminalToTerm</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.seqToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">seqToTerm</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.declToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">declToTerm</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.reassignToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">reassignToTerm</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.mkIte"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkIte</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.mkJoinPoint"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkJoinPoint</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.mkJmp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkJmp</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.toTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">toTerm</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.run"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">run</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.mkNestedKind"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkNestedKind</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.mkNestedTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkNestedTerm</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToTerm.matchNestedTermResult"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">matchNestedTermResult</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.isMutableLet"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">isMutableLet</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">Context</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">M</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.withNewMutableVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">withNewMutableVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.checkReassignable"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">checkReassignable</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.checkNotShadowingMutable"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">checkNotShadowingMutable</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.withFor"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">withFor</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">ToForInTermResult</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.mkForInBody"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">mkForInBody</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.ensureInsideFor"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">ensureInsideFor</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.ensureEOS"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">ensureEOS</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.expandLiftMethod"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">expandLiftMethod</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.checkLetArrowRHS"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">checkLetArrowRHS</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.doReturnToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doReturnToCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.Catch"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">Catch</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.getTryCatchUpdatedVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">getTryCatchUpdatedVars</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.tryCatchPred"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">tryCatchPred</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.concatWith"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">concatWith</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.doLetArrowToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doLetArrowToCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.doLetElseToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doLetElseToCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.doReassignArrowToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doReassignArrowToCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.doIfToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doIfToCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.doUnlessToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doUnlessToCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.doForToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doForToCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.doMatchToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doMatchToCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.doMatchExprToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doMatchExprToCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.doTryToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doTryToCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.doSeqToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doSeqToCode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.ToCodeBlock.run"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">run</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.Do.elabDo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">elabDo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandTermFor"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandTermFor</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandTermTry"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandTermTry</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandTermUnless"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandTermUnless</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.expandTermReturn"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandTermReturn</span></a></div></nav><main>
<div class="decl" id="Lean.Elab.Term.elabLiftMethod"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L35-L36">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.elabLiftMethod"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">elabLiftMethod</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.elabLiftMethod">Lean.Elab.Term.elabLiftMethod</a> <span class="fn">stx</span> <span class="fn">x✝</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Exception.html#Lean.throwErrorAt">Lean.throwErrorAt</a> <span class="fn">stx</span> <span class="fn">(<a href="../.././Lean/Message.html#Lean.ToMessageData.toMessageData">Lean.toMessageData</a> <span class="fn">&quot;invalid use of `(&lt;- ...)`, must be nested inside a 'do' expression&quot;</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.elabLiftMethod" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.ExtractMonadResult"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L96-L99">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">ExtractMonadResult</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Term.ExtractMonadResult.mk"><li id="Lean.Elab.Term.ExtractMonadResult.m" class="structure_field"><div class="structure_field_info">m : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></div></li><li id="Lean.Elab.Term.ExtractMonadResult.returnType" class="structure_field"><div class="structure_field_info">returnType : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></div></li><li id="Lean.Elab.Term.ExtractMonadResult.expectedType" class="structure_field"><div class="structure_field_info">expectedType : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a></div></li></ul><details id="instances-for-list-Lean.Elab.Term.ExtractMonadResult" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.Var"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L137-L137">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">Var</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Lean.Elab.Term.Do.Var</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.Var" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.Alt"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L139-L145">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">Alt</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">σ</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>A <code>doMatch</code> alternative. <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt.vars">vars</a></code> is the array of variables declared by <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt.patterns">patterns</a></code>.</p><ul class="structure_fields" id="Lean.Elab.Term.Do.Alt.mk"><li id="Lean.Elab.Term.Do.Alt.ref" class="structure_field"><div class="structure_field_info">ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.Do.Alt.vars" class="structure_field"><div class="structure_field_info">vars : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span></div></li><li id="Lean.Elab.Term.Do.Alt.patterns" class="structure_field"><div class="structure_field_info">patterns : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.Do.Alt.rhs" class="structure_field"><div class="structure_field_info">rhs : <span class="fn">σ</span></div></li></ul><details id="instances-for-list-Lean.Elab.Term.Do.Alt" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.instInhabitedAlt"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L145-L145">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedAlt"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedAlt</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">a✝</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">a✝</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt">Alt</a> <span class="fn">a✝</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedAlt">Lean.Elab.Term.Do.instInhabitedAlt</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Inhabited.mk">{</a> <span class="fn">default</span> := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedAlt.default">Lean.Elab.Term.Do.instInhabitedAlt.default</a> <a href="../.././Init/Prelude.html#Inhabited.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.instInhabitedAlt.default"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L145-L145">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedAlt.default"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedAlt</span>.<span class="name">default</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">a✝</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">a✝</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt">Alt</a> <span class="fn">a✝</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedAlt.default">Lean.Elab.Term.Do.instInhabitedAlt.default</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt.mk">{</a> <span class="fn">ref</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">vars</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">patterns</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">rhs</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.instInhabitedAlt.default" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.AltExpr"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L147-L154">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.AltExpr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">AltExpr</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">σ</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>A <code>doMatchExpr</code> alternative.</p><ul class="structure_fields" id="Lean.Elab.Term.Do.AltExpr.mk"><li id="Lean.Elab.Term.Do.AltExpr.ref" class="structure_field"><div class="structure_field_info">ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.Do.AltExpr.var?" class="structure_field"><div class="structure_field_info">var? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span></div></li><li id="Lean.Elab.Term.Do.AltExpr.funName" class="structure_field"><div class="structure_field_info">funName : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.Do.AltExpr.pvars" class="structure_field"><div class="structure_field_info">pvars : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></li><li id="Lean.Elab.Term.Do.AltExpr.rhs" class="structure_field"><div class="structure_field_info">rhs : <span class="fn">σ</span></div></li></ul><details id="instances-for-list-Lean.Elab.Term.Do.AltExpr" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.instInhabitedAltExpr.default"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L154-L154">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedAltExpr.default"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedAltExpr</span>.<span class="name">default</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">a✝</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">a✝</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.AltExpr">AltExpr</a> <span class="fn">a✝</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedAltExpr.default">Lean.Elab.Term.Do.instInhabitedAltExpr.default</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.AltExpr.mk">{</a> <span class="fn">ref</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">var?</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">funName</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">pvars</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">rhs</span> := <a href="../.././Init/Prelude.html#Inhabited.default">default</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.AltExpr.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.instInhabitedAltExpr.default" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.instInhabitedAltExpr"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L154-L154">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedAltExpr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedAltExpr</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">a✝</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">a✝</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.AltExpr">AltExpr</a> <span class="fn">a✝</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedAltExpr">Lean.Elab.Term.Do.instInhabitedAltExpr</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Inhabited.mk">{</a> <span class="fn">default</span> := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedAltExpr.default">Lean.Elab.Term.Do.instInhabitedAltExpr.default</a> <a href="../.././Init/Prelude.html#Inhabited.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.AltExpr.vars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L156-L164">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.AltExpr.vars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">AltExpr</span>.<span class="name">vars</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">σ</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">alt</span> : <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.AltExpr">AltExpr</a> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.AltExpr.vars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.Code"><div class="inductive"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L166-L229">source</a></div><div class="decl_header"><span class="decl_kind">inductive</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">Code</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Auxiliary datastructure for representing a <code>do</code> code block, and compiling &quot;reassignments&quot; (e.g., <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> + 1</code>).
We convert <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></code> into a <code>Syntax</code> term representing the:</p><ul>
<li><code>do</code>-block, or</li>
<li>the visitor argument for the <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.forIn">forIn</a></code> combinator.</li>
</ul><p>We say the following constructors are terminals:</p><ul>
<li><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">break</a></code>:    for interrupting a <code>for <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> in s</code></li>
<li><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">continue</a></code>: for interrupting the current iteration of a <code>for <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> in s</code></li>
<li><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> e</code>: for returning <code>e</code> as the result for the whole <code>do</code> computation block</li>
<li><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">action</a> a</code>: for executing action <code>a</code> as a terminal</li>
<li><code><a href="../.././Init/Prelude.html#ite">ite</a></code>:      if-then-else</li>
<li><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.match">match</a></code>:    pattern matching</li>
<li><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.jmp">jmp</a></code>       a goto to a join-point</li>
</ul><p>We say the terminals <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">break</a></code>, <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">continue</a></code>, <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">action</a></code>, and <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a></code> are &quot;exit points&quot;</p><p>Note that, <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> e</code> is not equivalent to <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">action</a> (pure e)</code>. Here is an example:</p><pre><code>def f (x : Nat) : <a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Init/Prelude.html#Unit">Unit</a> := do
if <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> == 0 then
   <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> ()
<a href="../.././Init/System/IO.html#IO.println">IO.println</a> &quot;hello&quot;
</code></pre><p>Executing <code>#eval f 0</code> will not print &quot;hello&quot;. Now, consider</p><pre><code>def g (x : Nat) : <a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Init/Prelude.html#Unit">Unit</a> := do
if <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> == 0 then
   pure ()
<a href="../.././Init/System/IO.html#IO.println">IO.println</a> &quot;hello&quot;
</code></pre><p>The <code>if</code> statement is essentially a noop, and &quot;hello&quot; is printed when we execute <code>g 0</code>.</p><ul>
<li><p><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.decl">decl</a></code> represents all declaration-like <code>doElem</code>s (e.g., <code>let</code>, <code>have</code>, <code>let rec</code>).
The field <code>stx</code> is the actual <code>doElem</code>,
<code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt.vars">vars</a></code> is the array of variables declared by it, and <code>cont</code> is the next instruction in the <code>do</code> code block.
<code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt.vars">vars</a></code> is an array since we have declarations such as <code>let (a, b) := s</code>.</p>
</li>
<li><p><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.reassign">reassign</a></code> is an reassignment-like <code>doElem</code> (e.g., <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> + 1</code>).</p>
</li>
<li><p><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.joinpoint">joinpoint</a></code> is a join point declaration: an auxiliary <code>let</code>-declaration used to represent the control-flow.</p>
</li>
<li><p><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.seq">seq</a> a k</code> executes action <code>a</code>, ignores its result, and then executes <code>k</code>.
We also store the do-elements <code>dbg_trace</code> and <code>assert!</code> as actions in a <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.seq">seq</a></code>.</p>
</li>
</ul><p>A code block <code>C</code> is well-formed if</p><ul>
<li>For every <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.jmp">jmp</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt.ref">ref</a> j as</code> in <code>C</code>, there is a <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.joinpoint">joinpoint</a> j ps b k</code> and <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.jmp">jmp</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt.ref">ref</a> j as</code> is in <code>k</code>, and
<code>ps.size == as.size</code></li>
</ul><ul class="constructors"><li class="constructor" id="Lean.Elab.Term.Do.Code.decl">decl<span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElem</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></li><li class="constructor" id="Lean.Elab.Term.Do.Code.reassign">reassign<span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElem</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></li><li class="constructor" id="Lean.Elab.Term.Do.Code.joinpoint">joinpoint<span class="decl_args">
<span class="fn">(<span class="fn">name</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">params</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> (<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">body </span><span class="fn">k</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a><div class="inductive_ctor_doc"><p>The Boolean value in <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl.params">params</a></code> indicates whether we should use <code>(x : typeof! x)</code> when generating term Syntax or not</p></div></li><li class="constructor" id="Lean.Elab.Term.Do.Code.seq">seq<span class="decl_args">
<span class="fn">(<span class="fn">action</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></li><li class="constructor" id="Lean.Elab.Term.Do.Code.action">action<span class="decl_args">
<span class="fn">(<span class="fn">action</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></li><li class="constructor" id="Lean.Elab.Term.Do.Code.break">break<span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></li><li class="constructor" id="Lean.Elab.Term.Do.Code.continue">continue<span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></li><li class="constructor" id="Lean.Elab.Term.Do.Code.return">return<span class="decl_args">
<span class="fn">(<span class="fn">ref </span><span class="fn">val</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></li><li class="constructor" id="Lean.Elab.Term.Do.Code.ite">ite<span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">optIdent </span><span class="fn">cond</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">thenBranch </span><span class="fn">elseBranch</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a><div class="inductive_ctor_doc"><p>Recall that an if-then-else may declare a variable using <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.DoIfView.optIdent">optIdent</a></code> for the branches <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.DoIfView.thenBranch">thenBranch</a></code> and <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.DoIfView.elseBranch">elseBranch</a></code>. We store the variable name at <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.AltExpr.var?">var?</a></code>.</p></div></li><li class="constructor" id="Lean.Elab.Term.Do.Code.match">match<span class="decl_args">
<span class="fn">(<span class="fn">ref </span><span class="fn">gen </span><span class="fn">discrs </span><span class="fn">optMotive</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">alts</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt">Alt</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></li><li class="constructor" id="Lean.Elab.Term.Do.Code.matchExpr">matchExpr<span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">«meta»</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">discr</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">alts</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.AltExpr">AltExpr</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">elseBranch</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></li><li class="constructor" id="Lean.Elab.Term.Do.Code.jmp">jmp<span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">jpName</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">args</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
 : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></li></ul><details id="instances-for-list-Lean.Elab.Term.Do.Code" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.instInhabitedCode.default"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L229-L229">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedCode.default"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedCode</span>.<span class="name">default</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedCode.default">Lean.Elab.Term.Do.instInhabitedCode.default</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Lean.Elab.Term.Do.Code.action</a> <a href="../.././Init/Prelude.html#Inhabited.default">default</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.instInhabitedCode.default" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.instInhabitedCode"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L229-L229">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">instInhabitedCode</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedCode">Lean.Elab.Term.Do.instInhabitedCode</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Inhabited.mk">{</a> <span class="fn">default</span> := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.instInhabitedCode.default">Lean.Elab.Term.Do.instInhabitedCode.default</a> <a href="../.././Init/Prelude.html#Inhabited.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.Code.getRef?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L231-L243">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">Code</span>.<span class="name">getRef?</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a> → <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.decl">Lean.Elab.Term.Do.Code.decl</a> <span class="fn">xs</span> <span class="fn">doElem</span> <span class="fn">k</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">doElem</span></span></li><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.reassign">Lean.Elab.Term.Do.Code.reassign</a> <span class="fn">xs</span> <span class="fn">doElem</span> <span class="fn">k</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">doElem</span></span></li><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.joinpoint">Lean.Elab.Term.Do.Code.joinpoint</a> <span class="fn">name</span> <span class="fn">params</span> <span class="fn">body</span> <span class="fn">k</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Option.none">none</a></li><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.seq">Lean.Elab.Term.Do.Code.seq</a> <span class="fn">a</span> <span class="fn">k</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">a</span></span></li><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Lean.Elab.Term.Do.Code.action</a> <span class="fn">a</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">a</span></span></li><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">Lean.Elab.Term.Do.Code.break</a> <span class="fn">ref</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">ref</span></span></li><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">Lean.Elab.Term.Do.Code.continue</a> <span class="fn">ref</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">ref</span></span></li><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Lean.Elab.Term.Do.Code.return</a> <span class="fn">ref</span> <span class="fn">val</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">ref</span></span></li><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.ite">Lean.Elab.Term.Do.Code.ite</a> <span class="fn">ref</span> <span class="fn">h?</span> <span class="fn">optIdent</span> <span class="fn">cond</span> <span class="fn">thenBranch</span> <span class="fn">elseBranch</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">ref</span></span></li><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.match">Lean.Elab.Term.Do.Code.match</a> <span class="fn">ref</span> <span class="fn">gen</span> <span class="fn">discrs</span> <span class="fn">optMotive</span> <span class="fn">alts</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">ref</span></span></li><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.matchExpr">Lean.Elab.Term.Do.Code.matchExpr</a> <span class="fn">ref</span> <span class="fn">«meta»</span> <span class="fn">discr</span> <span class="fn">alts</span> <span class="fn">elseBranch</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">ref</span></span></li><li class="equation"><span class="fn"><span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.jmp">Lean.Elab.Term.Do.Code.jmp</a> <span class="fn">ref</span> <span class="fn">jpName</span> <span class="fn">args</span>)</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.getRef?">getRef?</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">ref</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.Code.getRef?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.VarSet"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L245-L245">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">VarSet</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">Lean.Elab.Term.Do.VarSet</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Std/Data/TreeMap/Basic.html#Std.TreeMap">Std.TreeMap</a> <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a> <a href="../.././Lean/Data/Name.html#Lean.Name.cmp">Lean.Name.cmp</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.VarSet" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.CodeBlock"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L247-L250">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">CodeBlock</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>A code block, and the collection of variables updated by it.</p><ul class="structure_fields" id="Lean.Elab.Term.Do.CodeBlock.mk"><li id="Lean.Elab.Term.Do.CodeBlock.code" class="structure_field"><div class="structure_field_info">code : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></div></li><li id="Lean.Elab.Term.Do.CodeBlock.uvars" class="structure_field"><div class="structure_field_info">uvars : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a></div></li></ul><details id="instances-for-list-Lean.Elab.Term.Do.CodeBlock" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.CodeBlock.toMessageData"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L258-L282">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.toMessageData"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">CodeBlock</span>.<span class="name">toMessageData</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">codeBlock</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Message.html#Lean.MessageData">MessageData</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.CodeBlock.toMessageData" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.hasExitPointPred"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L284-L296">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasExitPointPred"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasExitPointPred</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a> → <a href="../.././Init/Prelude.html#Bool">Bool</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><p>Return true if the give code contains an exit point that satisfies <code>p</code></p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasExitPointPred">Lean.Elab.Term.Do.hasExitPointPred</a> <span class="fn">c</span> <span class="fn">p</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#_private.Lean.Elab.Do.0.Lean.Elab.Term.Do.hasExitPointPred.loop">Lean.Elab.Term.Do.hasExitPointPred.loop✝</a> <span class="fn">p</span> <span class="fn">c</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.hasExitPointPred" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.hasExitPoint"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L298-L299">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasExitPoint"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasExitPoint</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasExitPoint">Lean.Elab.Term.Do.hasExitPoint</a> <span class="fn">c</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasExitPointPred">Lean.Elab.Term.Do.hasExitPointPred</a> <span class="fn">c</span> <span class="fn">fun (<span class="fn">x</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Lean.Elab.Term.Do.Code</a>) =&gt; <a href="../.././Init/Prelude.html#Bool.true">true</a></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.hasExitPoint" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.hasReturn"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L301-L304">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasReturn"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasReturn</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasReturn">Lean.Elab.Term.Do.hasReturn</a> <span class="fn">c</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasExitPointPred">Lean.Elab.Term.Do.hasExitPointPred</a> <span class="fn">c</span> <span class="fn">fun (<span class="fn">x</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Lean.Elab.Term.Do.Code</a>) =&gt;
    <span class="fn">match <span class="fn">x</span> with
    | <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Lean.Elab.Term.Do.Code.return</a> <span class="fn">ref</span> <span class="fn">val</span></span> =&gt; <a href="../.././Init/Prelude.html#Bool.true">true</a>
    | <span class="fn">x</span> =&gt; <a href="../.././Init/Prelude.html#Bool.false">false</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.hasReturn" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.hasTerminalAction"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L306-L309">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasTerminalAction"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasTerminalAction</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasTerminalAction">Lean.Elab.Term.Do.hasTerminalAction</a> <span class="fn">c</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasExitPointPred">Lean.Elab.Term.Do.hasExitPointPred</a> <span class="fn">c</span> <span class="fn">fun (<span class="fn">x</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Lean.Elab.Term.Do.Code</a>) =&gt;
    <span class="fn">match <span class="fn">x</span> with
    | <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Lean.Elab.Term.Do.Code.action</a> <span class="fn">action</span></span> =&gt; <a href="../.././Init/Prelude.html#Bool.true">true</a>
    | <span class="fn">x</span> =&gt; <a href="../.././Init/Prelude.html#Bool.false">false</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.hasTerminalAction" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.hasBreakContinue"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L311-L315">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasBreakContinue"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasBreakContinue</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.hasBreakContinue" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.hasBreakContinueReturn"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L317-L322">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.hasBreakContinueReturn"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">hasBreakContinueReturn</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.hasBreakContinueReturn" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkAuxDeclFor"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L324-L330">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkAuxDeclFor"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkAuxDeclFor</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">m</span> : <span class="fn"><a href="../.././foundational_types.html">Type</a> → <a href="../.././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Lean.MonadQuotation">MonadQuotation</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">e</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">mkCont</span> : <span class="fn"><a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a> → <span class="fn"><span class="fn">m</span> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkAuxDeclFor" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.convertTerminalActionIntoJmp"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L332-L352">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.convertTerminalActionIntoJmp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">convertTerminalActionIntoJmp</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">code</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">jp</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></span></div></div><p>Convert <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">action</a> _ e</code> instructions in <code>c</code> into <code>let y ← e; <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.jmp">jmp</a> _ jp (xs y)</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.convertTerminalActionIntoJmp">Lean.Elab.Term.Do.convertTerminalActionIntoJmp</a> <span class="fn">code</span> <span class="fn">jp</span> <span class="fn">xs</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Elab/Do.html#_private.Lean.Elab.Do.0.Lean.Elab.Term.Do.convertTerminalActionIntoJmp.loop">Lean.Elab.Term.Do.convertTerminalActionIntoJmp.loop✝</a> <span class="fn">jp</span> <span class="fn">xs</span> <span class="fn">code</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.convertTerminalActionIntoJmp" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.JPDecl"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L354-L357">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">JPDecl</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Term.Do.JPDecl.mk"><li id="Lean.Elab.Term.Do.JPDecl.name" class="structure_field"><div class="structure_field_info">name : <a href="../.././Init/Prelude.html#Lean.Name">Name</a></div></li><li id="Lean.Elab.Term.Do.JPDecl.params" class="structure_field"><div class="structure_field_info">params : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> (<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></div></li><li id="Lean.Elab.Term.Do.JPDecl.body" class="structure_field"><div class="structure_field_info">body : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></div></li></ul><details id="instances-for-list-Lean.Elab.Term.Do.JPDecl" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.attachJP"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L359-L360">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.attachJP"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">attachJP</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">jpDecl</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl">JPDecl</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.attachJP">Lean.Elab.Term.Do.attachJP</a> <span class="fn">jpDecl</span> <span class="fn">k</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.joinpoint">Lean.Elab.Term.Do.Code.joinpoint</a> <span class="fn"><span class="fn">jpDecl</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl.name">name</a></span> <span class="fn"><span class="fn">jpDecl</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl.params">params</a></span> <span class="fn"><span class="fn">jpDecl</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl.body">body</a></span> <span class="fn">k</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.attachJP" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.attachJPs"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L362-L363">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.attachJPs"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">attachJPs</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">jpDecls</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl">JPDecl</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.attachJPs">Lean.Elab.Term.Do.attachJPs</a> <span class="fn">jpDecls</span> <span class="fn">k</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Data/Array/Basic.html#Array.foldr">Array.foldr</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.attachJP">Lean.Elab.Term.Do.attachJP</a> <span class="fn">k</span> <span class="fn">jpDecls</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.attachJPs" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkFreshJP"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L365-L375">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkFreshJP"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkFreshJP</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ps</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> (<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">body</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl">JPDecl</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkFreshJP" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.addFreshJP"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L377-L380">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.addFreshJP"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">addFreshJP</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ps</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> (<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">body</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Control/StateRef.html#StateRefT'">StateRefT'</a> <a href="../.././Init/System/IO.html#IO.RealWorld">IO.RealWorld</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl">JPDecl</a>)</span> <a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.addFreshJP">Lean.Elab.Term.Do.addFreshJP</a> <span class="fn">ps</span> <span class="fn">body</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">jp</span> ← <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkFreshJP">Lean.Elab.Term.Do.mkFreshJP</a> <span class="fn">ps</span> <span class="fn">body</span>)</span></span>
  <span class="fn"><a href="../.././Init/Prelude.html#modify">modify</a> <span class="fn">fun (<span class="fn">jps</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl">Lean.Elab.Term.Do.JPDecl</a></span>) =&gt; <span class="fn"><span class="fn"><span class="fn">jps</span>.<a href="../.././Init/Prelude.html#Array.push">push</a></span> <span class="fn">jp</span></span></span></span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">jp</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl.name">name</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.addFreshJP" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.insertVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L382-L383">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.insertVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">insertVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">rs</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.insertVars">Lean.Elab.Term.Do.insertVars</a> <span class="fn">rs</span> <span class="fn">xs</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Data/Array/Basic.html#Array.foldl">Array.foldl</a> <span class="fn">(fun (<span class="fn">rs</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">Lean.Elab.Term.Do.VarSet</a>) (<span class="fn">x</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>) =&gt; <span class="fn"><a href="../.././Std/Data/TreeMap/Basic.html#Std.TreeMap.insert">Std.TreeMap.insert</a> <span class="fn">rs</span> <span class="fn"><span class="fn">x</span>.<a href="../.././Init/Prelude.html#Lean.Syntax.getId">getId</a></span> <span class="fn">x</span></span>)</span> <span class="fn">rs</span> <span class="fn">xs</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.insertVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.eraseVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L385-L386">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.eraseVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">eraseVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">rs</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.eraseVars">Lean.Elab.Term.Do.eraseVars</a> <span class="fn">rs</span> <span class="fn">xs</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Data/Array/Basic.html#Array.foldl">Array.foldl</a>
    <span class="fn">(fun (<span class="fn">x1</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">Lean.Elab.Term.Do.VarSet</a>) (<span class="fn">x2</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Lean.Elab.Term.Do.Var</a>) =&gt; <span class="fn"><a href="../.././Std/Data/TreeMap/Basic.html#Std.TreeMap.erase">Std.TreeMap.erase</a> <span class="fn">x1</span> <span class="fn">(<a href="../.././Init/Prelude.html#Lean.Syntax.getId">Lean.Syntax.getId</a> <span class="fn">x2</span>)</span></span>)</span> <span class="fn">rs</span>
    <span class="fn">xs</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.eraseVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.eraseOptVar"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L388-L391">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.eraseOptVar"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">eraseOptVar</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">rs</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">x?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.eraseOptVar">Lean.Elab.Term.Do.eraseOptVar</a> <span class="fn">rs</span> <a href="../.././Init/Prelude.html#Option.none">none</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">rs</span></li><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.eraseOptVar">Lean.Elab.Term.Do.eraseOptVar</a> <span class="fn">rs</span> <span class="fn">(<a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">x</span>)</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Std/Data/TreeMap/Basic.html#Std.TreeMap.insert">Std.TreeMap.insert</a> <span class="fn">rs</span> <span class="fn">(<a href="../.././Init/Prelude.html#Lean.Syntax.getId">Lean.Syntax.getId</a> <span class="fn">x</span>)</span> <span class="fn">x</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.eraseOptVar" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkSimpleJmp"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L393-L401">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkSimpleJmp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkSimpleJmp</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">rs</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Control/StateRef.html#StateRefT'">StateRefT'</a> <a href="../.././Init/System/IO.html#IO.RealWorld">IO.RealWorld</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl">JPDecl</a>)</span> <a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></span></div></div><p>Create a new join point for <code>c</code>, and jump to it with the variables <code>rs</code></p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkSimpleJmp" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkJmp"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L403-L414">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkJmp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkJmp</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">rs</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">val</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">mkJPBody</span> : <span class="fn"><a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a> → <span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Control/StateRef.html#StateRefT'">StateRefT'</a> <a href="../.././Init/System/IO.html#IO.RealWorld">IO.RealWorld</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl">JPDecl</a>)</span> <a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></span></div></div><p>Create a new join point that takes <code>rs</code> and <code>val</code> as arguments. <code>val</code> must be syntax representing a pure value.
The body of the join point is created using <code>mkJPBody yFresh</code>, where <code>yFresh</code>
is a fresh variable created by this method.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkJmp" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.pullExitPointsAux"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L416-L439">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.pullExitPointsAux"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">pullExitPointsAux</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">rs</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Control/StateRef.html#StateRefT'">StateRefT'</a> <a href="../.././Init/System/IO.html#IO.RealWorld">IO.RealWorld</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.JPDecl">JPDecl</a>)</span> <a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></span></div></div><p><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.pullExitPointsAux">pullExitPointsAux</a> rs c</code> auxiliary method for <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.pullExitPoints">pullExitPoints</a></code>, <code>rs</code> is the set of update variable in the current path.</p></div></div><div class="decl" id="Lean.Elab.Term.Do.pullExitPoints"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L441-L495">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.pullExitPoints"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">pullExitPoints</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></span></div></div><p>Auxiliary operation for adding new variables to the collection of updated variables in a CodeBlock.
When a new variable is not already in the collection, but is shadowed by some declaration in <code>c</code>,
we create auxiliary join points to make sure we preserve the semantics of the code block.
Example: suppose we have the code block <code>print x; let <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> := 10; <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a></code>. And we want to extend it
with the reassignment <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> + 1</code>. We first use <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.pullExitPoints">pullExitPoints</a></code> to create</p><pre><code>let jp (x!1) :=  <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> x!1;
print x;
let <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> := 10;
<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.jmp">jmp</a> jp <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a>
</code></pre><p>and then we add the reassignment</p><pre><code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> + 1
let jp (x!1) := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> x!1;
print x;
let <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> := 10;
<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.jmp">jmp</a> jp <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a>
</code></pre><p>Note that we created a fresh variable <code>x!1</code> to avoid accidental name capture.
As another example, consider</p><pre><code>print x;
let <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> := 10
y := y + 1;
<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> x;
</code></pre><p>We transform it into</p><pre><code>let jp (y x!1) := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> x!1;
print x;
let <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> := 10
y := y + 1;
<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.jmp">jmp</a> jp y <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a>
</code></pre><p>and then we add the reassignment as in the previous example.
We need to include <code>y</code> in the jump, because each exit point is implicitly returning the set of
update variables.</p><p>We implement the method as follows. Let <code>us</code> be <code>c.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.uvars">uvars</a></code>, then
1- for each <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> _ y</code> in <code>c</code>, we create a join point
<code>let j (us y!1) := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> y!1</code>
and replace the <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> _ y</code> with <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.jmp">jmp</a> us y</code>
2- for each <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">break</a></code>, we create a join point
<code>let j (us) := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">break</a></code>
and replace the <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">break</a></code> with <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.jmp">jmp</a> us</code>.
3- Same as 2 for <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">continue</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.pullExitPoints" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.extendUpdatedVarsAux"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L497-L531">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.extendUpdatedVarsAux"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">extendUpdatedVarsAux</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">ws</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.extendUpdatedVarsAux">Lean.Elab.Term.Do.extendUpdatedVarsAux</a> <span class="fn">c</span> <span class="fn">ws</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#_private.Lean.Elab.Do.0.Lean.Elab.Term.Do.extendUpdatedVarsAux.update">Lean.Elab.Term.Do.extendUpdatedVarsAux.update✝</a> <span class="fn">ws</span> <span class="fn">c</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.extendUpdatedVarsAux" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.extendUpdatedVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L533-L543">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.extendUpdatedVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">extendUpdatedVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">ws</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Extend the set of updated variables. It assumes <code>ws</code> is a super set of <code>c.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.uvars">uvars</a></code>.
We <strong>cannot</strong> simply update the field <code>c.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.uvars">uvars</a></code>, because <code>c</code> may have shadowed some variable in <code>ws</code>.
See discussion at <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.pullExitPoints">pullExitPoints</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.extendUpdatedVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.homogenize"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L548-L557">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.homogenize"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">homogenize</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c₁ </span><span class="fn">c₂</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> (<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></div></div><p>Given two code blocks <code>c₁</code> and <code>c₂</code>, make sure they have the same set of updated variables.
Let <code>ws</code> the union of the updated variables in <code>c₁‵ and ‵c₂</code>.
We use <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.extendUpdatedVars">extendUpdatedVars</a> c₁ ws</code> and <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.extendUpdatedVars">extendUpdatedVars</a> c₂ ws</code></p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.homogenize" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkVarDeclCore"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L559-L569">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkVarDeclCore"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkVarDeclCore</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">stx</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></div></div><p>Extending code blocks with variable declarations: <code>let <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> : t := v</code> and <code>let <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> : t ← v</code>.
We remove <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a></code> from the collection of updated variables.
Remark: <code>stx</code> is the syntax for the declaration (e.g., <code>letDecl</code>), and <code>xs</code> are the variables
declared by it. It is an array because we have let-declarations that declare multiple variables.
Example: <code>let (x, y) := t</code></p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkVarDeclCore">Lean.Elab.Term.Do.mkVarDeclCore</a> <span class="fn">xs</span> <span class="fn">stx</span> <span class="fn">c</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">{</a> <span class="fn">code</span> := <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.decl">Lean.Elab.Term.Do.Code.decl</a> <span class="fn">xs</span> <span class="fn">stx</span> <span class="fn"><span class="fn">c</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.code">code</a></span></span>, <span class="fn">uvars</span> := <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.eraseVars">Lean.Elab.Term.Do.eraseVars</a> <span class="fn"><span class="fn">c</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.uvars">uvars</a></span> <span class="fn">xs</span></span> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkVarDeclCore" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkReassignCore"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L571-L583">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkReassignCore"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkReassignCore</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">stx</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Extending code blocks with reassignments: <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> : t := v</code> and <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> : t ← v</code>.
Remark: <code>stx</code> is the syntax for the declaration (e.g., <code>letDecl</code>), and <code>xs</code> are the variables
declared by it. It is an array because we have let-declarations that declare multiple variables.
Example: <code>(x, y) ← t</code></p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkReassignCore" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkSeq"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L585-L586">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkSeq"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkSeq</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">action</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkSeq">Lean.Elab.Term.Do.mkSeq</a> <span class="fn">action</span> <span class="fn">c</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">{</a> <span class="fn">code</span> := <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.seq">Lean.Elab.Term.Do.Code.seq</a> <span class="fn">action</span> <span class="fn"><span class="fn">c</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.code">code</a></span></span>, <span class="fn">uvars</span> := <span class="fn"><span class="fn">c</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.uvars">uvars</a></span> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkSeq" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkTerminalAction"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L588-L589">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkTerminalAction"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkTerminalAction</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">action</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkTerminalAction">Lean.Elab.Term.Do.mkTerminalAction</a> <span class="fn">action</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">{</a> <span class="fn">code</span> := <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Lean.Elab.Term.Do.Code.action</a> <span class="fn">action</span></span> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkTerminalAction" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkReturn"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L591-L592">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkReturn"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkReturn</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref </span><span class="fn">val</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkReturn">Lean.Elab.Term.Do.mkReturn</a> <span class="fn">ref</span> <span class="fn">val</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">{</a> <span class="fn">code</span> := <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Lean.Elab.Term.Do.Code.return</a> <span class="fn">ref</span> <span class="fn">val</span></span> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkReturn" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkBreak"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L594-L595">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkBreak"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkBreak</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkBreak">Lean.Elab.Term.Do.mkBreak</a> <span class="fn">ref</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">{</a> <span class="fn">code</span> := <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">Lean.Elab.Term.Do.Code.break</a> <span class="fn">ref</span></span> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkBreak" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkContinue"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L597-L598">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkContinue"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkContinue</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkContinue">Lean.Elab.Term.Do.mkContinue</a> <span class="fn">ref</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">{</a> <span class="fn">code</span> := <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">Lean.Elab.Term.Do.Code.continue</a> <span class="fn">ref</span></span> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkContinue" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkIte"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L600-L606">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkIte"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkIte</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref </span><span class="fn">optIdent </span><span class="fn">cond</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">thenBranch </span><span class="fn">elseBranch</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkIte" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkPureUnitAction"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L614-L615">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkPureUnitAction"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkPureUnitAction</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkPureUnitAction">Lean.Elab.Term.Do.mkPureUnitAction</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <a href="../.././Lean/Elab/Do.html#_private.Lean.Elab.Do.0.Lean.Elab.Term.Do.mkPureUnit">Lean.Elab.Term.Do.mkPureUnit✝</a>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkTerminalAction">Lean.Elab.Term.Do.mkTerminalAction</a> <span class="fn">__do_lift</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkPureUnitAction" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkUnless"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L617-L619">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkUnless"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkUnless</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">cond</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkUnless" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkMatch"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L621-L627">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkMatch"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkMatch</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref </span><span class="fn">genParam </span><span class="fn">discrs </span><span class="fn">optMotive</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">alts</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt">Alt</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkMatch" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkMatchExpr"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L629-L637">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkMatchExpr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkMatchExpr</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">«meta»</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">discr</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">alts</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.AltExpr">AltExpr</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">elseBranch</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkMatchExpr" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.concat"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L639-L652">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.concat"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">concat</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">terminal</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">kRef</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">y?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Return a code block that executes <code>terminal</code> and then <code>k</code> with the value produced by <code>terminal</code>.
This method assumes <code>terminal</code> is a terminal</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.concat" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getLetIdVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L654-L662">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getLetIdVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getLetIdVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">letId</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getLetIdVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getLetIdDeclVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L664-L668">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getLetIdDeclVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getLetIdDeclVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">letIdDecl</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getLetIdDeclVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getPatternVarsEx"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L671-L673">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getPatternVarsEx"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getPatternVarsEx</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">pattern</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getPatternVarsEx">Lean.Elab.Term.Do.getPatternVarsEx</a> <span class="fn">pattern</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">(<span class="fn"><a href="../.././Lean/Elab/PatternVar.html#Lean.Elab.Term.getPatternVars">Lean.Elab.Term.getPatternVars</a> <span class="fn">pattern</span></span> &lt;|&gt; <span class="fn"><a href="../.././Lean/Elab/Quotation/Util.html#Lean.Elab.Term.Quotation.getPatternVars">Lean.Elab.Term.Quotation.getPatternVars</a> <span class="fn">pattern</span></span>)</span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getPatternVarsEx" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getPatternsVarsEx"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L675-L677">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getPatternsVarsEx"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getPatternsVarsEx</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">patterns</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getPatternsVarsEx">Lean.Elab.Term.Do.getPatternsVarsEx</a> <span class="fn">patterns</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">(<span class="fn"><a href="../.././Lean/Elab/PatternVar.html#Lean.Elab.Term.getPatternsVars">Lean.Elab.Term.getPatternsVars</a> <span class="fn">patterns</span></span> &lt;|&gt; <span class="fn"><a href="../.././Lean/Elab/Quotation/Util.html#Lean.Elab.Term.Quotation.getPatternsVars">Lean.Elab.Term.Quotation.getPatternsVars</a> <span class="fn">patterns</span></span>)</span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getPatternsVarsEx" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getLetPatDeclVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L679-L682">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getLetPatDeclVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getLetPatDeclVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">letPatDecl</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getLetPatDeclVars">Lean.Elab.Term.Do.getLetPatDeclVars</a> <span class="fn">letPatDecl</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getPatternVarsEx">Lean.Elab.Term.Do.getPatternVarsEx</a> <span class="fn">letPatDecl</span><a href="../.././Init/GetElem.html#GetElem.getElem">[</a><span class="fn">0</span><a href="../.././Init/GetElem.html#GetElem.getElem">]</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getLetPatDeclVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getLetEqnsDeclVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L684-L688">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getLetEqnsDeclVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getLetEqnsDeclVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">letEqnsDecl</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getLetEqnsDeclVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getLetDeclVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L690-L700">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getLetDeclVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getLetDeclVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">letDecl</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getLetDeclVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getDoLetVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L702-L704">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getDoLetVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoLetVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doLet</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getDoLetVars">Lean.Elab.Term.Do.getDoLetVars</a> <span class="fn">doLet</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getLetDeclVars">Lean.Elab.Term.Do.getLetDeclVars</a> <span class="fn">doLet</span><a href="../.././Init/GetElem.html#GetElem.getElem">[</a><span class="fn">2</span><a href="../.././Init/GetElem.html#GetElem.getElem">]</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getDoLetVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getDoHaveVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L706-L708">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getDoHaveVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoHaveVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doHave</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getDoHaveVars">Lean.Elab.Term.Do.getDoHaveVars</a> <span class="fn">doHave</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getLetDeclVars">Lean.Elab.Term.Do.getLetDeclVars</a> <span class="fn">doHave</span><a href="../.././Init/GetElem.html#GetElem.getElem">[</a><span class="fn">1</span><a href="../.././Init/GetElem.html#GetElem.getElem">]</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getDoHaveVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getDoLetRecVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L710-L718">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getDoLetRecVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoLetRecVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doLetRec</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getDoLetRecVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getDoIdDeclVar"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L721-L722">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getDoIdDeclVar"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoIdDeclVar</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doIdDecl</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getDoIdDeclVar">Lean.Elab.Term.Do.getDoIdDeclVar</a> <span class="fn">doIdDecl</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">doIdDecl</span><a href="../.././Init/GetElem.html#GetElem.getElem">[</a><span class="fn">0</span><a href="../.././Init/GetElem.html#GetElem.getElem">]</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getDoIdDeclVar" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getDoPatDeclVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L725-L727">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getDoPatDeclVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoPatDeclVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doPatDecl</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getDoPatDeclVars">Lean.Elab.Term.Do.getDoPatDeclVars</a> <span class="fn">doPatDecl</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getPatternVarsEx">Lean.Elab.Term.Do.getPatternVarsEx</a> <span class="fn">doPatDecl</span><a href="../.././Init/GetElem.html#GetElem.getElem">[</a><span class="fn">0</span><a href="../.././Init/GetElem.html#GetElem.getElem">]</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getDoPatDeclVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getDoLetArrowVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L730-L737">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getDoLetArrowVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoLetArrowVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doLetArrow</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getDoLetArrowVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.getDoReassignVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L739-L746">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.getDoReassignVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">getDoReassignVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doReassign</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.getDoReassignVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.mkDoSeq"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L748-L749">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.mkDoSeq"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">mkDoSeq</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.mkDoSeq" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.DoIfView"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L782-L787">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.DoIfView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">DoIfView</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Term.Do.DoIfView.mk"><li id="Lean.Elab.Term.Do.DoIfView.ref" class="structure_field"><div class="structure_field_info">ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.Do.DoIfView.optIdent" class="structure_field"><div class="structure_field_info">optIdent : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.Do.DoIfView.cond" class="structure_field"><div class="structure_field_info">cond : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.Do.DoIfView.thenBranch" class="structure_field"><div class="structure_field_info">thenBranch : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.Do.DoIfView.elseBranch" class="structure_field"><div class="structure_field_info">elseBranch : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li></ul><details id="instances-for-list-Lean.Elab.Term.Do.DoIfView" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.isDoExpr?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L816-L821">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.isDoExpr?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">isDoExpr?</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doElem</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><p>Return <code>some <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">action</a></code> if <code>doElem</code> is a <code>doExpr &lt;action&gt;</code></p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.isDoExpr?">Lean.Elab.Term.Do.isDoExpr?</a> <span class="fn">doElem</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Init/Prelude.html#ite">if</a> (<span class="fn"><span class="fn">doElem</span>.<a href="../.././Init/Prelude.html#Lean.Syntax.getKind">getKind</a></span> <a href="../.././Init/Prelude.html#BEq.beq">==</a> <span class="fn">`Lean.Parser.Term.doExpr</span>) <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#ite">then</a> <span class="fn"><a href="../.././Init/Prelude.html#Option.some">some</a> <span class="fn">doElem</span><a href="../.././Init/GetElem.html#GetElem.getElem">[</a><span class="fn">0</span><a href="../.././Init/GetElem.html#GetElem.getElem">]</a></span> <a href="../.././Init/Prelude.html#ite">else</a> <a href="../.././Init/Prelude.html#Option.none">none</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.isDoExpr?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="mod_doc"><p>The procedure <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.run">ToTerm.run</a></code> converts a <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> into a <code>Syntax</code> term.
We use this method to convert
1- The <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> for a root <code>do ...</code> term into a <code>Syntax</code> term. This kind of
<code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> never contains <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">break</a></code> nor <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">continue</a></code>. Moreover, the collection
of updated variables is not packed into the result.
Thus, we have two kinds of exit points
- <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Code.action</a> e</code> which is converted into <code>e</code>
- <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Code.return</a> _ e</code> which is converted into <code>pure e</code></p><p>We use <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.regular">Kind.regular</a></code> for this case.</p><p>2- The <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> for <code>b</code> at <code>for <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.x">x</a> in xs do b</code>. In this case, we need to generate
a <code>Syntax</code> term representing a function for the <code>xs.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.forIn">forIn</a></code> combinator.</p><p>a) If <code>b</code> contain a <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Code.return</a> _ a</code> exit point. The generated <code>Syntax</code> term
has type <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> (ForInStep (Option α × σ))</code>, where <code>a : α</code>, and the <code>σ</code> is the type
of the tuple of variables reassigned by <code>b</code>.
We use <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.forInWithReturn">Kind.forInWithReturn</a></code> for this case</p><p>b) If <code>b</code> does not contain a <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Code.return</a> _ a</code> exit point. Then, the generated
<code>Syntax</code> term has type <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> (ForInStep σ)</code>.
We use <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.forIn">Kind.forIn</a></code> for this case.</p><p>3- The <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> <code>c</code> for a <code>do</code> sequence nested in a monadic combinator (e.g., <code><a href="../.././Init/Prelude.html#MonadExcept.tryCatch">MonadExcept.tryCatch</a></code>).</p><p>The generated <code>Syntax</code> term for <code>c</code> must inform whether <code>c</code> &quot;exited&quot; using <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Code.action</a></code>, <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Code.return</a></code>,
<code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">Code.break</a></code> or <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">Code.continue</a></code>. We use the auxiliary types <code>DoResult</code>s for storing this information.
For example, the auxiliary type <code>DoResultPBC α σ</code> is used for a code block that exits with <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Code.action</a></code>,
<strong>and</strong> <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">Code.break</a></code>/<code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">Code.continue</a></code>, <code>α</code> is the type of values produced by the exit <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">action</a></code>, and
<code>σ</code> is the type of the tuple of reassigned variables.
The type <code>DoResult α β σ</code> is usedf for code blocks that exit with
<code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Code.action</a></code>, <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Code.return</a></code>, <strong>and</strong> <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">Code.break</a></code>/<code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">Code.continue</a></code>, <code>β</code> is the type of the returned values.
We don't use <code>DoResult α β σ</code> for all cases because:</p><pre><code>  a) The elaborator would not be able to infer all type parameters without extra annotations. For example,
     if the <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.code">code</a> block does not contain `Code.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> _ _`, the elaborator will not be able to infer `β`.

  b) We need to pattern <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.match">match</a> on the result produced by the combinator (e.g., `MonadExcept.tryCatch`),
     but we don't want to consider &quot;unreachable&quot; cases.
</code></pre><p>We do not distinguish between cases that contain <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">break</a></code>, but not <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">continue</a></code>, and vice versa.</p><p>When listing all cases, we use <code>a</code> to indicate the code block contains <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Code.action</a> _</code>, <code>r</code> for <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Code.return</a> _ _</code>,
and <code>b/c</code> for a code block that contains <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">Code.break</a> _</code> or <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">Code.continue</a> _</code>.</p><ul>
<li><p><code>a</code>: <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.regular">Kind.regular</a></code>, type <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> (α × σ)</code></p>
</li>
<li><p><code>r</code>: <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.regular">Kind.regular</a></code>, type <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> (α × σ)</code>
Note that the code that pattern matches on the result will behave differently in this case.
It produces <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> a</code> for this case, and <code>pure a</code> for the previous one.</p>
</li>
<li><p><code>b/c</code>: <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.nestedBC">Kind.nestedBC</a></code>, type <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> (DoResultBC σ)</code></p>
</li>
<li><p><code>a</code> and <code>r</code>:   <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.nestedPR">Kind.nestedPR</a></code>, type <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> (DoResultPR α β σ)</code></p>
</li>
<li><p><code>a</code> and <code>bc</code>:  <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.nestedSBC">Kind.nestedSBC</a></code>, type <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> (DoResultSBC α σ)</code></p>
</li>
<li><p><code>r</code> and <code>bc</code>:  <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.nestedSBC">Kind.nestedSBC</a></code>, type <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> (DoResultSBC α σ)</code>
Again the code that pattern matches on the result will behave differently in this case and
the previous one. It produces <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">return</a> a</code> for the constructor <code>DoResultSPR.pureReturn a u</code> for
this case, and <code>pure a</code> for the previous case.</p>
</li>
<li><p><code>a</code>, <code>r</code>, <code>b/c</code>: <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.nestedPRBC">Kind.nestedPRBC</a></code>, type type <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> (DoResultPRBC α β σ)</code></p>
</li>
</ul><p>Here is the recipe for adding new combinators with nested <code>do</code>s.
Example: suppose we want to support <code>repeat doSeq</code>. Assuming we have <code>repeat : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> α → <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> α</code>
1- Convert <code>doSeq</code> into <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.codeBlock">codeBlock</a> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code>
2- Create term <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult.term">term</a></code> using <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedTerm">mkNestedTerm</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.code">code</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.uvars">uvars</a> a r bc</code> where
<code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.code">code</a></code> is <code>codeBlock.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.code">code</a></code>, <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.uvars">uvars</a></code> is an array containing <code>codeBlock.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.uvars">uvars</a></code>,
<code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a></code> is a <code>Syntax</code> representing the Monad, and
<code>a</code> is true if <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.code">code</a></code> contains <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Code.action</a> _</code>,
<code>r</code> is true if <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.code">code</a></code> contains <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Code.return</a> _ _</code>,
<code>bc</code> is true if <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.code">code</a></code> contains <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">Code.break</a> _</code> or <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">Code.continue</a> _</code>.</p><p>Remark: for combinators such as <code>repeat</code> that take a single <code>doSeq</code>, all
arguments, but <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.ExtractMonadResult.m">m</a></code>, are extracted from <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.codeBlock">codeBlock</a></code>.
3- Create the term <code>repeat $term</code>
4- and then, convert it into a <code>doSeq</code> using <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.matchNestedTermResult">matchNestedTermResult</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt.ref">ref</a> (repeat $term) uvsar a r bc</code></p></div><div class="decl" id="Lean.Elab.Term.Do.annotate"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L940-L960">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.annotate"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">annotate</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">m</span> : <span class="fn"><a href="../.././foundational_types.html">Type</a> → <a href="../.././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Lean.MonadRef">MonadRef</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Lean.MonadQuotation">MonadQuotation</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">ref </span><span class="fn">term</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><p>Helper method for annotating <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult.term">term</a></code> with the raw syntax <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Alt.ref">ref</a></code>.
We use this method to implement finer-grained term infos for <code>do</code>-blocks.</p><p>We use <code>withRef <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult.term">term</a></code> to make sure the synthetic position for the <code>with_annotate_term</code> is equal
to the one for <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult.term">term</a></code>. This is important for producing error messages when there is a type mismatch.
Consider the following example:</p><pre><code>opaque f : <a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Init/Prelude.html#Nat">Nat</a>

def g : <a href="../.././Init/System/IO.html#IO">IO</a> <a href="../.././Init/Prelude.html#String">String</a> := do
  f
</code></pre><p>There is at type mismatch at <code>f</code>, but it is detected when elaborating the expanded term
containing the <code>with_annotate_term .. f</code>. The current <code>getRef</code> when this <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.annotate">annotate</a></code> is invoked
is not necessarily <code>f</code>. Actually, it is the whole <code>do</code>-block. By using <code>withRef</code> we ensure
the synthetic position for the <code>with_annotate_term ..</code> is equal to <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult.term">term</a></code>.
Recall that synthetic positions are used when generating error messages.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.annotate" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.Kind"><div class="inductive"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L964-L971">source</a></div><div class="decl_header"><span class="decl_kind">inductive</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">Kind</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="constructors"><li class="constructor" id="Lean.Elab.Term.Do.ToTerm.Kind.regular">regular : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a></li><li class="constructor" id="Lean.Elab.Term.Do.ToTerm.Kind.forIn">forIn : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a></li><li class="constructor" id="Lean.Elab.Term.Do.ToTerm.Kind.forInWithReturn">forInWithReturn : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a></li><li class="constructor" id="Lean.Elab.Term.Do.ToTerm.Kind.nestedBC">nestedBC : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a></li><li class="constructor" id="Lean.Elab.Term.Do.ToTerm.Kind.nestedPR">nestedPR : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a></li><li class="constructor" id="Lean.Elab.Term.Do.ToTerm.Kind.nestedSBC">nestedSBC : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a></li><li class="constructor" id="Lean.Elab.Term.Do.ToTerm.Kind.nestedPRBC">nestedPRBC : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a></li></ul><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.Kind" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.instInhabitedKind"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L973-L973">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.instInhabitedKind"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">instInhabitedKind</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.instInhabitedKind">Lean.Elab.Term.Do.ToTerm.instInhabitedKind</a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Inhabited.mk">{</a> <span class="fn">default</span> := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.regular">Lean.Elab.Term.Do.ToTerm.Kind.regular</a> <a href="../.././Init/Prelude.html#Inhabited.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.Kind.isRegular"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L975-L977">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.isRegular"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">Kind</span>.<span class="name">isRegular</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a> → <a href="../.././Init/Prelude.html#Bool">Bool</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.regular">Lean.Elab.Term.Do.ToTerm.Kind.regular</a>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.isRegular">isRegular</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Bool.true">true</a></li><li class="equation"><span class="fn"><span class="fn">x✝</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.isRegular">isRegular</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Bool.false">false</a></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.Kind.isRegular" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.Context"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L979-L985">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">Context</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Term.Do.ToTerm.Context.mk"><li id="Lean.Elab.Term.Do.ToTerm.Context.m" class="structure_field"><div class="structure_field_info">m : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div><div class="structure_field_doc"><p>Syntax to reference the monad associated with the do notation.</p></div></li><li id="Lean.Elab.Term.Do.ToTerm.Context.returnType" class="structure_field"><div class="structure_field_info">returnType : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div><div class="structure_field_doc"><p>Syntax to reference the result of the monadic computation performed by the do notation.</p></div></li><li id="Lean.Elab.Term.Do.ToTerm.Context.uvars" class="structure_field"><div class="structure_field_info">uvars : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span></div></li><li id="Lean.Elab.Term.Do.ToTerm.Context.kind" class="structure_field"><div class="structure_field_info">kind : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a></div></li></ul><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.Context" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.M"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L987-L987">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">M</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.M">Lean.Elab.Term.Do.ToTerm.M</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Context">Lean.Elab.Term.Do.ToTerm.Context</a> <a href="../.././Init/Prelude.html#Lean.MacroM">Lean.MacroM</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.M" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.mkUVarTuple"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L989-L991">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkUVarTuple"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkUVarTuple</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.M">M</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkUVarTuple">Lean.Elab.Term.Do.ToTerm.mkUVarTuple</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">ctx</span> ← <a href="../.././Init/Prelude.html#MonadReader.read">read</a>
  <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> <span class="fn">(<a href="../.././Lean/Elab/Do.html#_private.Lean.Elab.Do.0.Lean.Elab.Term.Do.mkTuple">Lean.Elab.Term.Do.mkTuple✝</a> <span class="fn"><span class="fn">ctx</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Context.uvars">uvars</a></span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.mkUVarTuple" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.returnToTerm"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L993-L1003">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.returnToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">returnToTerm</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">val</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.M">M</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.returnToTerm" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.continueToTerm"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1005-L1015">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.continueToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">continueToTerm</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.M">M</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.continueToTerm" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.breakToTerm"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1017-L1027">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.breakToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">breakToTerm</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.M">M</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.breakToTerm" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.actionTerminalToTerm"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1029-L1039">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.actionTerminalToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">actionTerminalToTerm</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">action</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.M">M</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.actionTerminalToTerm" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.seqToTerm"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1041-L1053">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.seqToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">seqToTerm</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">action </span><span class="fn">k</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.M">M</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.seqToTerm" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.declToTerm"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1055-L1084">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.declToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">declToTerm</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">decl </span><span class="fn">k</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.M">M</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.declToTerm" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.reassignToTerm"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1086-L1092">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.reassignToTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">reassignToTerm</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">reassign </span><span class="fn">k</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.reassignToTerm" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.mkIte"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1094-L1099">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkIte"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkIte</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">optIdent </span><span class="fn">cond </span><span class="fn">thenBranch </span><span class="fn">elseBranch</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.mkIte" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.mkJoinPoint"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1101-L1128">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkJoinPoint"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkJoinPoint</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">j</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">ps</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> (<a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">body </span><span class="fn">k</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.M">M</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.mkJoinPoint" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.mkJmp"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1130-L1131">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkJmp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkJmp</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">j</span> : <a href="../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">args</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkJmp">Lean.Elab.Term.Do.ToTerm.mkJmp</a> <span class="fn">ref</span> <span class="fn">j</span> <span class="fn">args</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn">(<a href="../.././Init/Meta/Defs.html#Lean.Syntax.mkApp">Lean.Syntax.mkApp</a> <a href="../.././Init/Prelude.html#Lean.TSyntax.mk">{</a> <span class="fn">raw</span> := <span class="fn"><span class="fn">(<a href="../.././Init/Meta/Defs.html#Lean.mkIdentFrom">Lean.mkIdentFrom</a> <span class="fn">ref</span> <span class="fn">j</span>)</span>.<a href="../.././Init/Prelude.html#Lean.TSyntax.raw">raw</a></span> <a href="../.././Init/Prelude.html#Lean.TSyntax.mk">}</a> <span class="fn">(<a href="../.././Init/Prelude.html#Lean.TSyntaxArray.mk">Lean.TSyntaxArray.mk</a> <span class="fn">args</span>)</span>)</span>.<a href="../.././Init/Prelude.html#Lean.TSyntax.raw">raw</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.mkJmp" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.toTerm"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1133-L1175">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.toTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">toTerm</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.M">M</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.run"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1177-L1178">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.run"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">run</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">code</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">m </span><span class="fn">returnType</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">uvars</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span> := <a href="../.././Init/Prelude.html#List.toArray">#[</a><a href="../.././Init/Prelude.html#List.toArray">]</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">kind</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a> := <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.regular">Kind.regular</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.run">Lean.Elab.Term.Do.ToTerm.run</a> <span class="fn">code</span> <span class="fn">m</span> <span class="fn">returnType</span> <span class="fn">uvars</span> <span class="fn">kind</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.toTerm">Lean.Elab.Term.Do.ToTerm.toTerm</a> <span class="fn">code</span> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Context.mk">{</a> <span class="fn">m</span> := <span class="fn">m</span>, <span class="fn">returnType</span> := <span class="fn">returnType</span>, <span class="fn">uvars</span> := <span class="fn">uvars</span>, <span class="fn">kind</span> := <span class="fn">kind</span> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Context.mk">}</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.run" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.mkNestedKind"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1180-L1195">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedKind"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkNestedKind</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">a </span><span class="fn">r </span><span class="fn">bc</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind">Kind</a></div></div><p>Given</p><ul>
<li><code>a</code> is true if the code block has a <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Code.action</a> _</code> exit point</li>
<li><code>r</code> is true if the code block has a <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Code.return</a> _ _</code> exit point</li>
<li><code>bc</code> is true if the code block has a <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">Code.break</a> _</code> or <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">Code.continue</a> _</code> exit point</li>
</ul><p>generate Kind. See comment at the beginning of the <code>ToTerm</code> namespace.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedKind">Lean.Elab.Term.Do.ToTerm.mkNestedKind</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#Bool.false">false</a> <a href="../.././Init/Prelude.html#Bool.false">false</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.regular">Lean.Elab.Term.Do.ToTerm.Kind.regular</a></li><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedKind">Lean.Elab.Term.Do.ToTerm.mkNestedKind</a> <a href="../.././Init/Prelude.html#Bool.false">false</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#Bool.false">false</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.regular">Lean.Elab.Term.Do.ToTerm.Kind.regular</a></li><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedKind">Lean.Elab.Term.Do.ToTerm.mkNestedKind</a> <a href="../.././Init/Prelude.html#Bool.false">false</a> <a href="../.././Init/Prelude.html#Bool.false">false</a> <a href="../.././Init/Prelude.html#Bool.true">true</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.nestedBC">Lean.Elab.Term.Do.ToTerm.Kind.nestedBC</a></li><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedKind">Lean.Elab.Term.Do.ToTerm.mkNestedKind</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#Bool.false">false</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.nestedPR">Lean.Elab.Term.Do.ToTerm.Kind.nestedPR</a></li><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedKind">Lean.Elab.Term.Do.ToTerm.mkNestedKind</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#Bool.false">false</a> <a href="../.././Init/Prelude.html#Bool.true">true</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.nestedSBC">Lean.Elab.Term.Do.ToTerm.Kind.nestedSBC</a></li><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedKind">Lean.Elab.Term.Do.ToTerm.mkNestedKind</a> <a href="../.././Init/Prelude.html#Bool.false">false</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#Bool.true">true</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.nestedSBC">Lean.Elab.Term.Do.ToTerm.Kind.nestedSBC</a></li><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedKind">Lean.Elab.Term.Do.ToTerm.mkNestedKind</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#Bool.true">true</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.Kind.nestedPRBC">Lean.Elab.Term.Do.ToTerm.Kind.nestedPRBC</a></li><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedKind">Lean.Elab.Term.Do.ToTerm.mkNestedKind</a> <a href="../.././Init/Prelude.html#Bool.false">false</a> <a href="../.././Init/Prelude.html#Bool.false">false</a> <a href="../.././Init/Prelude.html#Bool.false">false</a></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Util.html#panicWithPosWithDecl">panicWithPosWithDecl</a> <span class="fn">&quot;Lean.Elab.Do&quot;</span> <span class="fn">&quot;Lean.Elab.Term.Do.ToTerm.mkNestedKind&quot;</span> <span class="fn">1195</span> <span class="fn">27</span>
    <span class="fn">&quot;unreachable code has been reached&quot;</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.mkNestedKind" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.mkNestedTerm"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1197-L1198">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedTerm"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">mkNestedTerm</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">code</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">m </span><span class="fn">returnType</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">uvars</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">a </span><span class="fn">r </span><span class="fn">bc</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedTerm">Lean.Elab.Term.Do.ToTerm.mkNestedTerm</a> <span class="fn">code</span> <span class="fn">m</span> <span class="fn">returnType</span> <span class="fn">uvars</span> <span class="fn">a</span> <span class="fn">r</span> <span class="fn">bc</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.run">Lean.Elab.Term.Do.ToTerm.run</a> <span class="fn">code</span> <span class="fn">m</span> <span class="fn">returnType</span> <span class="fn">uvars</span> <span class="fn">(<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.mkNestedKind">Lean.Elab.Term.Do.ToTerm.mkNestedKind</a> <span class="fn">a</span> <span class="fn">r</span> <span class="fn">bc</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.mkNestedTerm" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToTerm.matchNestedTermResult"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1200-L1251">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.matchNestedTermResult"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToTerm</span>.<span class="name">matchNestedTermResult</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">term</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">uvars</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">a </span><span class="fn">r </span><span class="fn">bc</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">MacroM</a> <span class="fn">(<a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span></div></div><p>Given a term <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult.term">term</a></code> produced by <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToTerm.run">ToTerm.run</a></code>, pattern match on its result.
See comment at the beginning of the <code>ToTerm</code> namespace.</p><ul>
<li><code>a</code> is true if the code block has a <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.action">Code.action</a> _</code> exit point</li>
<li><code>r</code> is true if the code block has a <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.return">Code.return</a> _ _</code> exit point</li>
<li><code>bc</code> is true if the code block has a <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.break">Code.break</a> _</code> or <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code.continue">Code.continue</a> _</code> exit point</li>
</ul><p>The result is a sequence of <code>doElem</code></p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToTerm.matchNestedTermResult" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.isMutableLet"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1255-L1259">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.isMutableLet"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">isMutableLet</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doElem</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.isMutableLet" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.Context"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1263-L1270">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">Context</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Term.Do.ToCodeBlock.Context.mk"><li id="Lean.Elab.Term.Do.ToCodeBlock.Context.ref" class="structure_field"><div class="structure_field_info">ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.Do.ToCodeBlock.Context.m" class="structure_field"><div class="structure_field_info">m : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div><div class="structure_field_doc"><p>Syntax representing the monad associated with the do notation.</p></div></li><li id="Lean.Elab.Term.Do.ToCodeBlock.Context.returnType" class="structure_field"><div class="structure_field_info">returnType : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div><div class="structure_field_doc"><p>Syntax to reference the result of the monadic computation performed by the do notation.</p></div></li><li id="Lean.Elab.Term.Do.ToCodeBlock.Context.mutableVars" class="structure_field"><div class="structure_field_info">mutableVars : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a></div></li><li id="Lean.Elab.Term.Do.ToCodeBlock.Context.insideFor" class="structure_field"><div class="structure_field_info">insideFor : <a href="../.././Init/Prelude.html#Bool">Bool</a></div></li></ul><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.Context" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.M"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1272-L1272">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">M</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">Lean.Elab.Term.Do.ToCodeBlock.M</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Context">Lean.Elab.Term.Do.ToCodeBlock.Context</a> <a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.M" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.withNewMutableVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1274-L1275">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.withNewMutableVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">withNewMutableVars</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">newVars</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">mutable</span> : <a href="../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.withNewMutableVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.checkReassignable"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1277-L1283">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.checkReassignable"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">checkReassignable</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.checkReassignable" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.checkNotShadowingMutable"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1285-L1291">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.checkNotShadowingMutable"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">checkNotShadowingMutable</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.checkNotShadowingMutable" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.withFor"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1293-L1294">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.withFor"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">withFor</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.withFor" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1296-L1298">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">ToForInTermResult</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult.mk"><li id="Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult.uvars" class="structure_field"><div class="structure_field_info">uvars : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Var">Var</a></span></div></li><li id="Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult.term" class="structure_field"><div class="structure_field_info">term : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li></ul><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.mkForInBody"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1300-L1305">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.mkForInBody"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">mkForInBody</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a> → <span class="fn">(<span class="fn">forInBody</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>) → <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.ToForInTermResult">ToForInTermResult</a></span></span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.mkForInBody" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.ensureInsideFor"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1307-L1309">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.ensureInsideFor"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">ensureInsideFor</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.ensureInsideFor" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.ensureEOS"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1311-L1313">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.ensureEOS"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">ensureEOS</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.ensureEOS">Lean.Elab.Term.Do.ToCodeBlock.ensureEOS</a> <span class="fn">doElems</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Init/Prelude.html#ite">if</a> <span class="fn"><span class="fn">doElems</span>.<a href="../.././Init/Data/List/Basic.html#List.isEmpty">isEmpty</a></span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Bool.true">true</a> <a href="../.././Init/Prelude.html#ite">then</a> <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <a href="../.././Init/Prelude.html#PUnit.unit">PUnit.unit</a></span>
  <a href="../.././Init/Prelude.html#ite">else</a> <span class="fn"><a href="../.././Lean/Exception.html#Lean.throwError">Lean.throwError</a> <span class="fn">(<a href="../.././Lean/Message.html#Lean.ToMessageData.toMessageData">Lean.toMessageData</a> <span class="fn">&quot;must be last element in a `do` sequence&quot;</span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.ensureEOS" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.expandLiftMethod"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1351-L1357">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.expandLiftMethod"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">expandLiftMethod</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doElem</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> (<span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.expandLiftMethod" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.checkLetArrowRHS"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1359-L1367">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.checkLetArrowRHS"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">checkLetArrowRHS</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doElem</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.checkLetArrowRHS" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.doReturnToCode"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1369-L1378">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doReturnToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doReturnToCode</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doReturn</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Generate <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> for <code>doReturn</code> which is of the form</p><pre><code>&quot;return &quot; &gt;&gt; <a href="../.././Init/Control/Basic.html#optional">optional</a> termParser
</code></pre><p><code>doElems</code> is only used for sanity checking.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.doReturnToCode" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.Catch"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1380-L1383">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">Catch</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Elab.Term.Do.ToCodeBlock.Catch.mk"><li id="Lean.Elab.Term.Do.ToCodeBlock.Catch.x" class="structure_field"><div class="structure_field_info">x : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.Do.ToCodeBlock.Catch.optType" class="structure_field"><div class="structure_field_info">optType : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li id="Lean.Elab.Term.Do.ToCodeBlock.Catch.codeBlock" class="structure_field"><div class="structure_field_info">codeBlock : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></div></li></ul><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.Catch" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.getTryCatchUpdatedVars"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1385-L1391">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.getTryCatchUpdatedVars"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">getTryCatchUpdatedVars</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">tryCode</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">catches</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch">Catch</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">finallyCode?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.VarSet">VarSet</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.getTryCatchUpdatedVars" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.tryCatchPred"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1393-L1398">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.tryCatchPred"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">tryCatchPred</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">tryCode</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">catches</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch">Catch</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">finallyCode?</span> : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.Code">Code</a> → <a href="../.././Init/Prelude.html#Bool">Bool</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li><li class="equation"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.tryCatchPred">Lean.Elab.Term.Do.ToCodeBlock.tryCatchPred</a> <span class="fn">tryCode</span> <span class="fn">catches</span> <a href="../.././Init/Prelude.html#Option.none">none</a> <span class="fn">p</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   ((<span class="fn"><span class="fn">p</span> <span class="fn"><span class="fn">tryCode</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.code">code</a></span></span> <a href="../.././Init/Prelude.html#Bool.or">||</a> <span class="fn"><span class="fn"><span class="fn">catches</span>.<a href="../.././Init/Data/Array/Basic.html#Array.any">any</a></span> <span class="fn">fun (<span class="fn">«catch»</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch">Lean.Elab.Term.Do.ToCodeBlock.Catch</a>) =&gt; <span class="fn"><span class="fn">p</span> <span class="fn"><span class="fn"><span class="fn">«catch»</span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.codeBlock">codeBlock</a></span>.<a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock.code">code</a></span></span></span></span>) <a href="../.././Init/Prelude.html#Bool.or">||</a>     <a href="../.././Init/Prelude.html#Bool.false">false</a>)</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.tryCatchPred" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.concatWith"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1401-L1408">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.concatWith"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">concatWith</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">c</span> : <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>&quot;Concatenate&quot; <code>c</code> with <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doSeqToCode">doSeqToCode</a> doElems</code></p></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.doLetArrowToCode"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1410-L1457">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doLetArrowToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doLetArrowToCode</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doLetArrow</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Generate <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> for <code>doLetArrow; doElems</code>
<code>doLetArrow</code> is of the form</p><pre><code>&quot;let &quot; &gt;&gt; <a href="../.././Init/Control/Basic.html#optional">optional</a> &quot;mut &quot; &gt;&gt; (doIdDecl &lt;|&gt; doPatDecl)
</code></pre><p>where</p><pre><code>def doIdDecl   := leading_parser ident &gt;&gt; <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.Catch.optType">optType</a> &gt;&gt; leftArrow &gt;&gt; doElemParser
def doPatDecl  := leading_parser termParser &gt;&gt; leftArrow &gt;&gt; doElemParser &gt;&gt; <a href="../.././Init/Control/Basic.html#optional">optional</a> (&quot; | &quot; &gt;&gt; doSeq)
</code></pre></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.doLetElseToCode"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1459-L1471">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doLetElseToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doLetElseToCode</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doLetElse</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.doReassignArrowToCode"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1473-L1496">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doReassignArrowToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doReassignArrowToCode</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doReassignArrow</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Generate <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> for <code>doReassignArrow; doElems</code>
<code>doReassignArrow</code> is of the form</p><pre><code>(doIdDecl &lt;|&gt; doPatDecl)
</code></pre></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.doIfToCode"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1498-L1510">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doIfToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doIfToCode</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doIf</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Generate <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> for <code>doIf; doElems</code>
<code>doIf</code> is of the form</p><pre><code>&quot;if &quot; &gt;&gt; <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.DoIfView.optIdent">optIdent</a> &gt;&gt; termParser &gt;&gt; &quot; then &quot; &gt;&gt; doSeq
 &gt;&gt; many (group (try (group (&quot; else &quot; &gt;&gt; &quot; if &quot;)) &gt;&gt; <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.DoIfView.optIdent">optIdent</a> &gt;&gt; termParser &gt;&gt; &quot; then &quot; &gt;&gt; doSeq))
 &gt;&gt; <a href="../.././Init/Control/Basic.html#optional">optional</a> (&quot; else &quot; &gt;&gt; doSeq)
</code></pre></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.doUnlessToCode"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1512-L1522">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doUnlessToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doUnlessToCode</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doUnless</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Generate <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> for <code>doUnless; doElems</code>
<code>doUnless</code> is of the form</p><pre><code>&quot;unless &quot; &gt;&gt; termParser &gt;&gt; &quot;do &quot; &gt;&gt; doSeq
</code></pre></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.doForToCode"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1524-L1614">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doForToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doForToCode</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doFor</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Generate <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> for <code>doFor; doElems</code>
<code>doFor</code> is of the form</p><pre><code>def doForDecl := leading_parser termParser &gt;&gt; &quot; in &quot; &gt;&gt; withForbidden &quot;do&quot; termParser
def doFor := leading_parser &quot;for &quot; &gt;&gt; sepBy1 doForDecl &quot;, &quot; &gt;&gt; &quot;do &quot; &gt;&gt; doSeq
</code></pre></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.doMatchToCode"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1616-L1632">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doMatchToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doMatchToCode</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doMatch</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Generate <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> for <code>doMatch; doElems</code></p></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.doMatchExprToCode"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1634-L1650">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doMatchExprToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doMatchExprToCode</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doMatchExpr</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Generate <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> for <code>doMatchExpr; doElems</code></p></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.doTryToCode"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1652-L1710">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doTryToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doTryToCode</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doTry</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">doElems</span> : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><p>Generate <code><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></code> for <code>doTry; doElems</code></p><pre><code>def doTry := leading_parser &quot;try &quot; &gt;&gt; doSeq &gt;&gt; many (doCatch &lt;|&gt; doCatchMatch) &gt;&gt; <a href="../.././Init/Control/Basic.html#optional">optional</a> doFinally
def doCatch      := leading_parser &quot;catch &quot; &gt;&gt; binderIdent &gt;&gt; <a href="../.././Init/Control/Basic.html#optional">optional</a> (&quot;:&quot; &gt;&gt; termParser) &gt;&gt; darrow &gt;&gt; doSeq
def doCatchMatch := leading_parser &quot;catch &quot; &gt;&gt; doMatchAlts
def doFinally    := leading_parser &quot;finally &quot; &gt;&gt; doSeq
</code></pre></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.doSeqToCode"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1712-L1792">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.doSeqToCode"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">doSeqToCode</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span> → <span class="fn"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.M">M</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></span></div></div></div></div><div class="decl" id="Lean.Elab.Term.Do.ToCodeBlock.run"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1795-L1796">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.ToCodeBlock.run"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">ToCodeBlock</span>.<span class="name">run</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">doStx </span><span class="fn">m </span><span class="fn">returnType</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.CodeBlock">CodeBlock</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.ToCodeBlock.run" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.Do.elabDo"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1800-L1808">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.Do.elabDo"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">Do</span>.<span class="name">elabDo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElab">TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.Do.elabDo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandTermFor"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1818-L1819">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.expandTermFor"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandTermFor</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Macro">Macro</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.expandTermFor">Lean.Elab.Term.expandTermFor</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#_private.Lean.Elab.Do.0.Lean.Elab.Term.toDoElem">Lean.Elab.Term.toDoElem✝</a> <span class="fn">`Lean.Parser.Term.doFor</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandTermFor" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandTermTry"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1821-L1822">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.expandTermTry"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandTermTry</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Macro">Macro</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.expandTermTry">Lean.Elab.Term.expandTermTry</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#_private.Lean.Elab.Do.0.Lean.Elab.Term.toDoElem">Lean.Elab.Term.toDoElem✝</a> <span class="fn">`Lean.Parser.Term.doTry</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandTermTry" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandTermUnless"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1824-L1825">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.expandTermUnless"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandTermUnless</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Macro">Macro</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.expandTermUnless">Lean.Elab.Term.expandTermUnless</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#_private.Lean.Elab.Do.0.Lean.Elab.Term.toDoElem">Lean.Elab.Term.toDoElem✝</a> <span class="fn">`Lean.Parser.Term.doUnless</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandTermUnless" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.expandTermReturn"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/Do.lean#L1827-L1828">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/Do.html#Lean.Elab.Term.expandTermReturn"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">expandTermReturn</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Macro">Macro</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../.././Lean/Elab/Do.html#Lean.Elab.Term.expandTermReturn">Lean.Elab.Term.expandTermReturn</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Elab/Do.html#_private.Lean.Elab.Do.0.Lean.Elab.Term.toDoElem">Lean.Elab.Term.toDoElem✝</a> <span class="fn">`Lean.Parser.Term.doReturn</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.expandTermReturn" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>