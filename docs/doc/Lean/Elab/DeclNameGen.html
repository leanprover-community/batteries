<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Elab.DeclNameGen</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="Lean.Elab.DeclNameGen";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">DeclNameGen</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/DeclNameGen.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Lean/Elab/Command.html">Lean.Elab.Command</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Elab.DeclNameGen" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.NameGen.mkBaseNameWithSuffix"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">NameGen</span>.<span class="name">mkBaseNameWithSuffix</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.NameGen.mkBaseNameWithSuffix'"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">NameGen</span>.<span class="name">mkBaseNameWithSuffix'</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Command.mkInstanceName"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkInstanceName</span></a></div></nav><main>
<div class="mod_doc"><h1 class="markdown-heading" id="Name-generator-for-declarations">Name generator for declarations <a class="hover-link" href="#Name-generator-for-declarations">#</a></h1><p>This module provides functionality to generate a name for a declaration using its binders and its type.
This is used to generate names for anonymous instances.</p><p>It uses heuristics to generate an informative but terse name given its namespace, supplied binders, and type.
It tries to make these relatively unique,
and it uses suffixes derived from the module to ensure cross-project uniqueness
when the instance doesn't refer to anything defined in the current project.</p><p>The name generator can be thought of as a kind of pretty printer, rendering an expression in textual form.
The general structure of this generator is</p><ol>
<li><code>Lean.Elab.Command.NameGen.winnowExpr</code> takes an expression and re-uses <code>Expr</code> as a data structure
to record the &quot;Syntax&quot;-like structure.</li>
<li><code>Lean.Elab.Command.NameGen.mkBaseNameCore</code> formats the result of that as a string.
It actually does a bit more computation than that, since it further removes duplicate expressions,
reporting only the first occurrence of each subexpression.</li>
</ol></div><div class="decl" id="Lean.Elab.Command.NameGen.mkBaseNameWithSuffix"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/DeclNameGen.lean#L208-L235">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/DeclNameGen.html#Lean.Elab.Command.NameGen.mkBaseNameWithSuffix"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">NameGen</span>.<span class="name">mkBaseNameWithSuffix</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">pre</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">type</span> : <a href="../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a></span></div></div><p>Uses heuristics to generate an informative but terse base name for a term of the given type, using <code>mkBaseName</code>.
Makes use of the current namespace.
It tries to make these names relatively unique ecosystem-wide,
and it adds suffixes using the current module if the resulting name doesn't refer to anything defined in this module.</p><p>If any constant in <code>type</code> has a name with macro scopes, then the result will be a name with fresh macro scopes.
While in this case we could skip the naming heuristics, we still want informative names for debugging purposes.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.NameGen.mkBaseNameWithSuffix" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.NameGen.mkBaseNameWithSuffix'"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/DeclNameGen.lean#L237-L249">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/DeclNameGen.html#Lean.Elab.Command.NameGen.mkBaseNameWithSuffix'"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">NameGen</span>.<span class="name">mkBaseNameWithSuffix'</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">pre</span> : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">binders</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">type</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term/TermElabM.html#Lean.Elab.Term.TermElabM">TermElabM</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a></span></div></div><p>Elaborates the binders and type and then uses <code><a href="../.././Lean/Elab/DeclNameGen.html#Lean.Elab.Command.NameGen.mkBaseNameWithSuffix">mkBaseNameWithSuffix</a></code> to generate a name.
Furthermore, uses <code>mkUnusedBaseName</code> on the result.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.NameGen.mkBaseNameWithSuffix'" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Command.mkInstanceName"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/DeclNameGen.lean#L253-L268">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/DeclNameGen.html#Lean.Elab.Command.mkInstanceName"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Command</span>.<span class="name">mkInstanceName</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">binders</span> : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">type</span> : <a href="../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Command.html#Lean.Elab.Command.CommandElabM">CommandElabM</a> <a href="../.././Init/Prelude.html#Lean.Name">Name</a></span></div></div><p>Generates an instance name for a declaration that has the given binders and type.
It tries to make these names relatively unique ecosystem-wide.</p><p>Note that this elaborates the binders and the type.
This means that when elaborating an instance declaration, we elaborate these twice.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Command.mkInstanceName" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>