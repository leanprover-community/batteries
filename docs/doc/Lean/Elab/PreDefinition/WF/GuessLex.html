<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../../../.././style.css"></link><link rel="icon" href="../../../.././favicon.svg"></link><link rel="mask-icon" href="../../../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../../../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Elab.PreDefinition.WF.GuessLex</title><script defer="true" src="../../../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../../../.././";</script><script>const MODULE_NAME="Lean.Elab.PreDefinition.WF.GuessLex";</script><script type="module" src="../../../.././jump-src.js"></script><script type="module" src="../../../.././search.js"></script><script type="module" src="../../../.././expand-nav.js"></script><script type="module" src="../../../.././how-about.js"></script><script type="module" src="../../../.././instances.js"></script><script type="module" src="../../../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">PreDefinition</span>.<span class="name">WF</span>.<span class="name">GuessLex</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../../../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../../../.././Lean/Data/Array.html">Lean.Data.Array</a></li><li><a href="../../../.././Lean/Meta/ArgsPacker.html">Lean.Meta.ArgsPacker</a></li><li><a href="../../../.././Lean/Util/HasConstCache.html">Lean.Util.HasConstCache</a></li><li><a href="../../../.././Lean/Elab/PreDefinition/FixedParams.html">Lean.Elab.PreDefinition.FixedParams</a></li><li><a href="../../../.././Lean/Elab/PreDefinition/Mutual.html">Lean.Elab.PreDefinition.Mutual</a></li><li><a href="../../../.././Lean/Elab/PreDefinition/TerminationMeasure.html">Lean.Elab.PreDefinition.TerminationMeasure</a></li><li><a href="../../../.././Lean/Meta/Tactic/Cleanup.html">Lean.Meta.Tactic.Cleanup</a></li><li><a href="../../../.././Lean/Meta/Tactic/TryThis.html">Lean.Meta.Tactic.TryThis</a></li><li><a href="../../../.././Lean/Elab/PreDefinition/Structural/Basic.html">Lean.Elab.PreDefinition.Structural.Basic</a></li><li><a href="../../../.././Lean/Elab/PreDefinition/WF/Basic.html">Lean.Elab.PreDefinition.WF.Basic</a></li><li><a href="../../../.././Lean/Meta/Match/MatcherApp/Transform.html">Lean.Meta.Match.MatcherApp.Transform</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Elab.PreDefinition.WF.GuessLex" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.showInferredTerminationBy"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">showInferredTerminationBy</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.originalVarNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">originalVarNames</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.naryVarNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">naryVarNames</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.BasicMeasure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">BasicMeasure</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instInhabitedBasicMeasure</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure.default"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instInhabitedBasicMeasure</span>.<span class="name">default</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.BasicMeasure.toString"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">BasicMeasure</span>.<span class="name">toString</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.mayOmitSizeOf"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">mayOmitSizeOf</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.withUserNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">withUserNames</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.simpleMeasures"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">simpleMeasures</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">M</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.withRecApps"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">withRecApps</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.SavedLocalContext"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">SavedLocalContext</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.SavedLocalContext.create"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">SavedLocalContext</span>.<span class="name">create</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.SavedLocalContext.run"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">SavedLocalContext</span>.<span class="name">run</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.RecCallWithContext"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallWithContext</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.RecCallWithContext.create"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallWithContext</span>.<span class="name">create</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.filterSubsumed"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">filterSubsumed</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.collectRecCalls"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">collectRecCalls</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.isNatCmp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">isNatCmp</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.complexMeasures"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">complexMeasures</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.GuessLexRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">GuessLexRel</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.instReprGuessLexRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instReprGuessLexRel</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.instReprGuessLexRel.repr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instReprGuessLexRel</span>.<span class="name">repr</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.instDecidableEqGuessLexRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instDecidableEqGuessLexRel</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.instToStringGuessLexRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instToStringGuessLexRel</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.instToFormatGuessLexRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instToFormatGuessLexRel</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.GuessLexRel.toNatRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">GuessLexRel</span>.<span class="name">toNatRel</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.evalRecCall"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">evalRecCall</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.RecCallCache"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallCache</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.RecCallCache.mk"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallCache</span>.<span class="name">mk</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.RecCallCache.eval"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallCache</span>.<span class="name">eval</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.RecCallCache.prettyEntry"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallCache</span>.<span class="name">prettyEntry</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.MutualMeasure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">MutualMeasure</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.inspectCall"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">inspectCall</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.generateCombinations?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">generateCombinations?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.generateMeasures"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">generateMeasures</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.solve"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">solve</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.formatTable"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">formatTable</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.RecCallWithContext.posString"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallWithContext</span>.<span class="name">posString</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.measureHeader"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">measureHeader</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.collectHeaders"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">collectHeaders</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.explainNonMutualFailure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">explainNonMutualFailure</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.explainMutualFailure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">explainMutualFailure</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.explainFailure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">explainFailure</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.mkProdElem"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">mkProdElem</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.toTerminationMeasures"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">toTerminationMeasures</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.GuessLex.reportTerminationMeasures"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">reportTerminationMeasures</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.WF.guessLex"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">guessLex</span></a></div></nav><main>
<div class="mod_doc"><p>This module finds lexicographic termination measures for well-founded recursion.</p><p>Starting with basic measures (<code>sizeOf xᵢ</code> for all parameters <code>xᵢ</code>), and complex measures
(e.g. <code>e₂ - e₁</code> if <code>e₁ &lt; e₂</code> is found in the context of a recursive call) it tries all combinations
until it finds one where all proof obligations go through with the given tactic (<code>decerasing_by</code>),
if given, or the default <code>decreasing_tactic</code>.</p><p>For mutual recursion, a single measure is not just one parameter, but one from each recursive
function. Enumerating these can lead to a combinatoric explosion, so we bound
the number of measures tried.</p><p>In addition to measures derived from <code>sizeOf xᵢ</code>, it also considers measures
that assign an order to the functions themselves. This way we can support mutual
function definitions where no arguments decrease from one function to another.</p><p>The result of this module is a <code>TerminationWF</code>, which is then passed on to <code>wfRecursion</code>; this
design is crucial so that whatever we infer in this module could also be written manually by the
user. It would be bad if there are function definitions that can only be processed with the
guessed lexicographic order.</p><p>The following optimizations are applied to make this feasible:</p><ol>
<li><p>The crucial optimization is to look at each measure of each recursive call
<em>once</em>, try to prove <code>&lt;</code> and (if that fails <code>≤</code>), and then look at that table to
pick a suitable measure.</p>
</li>
<li><p>The next-crucial optimization is to fill that table lazily.  This way, we run the (likely
expensive) tactics as few times as possible, while still being able to consider a possibly
large number of combinations.</p>
</li>
<li><p>Before we even try to prove <code>&lt;</code>, we check if the measures are equal (<code>=</code>). No well-founded
measure will relate equal terms, likely this check is faster than firing up the tactic engine,
and it adds more signal to the output.</p>
</li>
<li><p>Instead of traversing the whole function body over and over, we traverse it once and store
the arguments (in unpacked form) and the local <code>MetaM</code> state at each recursive call
(see <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.collectRecCalls">collectRecCalls</a></code>), which we then re-use for the possibly many proof attempts.</p>
</li>
</ol><p>The logic here is based on “Finding Lexicographic Orders for Termination Proofs in Isabelle/HOL”
by Lukas Bulwahn, Alexander Krauss, and Tobias Nipkow, 10.1007/978-3-540-74591-4_5
<a href="https://www21.in.tum.de/~nipkow/pubs/tphols07.pdf">https://www21.in.tum.de/~nipkow/pubs/tphols07.pdf</a>.</p><p>We got the idea of considering the measure <code>e₂ - e₁</code> if we see <code>e₁ &lt; e₂</code> from
“Termination Analysis with Calling Context Graphs” by Panagiotis Manolios &amp;
Daron Vroon, <a href="https://doi.org/10.1007/11817963_36">https://doi.org/10.1007/11817963_36</a>.</p></div><div class="decl" id="Lean.Elab.WF.GuessLex.showInferredTerminationBy"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L78-L81">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.showInferredTerminationBy"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">showInferredTerminationBy</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Data/Options.html#Lean.Option">Lean.Option</a> <a href="../../../.././Init/Prelude.html#Bool">Bool</a></span></div></div></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.originalVarNames"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L84-L92">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.originalVarNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">originalVarNames</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">preDef</span> : <a href="../../../.././Lean/Elab/PreDefinition/Basic.html#Lean.Elab.PreDefinition">PreDefinition</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span></div></div><p>Given a predefinition, return the variable names in the outermost lambdas.
Includes the “fixed prefix”.</p><p>The length of the returned array is also used to determine the arity
of the function, so it should match what <code>packDomain</code> does.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.originalVarNames">Lean.Elab.WF.GuessLex.originalVarNames</a> <span class="fn">preDef</span></span> <a href="../../../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.lambdaTelescope">Lean.Meta.lambdaTelescope</a> <span class="fn"><span class="fn">preDef</span>.<a href="../../../.././Lean/Elab/PreDefinition/Basic.html#Lean.Elab.PreDefinition.value">value</a></span> <span class="fn">fun (<span class="fn">xs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span>) (<span class="fn">x</span> : <a href="../../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>) =&gt;
    <span class="fn"><a href="../../../.././Init/Data/Array/Basic.html#Array.mapM">Array.mapM</a> <span class="fn">(fun (<span class="fn">x</span> : <a href="../../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>) =&gt; <span class="fn"><span class="fn"><span class="fn">x</span>.<a href="../../../.././Lean/Expr.html#Lean.Expr.fvarId!">fvarId!</a></span>.<a href="../../../.././Lean/Meta/Basic.html#Lean.FVarId.getUserName">getUserName</a></span>)</span> <span class="fn">xs</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.originalVarNames" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.naryVarNames"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L94-L123">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.naryVarNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">naryVarNames</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span></div></div><p>Given the original parameter names from <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.originalVarNames">originalVarNames</a></code>, find
good variable names to be used when talking about termination measures:
Use user-given parameter names if present; use x1...xn otherwise.</p><p>The names ought to accessible (no macro scopes) and fresh wrt to the current environment,
so that with <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.showInferredTerminationBy">showInferredTerminationBy</a></code> we can print them to the user reliably.
We do that by appending <code>'</code> as needed.</p><p>It is possible (but unlikely without malice) that some of the user-given names
shadow each other, and the guessed relation refers to the wrong one. In that
case, the user gets to keep both pieces (and may have to rename variables).</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.naryVarNames" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.BasicMeasure"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L125-L132">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">BasicMeasure</span></a></span><span class="decl_extends">extends</span> <a href="../../../.././Lean/Elab/PreDefinition/TerminationMeasure.html#Lean.Elab.TerminationMeasure">Lean.Elab.TerminationMeasure</a><span class="decl_args"> :</span><div class="decl_type"><a href="../../../.././foundational_types.html">Type</a></div></div><p>A termination measure with extra fields for use within GuessLex</p><ul class="structure_fields" id="Lean.Elab.WF.GuessLex.BasicMeasure.mk"><li class="structure_field inherited_field"><div class="structure_field_info"><a href="../../../.././Lean/Elab/PreDefinition/TerminationMeasure.html#Lean.Elab.TerminationMeasure.ref">ref</a> : <a href="../../../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div></li><li class="structure_field inherited_field"><div class="structure_field_info"><a href="../../../.././Lean/Elab/PreDefinition/TerminationMeasure.html#Lean.Elab.TerminationMeasure.structural">structural</a> : <a href="../../../.././Init/Prelude.html#Bool">Bool</a></div></li><li class="structure_field inherited_field"><div class="structure_field_info"><a href="../../../.././Lean/Elab/PreDefinition/TerminationMeasure.html#Lean.Elab.TerminationMeasure.fn">fn</a> : <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></div></li><li id="Lean.Elab.WF.GuessLex.BasicMeasure.natFn" class="structure_field"><div class="structure_field_info">natFn : <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></div><div class="structure_field_doc"><p>Like <code>.fn</code>, but unconditionally with <code>sizeOf</code> at the right type.
We use this one when in <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.evalRecCall">evalRecCall</a></code></p></div></li></ul><details id="instances-for-list-Lean.Elab.WF.GuessLex.BasicMeasure" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L132-L132">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instInhabitedBasicMeasure</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure">Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure</a> <a href="../../../.././Init/Prelude.html#Eq">=</a> <a href="../../../.././Init/Prelude.html#Inhabited.mk">{</a> <span class="fn">default</span> := <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure.default">Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure.default</a> <a href="../../../.././Init/Prelude.html#Inhabited.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure.default"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L132-L132">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure.default"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instInhabitedBasicMeasure</span>.<span class="name">default</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure.default">Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure.default</a> <a href="../../../.././Init/Prelude.html#Eq">=</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure.mk">{</a> <span class="fn">toTerminationMeasure</span> := <a href="../../../.././Init/Prelude.html#Inhabited.default">default</a>, <span class="fn">natFn</span> := <a href="../../../.././Init/Prelude.html#Inhabited.default">default</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure.mk">}</a></li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.instInhabitedBasicMeasure.default" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.BasicMeasure.toString"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L134-L138">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure.toString"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">BasicMeasure</span>.<span class="name">toString</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">measure</span> : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Init/Prelude.html#String">String</a></span></div></div><p>String description of this measure</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn">measure</span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure.toString">toString</a></span> <a href="../../../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.lambdaTelescope">Lean.Meta.lambdaTelescope</a> <span class="fn"><span class="fn">measure</span>.<a href="../../../.././Lean/Elab/PreDefinition/TerminationMeasure.html#Lean.Elab.TerminationMeasure.fn">fn</a></span> <span class="fn">fun (<span class="fn">_xs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span>) (<span class="fn">e</span> : <a href="../../../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>) =&gt; <span class="fn">do
    let <span class="fn">__do_lift</span> ← <span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.ppExpr">Lean.Meta.ppExpr</a> <span class="fn">e</span></span>
    <span class="fn"><a href="../../../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn"><span class="fn">__do_lift</span>.<a href="../../../.././Init/Data/Format/Basic.html#Std.Format.pretty">pretty</a></span></span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.BasicMeasure.toString" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.mayOmitSizeOf"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L140-L165">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.mayOmitSizeOf"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">mayOmitSizeOf</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">is_mutual</span> : <a href="../../../.././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">args</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Determine if the measure for parameter <code>x</code> should be <code>sizeOf x</code> or just <code>x</code>.</p><p>For non-mutual definitions, we omit <code>sizeOf</code> when the measure does not depend on
the other varying parameters, and its <code><a href="../../../.././Init/WF.html#WellFoundedRelation">WellFoundedRelation</a></code> instance goes via <code><a href="../../../.././Init/SizeOf.html#SizeOf">SizeOf</a></code>.</p><p>For mutual definitions, we omit <code>sizeOf</code> only when the measure is (at reducible transparency!) of
type <code><a href="../../../.././Init/Prelude.html#Nat">Nat</a></code> (else we'd have to worry about differently-typed measures from different functions to
line up).</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.mayOmitSizeOf" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.withUserNames"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L167-L171">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.withUserNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">withUserNames</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">ns</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">α</span></span></div></div><p>Sets the user names for the given free variables in <code>xs</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.withUserNames" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.simpleMeasures"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L173-L195">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.simpleMeasures"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">simpleMeasures</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">preDefs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/Basic.html#Lean.Elab.PreDefinition">PreDefinition</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">fixedParamPerms</span> : <a href="../../../.././Lean/Elab/PreDefinition/FixedParams.html#Lean.Elab.FixedParamPerms">FixedParamPerms</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">userVarNamess</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a>)</span>)</span></span></div></div><p>Create one measure for each (eligible) parameter of the given predefinition.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.simpleMeasures" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.M"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L197-L199">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">M</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">recFnName</span> : <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">α </span><span class="fn">β</span> : <a href="../../../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../../../.././foundational_types.html">Type</a></div></div><p>Internal monad used by <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.withRecApps">withRecApps</a></code></p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.M">Lean.Elab.WF.GuessLex.M</a> <span class="fn">recFnName</span> <span class="fn">α</span> <span class="fn">β</span></span> <a href="../../../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../../../.././Init/Control/StateRef.html#StateRefT'">StateRefT'</a> <a href="../../../.././Init/System/IO.html#IO.RealWorld">IO.RealWorld</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span>)</span> <span class="fn">(<a href="../../../.././Init/Control/StateRef.html#StateRefT'">StateRefT'</a> <a href="../../../.././Init/System/IO.html#IO.RealWorld">IO.RealWorld</a> <span class="fn">(<a href="../../../.././Lean/Util/HasConstCache.html#Lean.HasConstCache">Lean.HasConstCache</a> <a href="../../../.././Init/Prelude.html#List.toArray">#[</a><span class="fn">recFnName</span><a href="../../../.././Init/Prelude.html#List.toArray">]</a>)</span> <a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a>)</span> <span class="fn">β</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.M" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.withRecApps"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L201-L273">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.withRecApps"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">withRecApps</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">recFnName</span> : <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">fixedPrefixSize</span> : <a href="../../../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">param </span><span class="fn">e</span> : <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <span class="fn"><a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a> → <span class="fn"><span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></span> → <span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">α</span></span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span>)</span></span></div></div><p>Traverses the given expression <code>e</code>, and invokes the continuation <code>k</code>
at every saturated call to <code>recFnName</code>.</p><p>The expression <code>param</code> is passed along, and refined when going under a matcher
or <code>casesOn</code> application.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.withRecApps" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.SavedLocalContext"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L275-L281">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.SavedLocalContext"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">SavedLocalContext</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../../.././foundational_types.html">Type</a></div></div><p>A <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.SavedLocalContext">SavedLocalContext</a></code> captures the state and local context of a <code>MetaM</code>, to be continued later.</p><ul class="structure_fields" id="Lean.Elab.WF.GuessLex.SavedLocalContext.mk"><li id="Lean.Elab.WF.GuessLex.SavedLocalContext.savedLocalContext" class="structure_field"><div class="structure_field_info">savedLocalContext : <a href="../../../.././Lean/LocalContext.html#Lean.LocalContext">LocalContext</a></div></li><li id="Lean.Elab.WF.GuessLex.SavedLocalContext.savedLocalInstances" class="structure_field"><div class="structure_field_info">savedLocalInstances : <a href="../../../.././Lean/MetavarContext.html#Lean.LocalInstances">LocalInstances</a></div></li><li id="Lean.Elab.WF.GuessLex.SavedLocalContext.savedState" class="structure_field"><div class="structure_field_info">savedState : <a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.SavedState">Meta.SavedState</a></div></li></ul><details id="instances-for-list-Lean.Elab.WF.GuessLex.SavedLocalContext" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.SavedLocalContext.create"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L283-L288">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.SavedLocalContext.create"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">SavedLocalContext</span>.<span class="name">create</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.SavedLocalContext">SavedLocalContext</a></span></div></div><p>Capture the <code>MetaM</code> state including local context.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.SavedLocalContext.create" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.SavedLocalContext.run"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L290-L296">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.SavedLocalContext.run"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">SavedLocalContext</span>.<span class="name">run</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">slc</span> : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.SavedLocalContext">SavedLocalContext</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">k</span> : <span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">α</span></span></div></div><p>Run a <code>MetaM</code> action in the saved state.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn">slc</span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.SavedLocalContext.run">run</a></span> <span class="fn">k</span></span> <a href="../../../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../../../.././Lean/Util/MonadBacktrack.html#Lean.withoutModifyingState">Lean.withoutModifyingState</a>
    <span class="fn">(<a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.withLCtx">Lean.Meta.withLCtx</a> <span class="fn"><span class="fn">slc</span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.SavedLocalContext.savedLocalContext">savedLocalContext</a></span> <span class="fn"><span class="fn">slc</span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.SavedLocalContext.savedLocalInstances">savedLocalInstances</a></span> <span class="fn">do
      <span class="fn"><span class="fn"><span class="fn">slc</span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.SavedLocalContext.savedState">savedState</a></span>.<a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.SavedState.restore">restore</a></span>
      <span class="fn">k</span></span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.SavedLocalContext.run" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.RecCallWithContext"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L298-L311">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallWithContext</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../../.././foundational_types.html">Type</a></div></div><p>A <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext">RecCallWithContext</a></code> focuses on a single recursive call in a unary predefinition,
and runs the given action in the context of that call.</p><ul class="structure_fields" id="Lean.Elab.WF.GuessLex.RecCallWithContext.mk"><li id="Lean.Elab.WF.GuessLex.RecCallWithContext.ref" class="structure_field"><div class="structure_field_info">ref : <a href="../../../.././Init/Prelude.html#Lean.Syntax">Syntax</a></div><div class="structure_field_doc"><p>Syntax location of recursive call</p></div></li><li id="Lean.Elab.WF.GuessLex.RecCallWithContext.caller" class="structure_field"><div class="structure_field_info">caller : <a href="../../../.././Init/Prelude.html#Nat">Nat</a></div><div class="structure_field_doc"><p>Function index of caller</p></div></li><li id="Lean.Elab.WF.GuessLex.RecCallWithContext.params" class="structure_field"><div class="structure_field_info">params : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div><div class="structure_field_doc"><p>Parameters of caller (including fixed prefix)</p></div></li><li id="Lean.Elab.WF.GuessLex.RecCallWithContext.callee" class="structure_field"><div class="structure_field_info">callee : <a href="../../../.././Init/Prelude.html#Nat">Nat</a></div><div class="structure_field_doc"><p>Function index of callee</p></div></li><li id="Lean.Elab.WF.GuessLex.RecCallWithContext.args" class="structure_field"><div class="structure_field_info">args : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div><div class="structure_field_doc"><p>Arguments to callee (including fixed prefix)</p></div></li><li id="Lean.Elab.WF.GuessLex.RecCallWithContext.ctxt" class="structure_field"><div class="structure_field_info">ctxt : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.SavedLocalContext">SavedLocalContext</a></div></li></ul><details id="instances-for-list-Lean.Elab.WF.GuessLex.RecCallWithContext" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.RecCallWithContext.create"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L313-L316">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext.create"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallWithContext</span>.<span class="name">create</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">ref</span> : <a href="../../../.././Init/Prelude.html#Lean.Syntax">Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">caller</span> : <a href="../../../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">params</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">callee</span> : <a href="../../../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">args</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext">RecCallWithContext</a></span></div></div><p>Store the current recursive call and its context.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.RecCallWithContext.create" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.filterSubsumed"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L319-L339">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.filterSubsumed"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">filterSubsumed</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">rcs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext">RecCallWithContext</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext">RecCallWithContext</a></span></div></div><p>The elaborator is prone to duplicate terms, including recursive calls, even if the user
only wrote a single one. This duplication is wasteful if we run the tactics on duplicated
calls, and confusing in the output of GuessLex. So prune the list of recursive calls,
and remove those where another call exists that has the same goal and context that is no more
specific.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.filterSubsumed" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.collectRecCalls"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L341-L364">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.collectRecCalls"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">collectRecCalls</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">unaryPreDef</span> : <a href="../../../.././Lean/Elab/PreDefinition/Basic.html#Lean.Elab.PreDefinition">PreDefinition</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">fixedParamPerms</span> : <a href="../../../.././Lean/Elab/PreDefinition/FixedParams.html#Lean.Elab.FixedParamPerms">FixedParamPerms</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">argsPacker</span> : <a href="../../../.././Lean/Meta/ArgsPacker/Basic.html#Lean.Meta.ArgsPacker">Meta.ArgsPacker</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext">RecCallWithContext</a>)</span></span></div></div><p>Traverse a unary <code>PreDefinition</code>, and returns a <code>WithRecCall</code> closure for each recursive
call site.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.collectRecCalls" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.isNatCmp"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L366-L382">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.isNatCmp"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">isNatCmp</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">e</span> : <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Option">Option</a> (<a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a> <a href="../../../.././Init/Prelude.html#Prod">×</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a>))</span></span></div></div><p>Is the expression a <code>&lt;</code>-like comparison of <code><a href="../../../.././Init/Prelude.html#Nat">Nat</a></code> expressions</p></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.complexMeasures"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L384-L417">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.complexMeasures"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">complexMeasures</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">preDefs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/Basic.html#Lean.Elab.PreDefinition">PreDefinition</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">fixedParamPerms</span> : <a href="../../../.././Lean/Elab/PreDefinition/FixedParams.html#Lean.Elab.FixedParamPerms">FixedParamPerms</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">userVarNamess</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">recCalls</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext">RecCallWithContext</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a>)</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.complexMeasures" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.GuessLexRel"><div class="inductive"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L419-L422">source</a></div><div class="decl_header"><span class="decl_kind">inductive</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">GuessLexRel</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../../.././foundational_types.html">Type</a></div></div><p>A <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></code> described how a recursive call affects a measure; whether it
decreases strictly, non-strictly, is equal, or else.</p><ul class="constructors"><li class="constructor" id="Lean.Elab.WF.GuessLex.GuessLexRel.lt">lt : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></li><li class="constructor" id="Lean.Elab.WF.GuessLex.GuessLexRel.eq">eq : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></li><li class="constructor" id="Lean.Elab.WF.GuessLex.GuessLexRel.le">le : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></li><li class="constructor" id="Lean.Elab.WF.GuessLex.GuessLexRel.no_idea">no_idea : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></li></ul><details id="instances-for-list-Lean.Elab.WF.GuessLex.GuessLexRel" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.instReprGuessLexRel"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L422-L422">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instReprGuessLexRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instReprGuessLexRel</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Init/Data/Repr.html#Repr">Repr</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instReprGuessLexRel">Lean.Elab.WF.GuessLex.instReprGuessLexRel</a> <a href="../../../.././Init/Prelude.html#Eq">=</a> <a href="../../../.././Init/Data/Repr.html#Repr.mk">{</a> <span class="fn">reprPrec</span> := <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instReprGuessLexRel.repr">Lean.Elab.WF.GuessLex.instReprGuessLexRel.repr</a> <a href="../../../.././Init/Data/Repr.html#Repr.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.instReprGuessLexRel.repr"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L422-L422">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instReprGuessLexRel.repr"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instReprGuessLexRel</span>.<span class="name">repr</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a> → <span class="fn"><a href="../../../.././Init/Prelude.html#Nat">Nat</a> → <a href="../../../.././Init/Data/Format/Basic.html#Std.Format">Format</a></span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.instReprGuessLexRel.repr" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.instDecidableEqGuessLexRel"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L422-L422">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instDecidableEqGuessLexRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instDecidableEqGuessLexRel</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instDecidableEqGuessLexRel">Lean.Elab.WF.GuessLex.instDecidableEqGuessLexRel</a> <span class="fn">x✝</span> <span class="fn">y✝</span></span> <a href="../../../.././Init/Prelude.html#Eq">=</a> <span class="fn">if h : <span class="fn"><span class="fn">x✝</span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel.ctorIdx">ctorIdx</a></span> <a href="../../../.././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">y✝</span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel.ctorIdx">ctorIdx</a></span> then <span class="fn"><a href="../../../.././Init/Prelude.html#Decidable.isTrue">isTrue</a> <span class="fn">⋯</span></span> else <span class="fn"><a href="../../../.././Init/Prelude.html#Decidable.isFalse">isFalse</a> <span class="fn">⋯</span></span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.instToStringGuessLexRel"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L424-L428">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instToStringGuessLexRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instToStringGuessLexRel</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Init/Data/ToString/Basic.html#ToString">ToString</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.instToFormatGuessLexRel"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L430-L431">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instToFormatGuessLexRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">instToFormatGuessLexRel</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Init/Data/Format/Basic.html#Std.ToFormat">ToFormat</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.instToFormatGuessLexRel">Lean.Elab.WF.GuessLex.instToFormatGuessLexRel</a> <a href="../../../.././Init/Prelude.html#Eq">=</a>   <a href="../../../.././Init/Data/Format/Basic.html#Std.ToFormat.mk">{</a> <span class="fn">format</span> := <span class="fn">fun (<span class="fn">r</span> : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">Lean.Elab.WF.GuessLex.GuessLexRel</a>) =&gt; <span class="fn"><a href="../../../.././Init/Data/Format/Basic.html#Std.Format.text">Std.Format.text</a> <span class="fn">(<a href="../../../.././Init/Data/ToString/Basic.html#ToString.toString">toString</a> <span class="fn">r</span>)</span></span></span> <a href="../../../.././Init/Data/Format/Basic.html#Std.ToFormat.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.GuessLexRel.toNatRel"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L433-L438">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel.toNatRel"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">GuessLexRel</span>.<span class="name">toNatRel</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a> → <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></div><p>Given a <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></code>, produce a binary <code>Expr</code> that relates two <code><a href="../../../.././Init/Prelude.html#Nat">Nat</a></code> values accordingly.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li><li class="equation"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel.lt">Lean.Elab.WF.GuessLex.GuessLexRel.lt</a>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel.toNatRel">toNatRel</a></span> <a href="../../../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../../../.././Lean/Expr.html#Lean.mkAppN">Lean.mkAppN</a> <span class="fn">(<a href="../../../.././Lean/Expr.html#Lean.mkConst">Lean.mkConst</a> <span class="fn">`LT.lt</span> <a href="../../../.././Init/Prelude.html#List.cons">[</a><a href="../../../.././Lean/Level.html#Lean.levelZero">Lean.levelZero</a><a href="../../../.././Init/Prelude.html#List.cons">]</a>)</span> <a href="../../../.././Init/Prelude.html#List.toArray">#[</a><span class="fn"><a href="../../../.././Lean/Expr.html#Lean.mkConst">Lean.mkConst</a> <span class="fn">`Nat</span></span><a href="../../../.././Init/Prelude.html#List.cons">,</a> <span class="fn"><a href="../../../.././Lean/Expr.html#Lean.mkConst">Lean.mkConst</a> <span class="fn">`instLTNat</span></span><a href="../../../.././Init/Prelude.html#List.toArray">]</a></span></li><li class="equation"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel.eq">Lean.Elab.WF.GuessLex.GuessLexRel.eq</a>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel.toNatRel">toNatRel</a></span> <a href="../../../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../../../.././Lean/Expr.html#Lean.mkAppN">Lean.mkAppN</a> <span class="fn">(<a href="../../../.././Lean/Expr.html#Lean.mkConst">Lean.mkConst</a> <span class="fn">`Eq</span> <a href="../../../.././Init/Prelude.html#List.cons">[</a><a href="../../../.././Lean/Level.html#Lean.levelOne">Lean.levelOne</a><a href="../../../.././Init/Prelude.html#List.cons">]</a>)</span> <a href="../../../.././Init/Prelude.html#List.toArray">#[</a><span class="fn"><a href="../../../.././Lean/Expr.html#Lean.mkConst">Lean.mkConst</a> <span class="fn">`Nat</span></span><a href="../../../.././Init/Prelude.html#List.toArray">]</a></span></li><li class="equation"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel.le">Lean.Elab.WF.GuessLex.GuessLexRel.le</a>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel.toNatRel">toNatRel</a></span> <a href="../../../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../../../.././Lean/Expr.html#Lean.mkAppN">Lean.mkAppN</a> <span class="fn">(<a href="../../../.././Lean/Expr.html#Lean.mkConst">Lean.mkConst</a> <span class="fn">`LE.le</span> <a href="../../../.././Init/Prelude.html#List.cons">[</a><a href="../../../.././Lean/Level.html#Lean.levelZero">Lean.levelZero</a><a href="../../../.././Init/Prelude.html#List.cons">]</a>)</span> <a href="../../../.././Init/Prelude.html#List.toArray">#[</a><span class="fn"><a href="../../../.././Lean/Expr.html#Lean.mkConst">Lean.mkConst</a> <span class="fn">`Nat</span></span><a href="../../../.././Init/Prelude.html#List.cons">,</a> <span class="fn"><a href="../../../.././Lean/Expr.html#Lean.mkConst">Lean.mkConst</a> <span class="fn">`instLENat</span></span><a href="../../../.././Init/Prelude.html#List.toArray">]</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.GuessLexRel.toNatRel" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.evalRecCall"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L440-L481">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.evalRecCall"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">evalRecCall</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">callerName</span> : <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">decrTactic?</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Option">Option</a> <a href="../../../.././Lean/Elab/PreDefinition/TerminationHint.html#Lean.Elab.DecreasingBy">DecreasingBy</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">callerMeasures </span><span class="fn">calleeMeasures</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">rcc</span> : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext">RecCallWithContext</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">callerMeasureIdx </span><span class="fn">calleeMeasureIdx</span> : <a href="../../../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></span></div></div><p>For a given recursive call, and a choice of parameter and argument index,
try to prove equality, &lt; or ≤.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.evalRecCall" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.RecCallCache"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L484-L490">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallCache</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../../.././foundational_types.html">Type</a></div></div><ul class="structure_ext"><li id="Lean.Elab.WF.GuessLex.RecCallCache.mk''" class="structure_ext_ctor">mk'' :: (</li><ul class="structure_ext_fields"><li id="Lean.Elab.WF.GuessLex.RecCallCache.callerName" class="structure_field"><div class="structure_field_info">callerName : <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a></div></li><li id="Lean.Elab.WF.GuessLex.RecCallCache.decrTactic?" class="structure_field"><div class="structure_field_info">decrTactic? : <span class="fn"><a href="../../../.././Init/Prelude.html#Option">Option</a> <a href="../../../.././Lean/Elab/PreDefinition/TerminationHint.html#Lean.Elab.DecreasingBy">DecreasingBy</a></span></div></li><li id="Lean.Elab.WF.GuessLex.RecCallCache.callerMeasures" class="structure_field"><div class="structure_field_info">callerMeasures : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a></span></div></li><li id="Lean.Elab.WF.GuessLex.RecCallCache.calleeMeasures" class="structure_field"><div class="structure_field_info">calleeMeasures : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a></span></div></li><li id="Lean.Elab.WF.GuessLex.RecCallCache.rcc" class="structure_field"><div class="structure_field_info">rcc : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext">RecCallWithContext</a></div></li><li id="Lean.Elab.WF.GuessLex.RecCallCache.cache" class="structure_field"><div class="structure_field_info">cache : <span class="fn"><a href="../../../.././Init/System/IO.html#IO.Ref">IO.Ref</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Option">Option</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a>)</span>)</span>)</span></span></div></li></ul><li class="structure_ext_ctor">)</li></ul><details id="instances-for-list-Lean.Elab.WF.GuessLex.RecCallCache" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.RecCallCache.mk"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L492-L501">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache.mk"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallCache</span>.<span class="name">mk</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">funNames</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">decrTactics</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Option">Option</a> <a href="../../../.././Lean/Elab/PreDefinition/TerminationHint.html#Lean.Elab.DecreasingBy">DecreasingBy</a>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">measuress</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">rcc</span> : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext">RecCallWithContext</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Init/System/IO.html#BaseIO">BaseIO</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache">RecCallCache</a></span></div></div><p>Create a cache to memoize calls to <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.evalRecCall">evalRecCall</a> descTactic? <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache.rcc">rcc</a></code></p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.RecCallCache.mk" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.RecCallCache.eval"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L503-L511">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache.eval"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallCache</span>.<span class="name">eval</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">rc</span> : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache">RecCallCache</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">callerMeasureIdx </span><span class="fn">calleeMeasureIdx</span> : <a href="../../../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></span></div></div><p>Run <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.evalRecCall">evalRecCall</a></code> and cache there result</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.RecCallCache.eval" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.RecCallCache.prettyEntry"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L513-L518">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache.prettyEntry"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallCache</span>.<span class="name">prettyEntry</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">rcc</span> : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache">RecCallCache</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">callerMeasureIdx </span><span class="fn">calleeMeasureIdx</span> : <a href="../../../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Init/Prelude.html#String">String</a></span></div></div><p>Print a single cache entry as a string, without forcing it</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.RecCallCache.prettyEntry" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.MutualMeasure"><div class="inductive"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L520-L526">source</a></div><div class="decl_header"><span class="decl_kind">inductive</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.MutualMeasure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">MutualMeasure</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../../.././foundational_types.html">Type</a></div></div><p>The measures that we order lexicographically can be comparing basic measures,
or numbering the functions</p><ul class="constructors"><li class="constructor" id="Lean.Elab.WF.GuessLex.MutualMeasure.args">args : <span class="fn"><span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Nat">Nat</a></span> → <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.MutualMeasure">MutualMeasure</a></span><div class="inductive_ctor_doc"><p>For every function, the given argument index</p></div></li><li class="constructor" id="Lean.Elab.WF.GuessLex.MutualMeasure.func">func : <span class="fn"><a href="../../../.././Init/Prelude.html#Nat">Nat</a> → <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.MutualMeasure">MutualMeasure</a></span><div class="inductive_ctor_doc"><p>The given function index is assigned 1, the rest 0</p></div></li></ul><details id="instances-for-list-Lean.Elab.WF.GuessLex.MutualMeasure" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.inspectCall"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L528-L540">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.inspectCall"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">inspectCall</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">rc</span> : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache">RecCallCache</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.MutualMeasure">MutualMeasure</a> → <span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></span></span></div></div><p>Evaluate a recursive call at a given <code><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.MutualMeasure">MutualMeasure</a></code></p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li><li class="equation"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.inspectCall">Lean.Elab.WF.GuessLex.inspectCall</a> <span class="fn">rc</span> <span class="fn">(<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.MutualMeasure.args">Lean.Elab.WF.GuessLex.MutualMeasure.args</a> <span class="fn">tmIdxs</span>)</span></span> <a href="../../../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn"><span class="fn">rc</span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache.eval">eval</a></span> <span class="fn">tmIdxs</span><a href="../../../.././Init/GetElem.html#GetElem?.getElem!">[</a><span class="fn"><span class="fn"><span class="fn">rc</span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache.rcc">rcc</a></span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext.caller">caller</a></span><a href="../../../.././Init/GetElem.html#GetElem?.getElem!">]</a><a href="../../../.././Init/GetElem.html#GetElem?.getElem!">!</a> <span class="fn">tmIdxs</span><a href="../../../.././Init/GetElem.html#GetElem?.getElem!">[</a><span class="fn"><span class="fn"><span class="fn">rc</span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache.rcc">rcc</a></span>.<a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext.callee">callee</a></span><a href="../../../.././Init/GetElem.html#GetElem?.getElem!">]</a><a href="../../../.././Init/GetElem.html#GetElem?.getElem!">!</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.inspectCall" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.generateCombinations?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L543-L570">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.generateCombinations?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">generateCombinations?</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">numMeasures</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Nat">Nat</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">threshold</span> : <a href="../../../.././Init/Prelude.html#Nat">Nat</a> := <span class="fn">32</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Init/Prelude.html#Option">Option</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Nat">Nat</a>)</span>)</span></span></div></div><p>Generate all combination of measures. Assumes we have numbered the measures of each function,
and their counts is in <code>numMeasures</code>.</p><p>This puts the uniform combinations ([0,0,0], [1,1,1]) to the front; they are commonly most useful to
try first, when the mutually recursive functions have similar argument structures</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.generateCombinations?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.generateMeasures"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L572-L588">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.generateMeasures"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">generateMeasures</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">numMeasures</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Nat">Nat</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.MutualMeasure">MutualMeasure</a>)</span></span></div></div><p>Enumerate all measures we want to try.</p><p>All measures (resp. combinations thereof) and
possible orderings of functions (if more than one)</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.generateMeasures" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.solve"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L590-L627">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.solve"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">solve</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">m</span> : <span class="fn"><a href="../../../.././foundational_types.html">Type</a> → <a href="../../../.././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../../.././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">measures</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">calls</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<span class="fn">α</span> → <span class="fn"><span class="fn">m</span> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.GuessLexRel">GuessLexRel</a></span>)</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <span class="fn">(<a href="../../../.././Init/Prelude.html#Option">Option</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span>)</span>)</span></span></div></div><p>The core logic of guessing the lexicographic order
Given a matrix that for each call and measure indicates whether that measure is
decreasing, equal, less-or-equal or unknown, It finds a sequence of measures
that is lexicographically decreasing.</p><p>The matrix is implemented here as an array of monadic query methods only so that
we can fill is lazily. Morally, this is a pure function</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.solve">Lean.Elab.WF.GuessLex.solve</a> <span class="fn">measures</span> <span class="fn">calls</span></span> <a href="../../../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#_private.Lean.Elab.PreDefinition.WF.GuessLex.0.Lean.Elab.WF.GuessLex.solve.go">Lean.Elab.WF.GuessLex.solve.go✝</a> <span class="fn">measures</span> <span class="fn">calls</span> <a href="../../../.././Init/Prelude.html#List.toArray">#[</a><a href="../../../.././Init/Prelude.html#List.toArray">]</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.solve" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.formatTable"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L629-L655">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.formatTable"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">formatTable</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#String">String</a>)</span></span> → <a href="../../../.././Init/Prelude.html#String">String</a></span></div></div><p>Given a matrix (row-major) of strings, arranges them in tabular form.
First column is left-aligned, others right-aligned.
Single space as column separator.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.formatTable" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.RecCallWithContext.posString"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L657-L670">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext.posString"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">RecCallWithContext</span>.<span class="name">posString</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">rcc</span> : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallWithContext">RecCallWithContext</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Init/Prelude.html#String">String</a></span></div></div><p>Concise textual representation of the source location of a recursive call</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.RecCallWithContext.posString" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.measureHeader"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L673-L683">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.measureHeader"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">measureHeader</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">measure</span> : <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Init/Control/State.html#StateT">StateT</a> (<a href="../../../.././Init/Prelude.html#Nat">Nat</a> <a href="../../../.././Init/Prelude.html#Prod">×</a> <a href="../../../.././Init/Prelude.html#String">String</a>) <a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Init/Prelude.html#String">String</a></span></div></div><p>How to present the basic measure in the table header, possibly abbreviated.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.measureHeader" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.collectHeaders"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L685-L687">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.collectHeaders"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">collectHeaders</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">a</span> : <span class="fn"><a href="../../../.././Init/Control/State.html#StateT">StateT</a> (<a href="../../../.././Init/Prelude.html#Nat">Nat</a> <a href="../../../.././Init/Prelude.html#Prod">×</a> <a href="../../../.././Init/Prelude.html#String">String</a>) <a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> (<span class="fn">α</span> <a href="../../../.././Init/Prelude.html#Prod">×</a> <a href="../../../.././Init/Prelude.html#String">String</a>)</span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.collectHeaders">Lean.Elab.WF.GuessLex.collectHeaders</a> <span class="fn">a</span></span> <a href="../../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__discr</span> ← <span class="fn"><span class="fn"><span class="fn">a</span>.<a href="../../../.././Init/Control/State.html#StateT.run">run</a></span> <a href="../../../.././Init/Prelude.html#Prod.mk">(</a><span class="fn">0</span><a href="../../../.././Init/Prelude.html#Prod.mk">,</a> <span class="fn">&quot;&quot;</span><a href="../../../.././Init/Prelude.html#Prod.mk">)</a></span>
  <span class="fn">match <span class="fn">__discr</span> with
    | <a href="../../../.././Init/Prelude.html#Prod.mk">(</a><span class="fn">x</span><a href="../../../.././Init/Prelude.html#Prod.mk">,</a> <span class="fn">fst</span><a href="../../../.././Init/Prelude.html#Prod.mk">,</a> <span class="fn">footer</span><a href="../../../.././Init/Prelude.html#Prod.mk">)</a> =&gt; <span class="fn"><a href="../../../.././Init/Prelude.html#Pure.pure">pure</a> <a href="../../../.././Init/Prelude.html#Prod.mk">(</a><span class="fn">x</span><a href="../../../.././Init/Prelude.html#Prod.mk">,</a> <span class="fn">footer</span><a href="../../../.././Init/Prelude.html#Prod.mk">)</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.collectHeaders" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.explainNonMutualFailure"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L690-L703">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.explainNonMutualFailure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">explainNonMutualFailure</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">measures</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">rcs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache">RecCallCache</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Init/Data/Format/Basic.html#Std.Format">Format</a></span></div></div><p>Explain what we found out about the recursive calls (non-mutual case)</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.explainNonMutualFailure" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.explainMutualFailure"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L705-L737">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.explainMutualFailure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">explainMutualFailure</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">declNames</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">measuress</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">rcs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache">RecCallCache</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Init/Data/Format/Basic.html#Std.Format">Format</a></span></div></div><p>Explain what we found out about the recursive calls (mutual case)</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.explainMutualFailure" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.explainFailure"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L739-L747">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.explainFailure"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">explainFailure</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">declNames</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">measuress</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">rcs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.RecCallCache">RecCallCache</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Init/Data/Format/Basic.html#Std.Format">Format</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.explainFailure" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.mkProdElem"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L749-L758">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.mkProdElem"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">mkProdElem</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">xs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Lean/Expr.html#Lean.Expr">Expr</a></span></div></div><p>For <code>#[x₁, .., xₙ]</code> create <code>(x₁, .., xₙ)</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.mkProdElem" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.toTerminationMeasures"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L760-L772">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.toTerminationMeasures"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">toTerminationMeasures</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">preDefs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/Basic.html#Lean.Elab.PreDefinition">PreDefinition</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">fixedParamPerms</span> : <a href="../../../.././Lean/Elab/PreDefinition/FixedParams.html#Lean.Elab.FixedParamPerms">FixedParamPerms</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">userVarNamess</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">measuress</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.BasicMeasure">BasicMeasure</a>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">solution</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.MutualMeasure">MutualMeasure</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Lean/Elab/PreDefinition/TerminationMeasure.html#Lean.Elab.TerminationMeasures">TerminationMeasures</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.toTerminationMeasures" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.GuessLex.reportTerminationMeasures"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L774-L785">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.GuessLex.reportTerminationMeasures"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">GuessLex</span>.<span class="name">reportTerminationMeasures</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">preDefs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/Basic.html#Lean.Elab.PreDefinition">PreDefinition</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">termMeasures</span> : <a href="../../../.././Lean/Elab/PreDefinition/TerminationMeasure.html#Lean.Elab.TerminationMeasures">TerminationMeasures</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Shows the inferred termination measure to the user, and implements <code>termination_by?</code></p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.GuessLex.reportTerminationMeasures" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.WF.guessLex"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Elab/PreDefinition/WF/GuessLex.lean#L790-L836">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Lean/Elab/PreDefinition/WF/GuessLex.html#Lean.Elab.WF.guessLex"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">WF</span>.<span class="name">guessLex</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">preDefs</span> : <span class="fn"><a href="../../../.././Init/Prelude.html#Array">Array</a> <a href="../../../.././Lean/Elab/PreDefinition/Basic.html#Lean.Elab.PreDefinition">PreDefinition</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">unaryPreDef</span> : <a href="../../../.././Lean/Elab/PreDefinition/Basic.html#Lean.Elab.PreDefinition">PreDefinition</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">fixedParamPerms</span> : <a href="../../../.././Lean/Elab/PreDefinition/FixedParams.html#Lean.Elab.FixedParamPerms">FixedParamPerms</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">argsPacker</span> : <a href="../../../.././Lean/Meta/ArgsPacker/Basic.html#Lean.Meta.ArgsPacker">Meta.ArgsPacker</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../../.././Lean/Elab/PreDefinition/TerminationMeasure.html#Lean.Elab.TerminationMeasures">TerminationMeasures</a></span></div></div><p>Main entry point of this module:</p><p>Try to find a lexicographic ordering of the basic measures for which the recursive definition
terminates. See the module doc string for a high-level overview.</p><p>The <code>preDefs</code> are used to determine arity and types of parameters; the bodies are ignored.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.WF.guessLex" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../../../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>