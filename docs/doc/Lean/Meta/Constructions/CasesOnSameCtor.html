<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../../.././style.css"></link><link rel="icon" href="../../.././favicon.svg"></link><link rel="mask-icon" href="../../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Meta.Constructions.CasesOnSameCtor</title><script defer="true" src="../../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../../.././";</script><script>const MODULE_NAME="Lean.Meta.Constructions.CasesOnSameCtor";</script><script type="module" src="../../.././jump-src.js"></script><script type="module" src="../../.././search.js"></script><script type="module" src="../../.././expand-nav.js"></script><script type="module" src="../../.././how-about.js"></script><script type="module" src="../../.././instances.js"></script><script type="module" src="../../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Meta</span>.<span class="name">Constructions</span>.<span class="name">CasesOnSameCtor</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Meta/Constructions/CasesOnSameCtor.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../../.././Lean/Elab/App.html">Lean.Elab.App</a></li><li><a href="../../.././Lean/Meta/Basic.html">Lean.Meta.Basic</a></li><li><a href="../../.././Lean/Meta/CompletionName.html">Lean.Meta.CompletionName</a></li><li><a href="../../.././Lean/Meta/SameCtorUtils.html">Lean.Meta.SameCtorUtils</a></li><li><a href="../../.././Lean/Meta/Constructions/CtorElim.html">Lean.Meta.Constructions.CtorElim</a></li><li><a href="../../.././Lean/Meta/Constructions/CtorIdx.html">Lean.Meta.Constructions.CtorIdx</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Meta.Constructions.CasesOnSameCtor" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.mkCasesOnSameCtorHet"><span class="name">Lean</span>.<span class="name">mkCasesOnSameCtorHet</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.mkCasesOnSameCtor"><span class="name">Lean</span>.<span class="name">mkCasesOnSameCtor</span></a></div></nav><main>
<div class="mod_doc"><p>See <code><a href="../../.././Lean/Meta/Constructions/CasesOnSameCtor.html#Lean.mkCasesOnSameCtor">mkCasesOnSameCtor</a></code> below.</p></div><div class="decl" id="Lean.mkCasesOnSameCtorHet"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Meta/Constructions/CasesOnSameCtor.lean#L25-L109">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Meta/Constructions/CasesOnSameCtor.html#Lean.mkCasesOnSameCtorHet"><span class="name">Lean</span>.<span class="name">mkCasesOnSameCtorHet</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">declName </span><span class="fn">indName</span> : <a href="../../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Helper for <code><a href="../../.././Lean/Meta/Constructions/CasesOnSameCtor.html#Lean.mkCasesOnSameCtor">mkCasesOnSameCtor</a></code> that constructs a heterogenous matcher (indices may differ)
and does not include the equality proof in the motive (so it's not a the shape of a matcher) yet.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.mkCasesOnSameCtorHet" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.mkCasesOnSameCtor"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/744f98064b056ee27fc8c97f524797c8cc96f436/src/Lean/Meta/Constructions/CasesOnSameCtor.lean#L111-L222">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Meta/Constructions/CasesOnSameCtor.html#Lean.mkCasesOnSameCtor"><span class="name">Lean</span>.<span class="name">mkCasesOnSameCtor</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">declName </span><span class="fn">indName</span> : <a href="../../.././Init/Prelude.html#Lean.Name">Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">MetaM</a> <a href="../../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>This constructs a matcher for a match statement that matches on the constructors of
a data type in parallel. So if <code>h : x1.ctorIdx = x2.ctorIdx</code>, then it implements</p><pre><code>match x1, x2, h with
| ctor1 .. , ctor1 .. , _ =&gt; ...
| ctor2 .. , ctor2 .. , _ =&gt; ...
</code></pre><p>The normal matcher supports such matches, but implements them using nested <code>casesOn</code>, which
leads to a quadratic blow-up. This function uses the per-constructor eliminators to implement this
more efficiently.</p><p>This is useful for implementing or deriving functionality like <code><a href="../../.././Init/Prelude.html#BEq">BEq</a></code>, <code><a href="../../.././Init/Prelude.html#DecidableEq">DecidableEq</a></code>, <code><a href="../../.././Init/Data/Ord/Basic.html#Ord">Ord</a></code> and
proving their lawfulness.</p><p>One could imagine a future where <code>match</code> compilation is smart enough to do that automatically; then
this module can be dropped.</p><p>Note that for some data types where the indices determine the constructor (e.g. <code>Vec</code>), this leads
to less efficient code than the normal matcher, as this needs to read the constructor tag on both
arguments, wheras the normal matcher produces code that reads just the first argument’s tag, and
then boldly reads the second argument’s fields.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.mkCasesOnSameCtor" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>